"use strict";(self.webpackChunkstreamcanvasx=self.webpackChunkstreamcanvasx||[]).push([[71],{4451:(t,e,n)=>{n.r(e),n.d(e,{default:()=>c});var a=n(1224),o=n(6164).Z;const c=function(){return o(a.Z,null,(function(){var t=n(649).Z;return o(t,null)}))}},649:(t,e,n)=>{n.d(e,{Z:()=>l});var a=n(2983),o=n(860),c=n(72),i=n(1138);const s=function(){var t=e.prototype;function e(t){(0,i._)(this,"context",void 0),(0,i._)(this,"dataArray",void 0),(0,i._)(this,"bufferLength",void 0),(0,i._)(this,"bufferData",void 0),(0,i._)(this,"bufferDataLength",void 0);var e=t.canvas_el,n=t.media_el;this.context={},e&&this.setCanvasDom(e),this.createAudioContext(),this.setMediaSource_el(n),this.audioContextConnect()}return t.createAudioContext=function(){this.context.audioContext=new AudioContext,this.context.analyserNode=this.context.audioContext.createAnalyser(),this.bufferLength=this.context.analyserNode.fftSize,this.dataArray=new Float32Array(this.bufferLength),this.setBufferData()},t.setBufferData=function(){this.bufferDataLength=Math.ceil(1*this.context.audioContext.sampleRate/this.dataArray.length)*this.dataArray.length,this.bufferData=new Float32Array(this.bufferDataLength)},t.updateBufferData=function(){var t,e=this.dataArray,n=this.bufferData,a=this.bufferDataLength;n.copyWithin(0,e.length),null===(t=this.context.analyserNode)||void 0===t||t.getFloatTimeDomainData(e),n.set(e,a-e.length),requestAnimationFrame(this.updateBufferData.bind(this))},t.drawWithBufferData=function(){var t=this,e=this.bufferData,n=this.bufferDataLength;!function a(){t.context.canvasContext.clearRect(0,0,t.context.canvas.width,t.context.canvas.height),t.context.canvasContext.lineWidth=2,t.context.canvasContext.strokeStyle="#7f0",t.context.canvasContext.beginPath();for(var o=t.context.canvas.width/n,c=0,i=0;i<n;i++){var s=e[i]*t.context.canvas.height/2,r=t.context.canvas.height/2+s;0===i?t.context.canvasContext.moveTo(c,r):t.context.canvasContext.lineTo(c,r),c+=o}t.context.canvasContext.lineTo(t.context.canvas.width,t.context.canvas.height/2),t.context.canvasContext.stroke(),requestAnimationFrame(a.bind(t))}()},t.setCanvasDom=function(t){this.context.canvas=t,this.context.canvasContext=this.context.canvas.getContext("2d")},t.setMediaSource_el=function(t){this.context.mediaSource_el=t,this.context.audioSourceNode=this.context.audioContext.createMediaElementSource(t)},t.resetAudioContextConnec=function(){var t;null===(t=this.context.audioSourceNode)||void 0===t||t.disconnect(),this.audioContextConnect()},t.audioContextConnect=function(){this.context.audioSourceNode.connect(this.context.analyserNode),this.context.analyserNode.connect(this.context.audioContext.destination)},t.mute=function(t){!0===t?this.context.analyserNode.disconnect(this.context.audioContext.destination):this.context.analyserNode.connect(this.context.audioContext.destination)},t.visulizerDraw=function(){var t=this,e=this.context.analyserNode.frequencyBinCount,n=new Uint8Array(e);!function a(){requestAnimationFrame(a.bind(t)),t.context.analyserNode.getByteFrequencyData(n),t.context.canvasContext.fillStyle="rgb(255, 255, 255)",t.context.canvasContext.fillRect(0,0,t.context.canvas.width,t.context.canvas.height);for(var o,c=t.context.canvas.width/e*2.5,i=0,s=0;s<e;s++){o=n[s]/2;t.context.canvasContext.fillStyle="rgb(0, 0, 0)",t.context.canvasContext.fillRect(i,t.context.canvas.height-o,c,o),i+=c+1}}()},t.visulizerDraw1=function(){var t=this,e=this.context.analyserNode.frequencyBinCount,n=new Uint8Array(e);!function a(){requestAnimationFrame(a.bind(t)),t.context.analyserNode.getByteFrequencyData(n),t.context.canvasContext.fillStyle="#000",t.context.canvasContext.fillRect(0,0,t.context.canvas.width,t.context.canvas.height);for(var o,c=t.context.canvas.width/e*2.5,i=0,s=0;s<e;s++){var r=(o=n[s])+s/e*25,x=s/e*250;t.context.canvasContext.fillStyle="rgb("+r+","+x+",50)",t.context.canvasContext.fillRect(i,t.context.canvas.height-o,c,o),i+=c+1}}()},t.visulizerDraw2=function(){var t=this,e=this.context.analyserNode.frequencyBinCount,n=new Uint8Array(e);!function a(){requestAnimationFrame(a.bind(t)),t.context.analyserNode.getByteFrequencyData(n),t.context.canvasContext.fillStyle="rgba(0, 0, 0, 0.05)",t.context.canvasContext.fillRect(0,0,t.context.canvas.width,t.context.canvas.height),t.context.canvasContext.lineWidth=2,t.context.canvasContext.strokeStyle="rgb(0, 255, 0)",t.context.canvasContext.beginPath();for(var o=1*t.context.canvas.width/e,c=0,i=0;i<e;i++){var s=n[i]/128*t.context.canvas.height/2;0===i?t.context.canvasContext.moveTo(c,s):t.context.canvasContext.lineTo(c,s),c+=o}t.context.canvasContext.lineTo(t.context.canvas.width,t.context.canvas.height/2),t.context.canvasContext.stroke()}()},t.visulizerDraw3=function(){var t=this,e=this.bufferLength,n=this.dataArray;!function a(){t.context.analyserNode.getFloatTimeDomainData(n),t.context.canvasContext.clearRect(0,0,t.context.canvas.width,t.context.canvas.height),t.context.canvasContext.lineWidth=2,t.context.canvasContext.strokeStyle="#7f0",t.context.canvasContext.beginPath();for(var o=t.context.canvas.width/e,c=0,i=0;i<e;i++){var s=n[i]*t.context.canvas.height/2,r=t.context.canvas.height/2+s;0===i?t.context.canvasContext.moveTo(c,r):t.context.canvasContext.lineTo(c,r),c+=o}t.context.canvasContext.lineTo(t.context.canvas.width,t.context.canvas.height/2),t.context.canvasContext.stroke(),requestAnimationFrame(a.bind(t))}()},t.visulizerDraw4=function(){var t=this,e=this.context.analyserNode.fftSize,n=new Float32Array(e);!function a(){requestAnimationFrame(a.bind(t)),t.context.analyserNode.getFloatTimeDomainData(n),t.context.canvasContext.fillStyle="rgba(0, 0, 0, 0.1)",t.context.canvasContext.fillRect(0,0,t.context.canvas.width,t.context.canvas.height),t.context.canvasContext.lineWidth=2,t.context.canvasContext.strokeStyle="rgb(0, 255, 0)",t.context.canvasContext.beginPath();for(var o=1*t.context.canvas.width/e,c=0,i=0;i<e;i++){var s=n[i]/128*t.context.canvas.height/2;0===i?t.context.canvasContext.moveTo(c,s):t.context.canvasContext.lineTo(c,s),c+=o}t.context.canvasContext.lineTo(t.context.canvas.width,t.context.canvas.height/2),t.context.canvasContext.stroke()}()},e}();var r=n(5894);c.F.bind(r.v.IAudioProcessingService).toFactory((function(t){return function(t){return new s(t)}}));var x=n(6164).Z,v=n(2983).Fragment,h=a.useRef,u=a.useEffect;const l=function(){var t=a.useRef(null),e=a.useRef(null),n=h(null),i=h(null);u((function(){var a=(0,o.s)({root_el:null==t?void 0:t.current,canvas_el:null==e?void 0:e.current});n.current=a,s()}),[]);var s=function(){var t,e=null==(t=n.current)?void 0:t._vedio;e&&e.addEventListener("play",(function(){var t,n=(t={media_el:e,canvas_el:i.current},c.F.get(r.v.IAudioProcessingService)(t));n.updateBufferData(),n.drawWithBufferData()}))};return x(v,null,x("div",null,x("input",{type:"file",id:"file-input",accept:"audio/*,video/*",onChange:function(t){var e,a,o=n.current,c=null==(e=t.target)||null==(a=e.files)?void 0:a[0];c&&o.set_blob_url(c)}}),x("div",{style:{display:"flex",flexDirection:"row"}},x("div",{ref:t,style:{width:"300px",height:"300px"}}),x("canvas",{ref:e,width:"300",height:"300",style:{marginLeft:"15px",display:"none"}}),x("div",null,x("canvas",{style:{background:"black"},ref:i,id:"canvas",width:"300",height:"300"})))))}}}]);