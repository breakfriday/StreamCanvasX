/*! For license information please see common.a6a92a1a.js.LICENSE.txt */
(self.webpackChunkstreamcanvasx=self.webpackChunkstreamcanvasx||[]).push([[592],{867:(e,t,n)=>{"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=i(n(2983));function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o.apply(this,arguments)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=r.default.createContext({}),h=function(e){var t=r.default.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},l={inlineCode:"code",wrapper:function(e){var t=e.children;return r.default.createElement(r.default.Fragment,{},t)}},_=r.default.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,o=e.parentName,s=u(e,["components","mdxType","originalType","parentName"]),d=h(n),_=i,f=d["".concat(o,".").concat(_)]||d[_]||l[_]||a;return n?r.default.createElement(f,c(c({ref:t},s),{},{components:n})):r.default.createElement(f,c({ref:t},s))}));_.displayName="MDXCreateElement",t.Zo=function(e){var t=h(e.components);return r.default.createElement(d.Provider,{value:t},e.children)},t.kt=function(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=_;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var u=2;u<a;u++)o[u]=n[u];return r.default.createElement.apply(null,o)}return r.default.createElement.apply(null,n)}},1224:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});n(2983);var i=n(7039),r=n(6164).Z,a=n(2983).Fragment;function o(e){var t=e.children,n=e.fallback;return(0,i.Z)()?r(a,null,null==t?void 0:t()):null!=n?n:null}},72:(e,t,n)=>{"use strict";n.d(t,{F:()=>Oe});n(171);var i={Request:"Request",Singleton:"Singleton",Transient:"Transient"},r={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},a={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},o=0;function s(){return o++}var c=function(){function e(e,t){this.id=s(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=r.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===i.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},e}(),u=n(447),d=n(7269),h=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(d.FL,e),userGeneratedMetadata:Reflect.getMetadata(d.LD,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(d.Sy,e)||[]},e}(),l={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function _(e){return e instanceof RangeError||e.message===u.$z}function f(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function p(e,t,n){var i="",r=n(e,t);return 0!==r.length&&(i="\nRegistered bindings:",r.forEach((function(e){var t="Object";null!==e.implementationType&&(t=v(e.implementationType)),i=i+"\n "+t,e.constraint.metaData&&(i=i+" - "+e.constraint.metaData)}))),i}function m(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||m(e.parentRequest,t))}function g(e){e.childRequests.forEach((function(e){if(m(e,e.serviceIdentifier)){var t=function(e){var t=function e(t,n){void 0===n&&(n=[]);var i=f(t.serviceIdentifier);return n.push(i),null!==t.parentRequest?e(t.parentRequest,n):n}(e);return t.reverse().join(" --\x3e ")}(e);throw new Error(u.QY+" "+t)}g(e)}))}function v(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}var y=function(){function e(e){this.id=s(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),b=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===d.vO?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},e}(),S=function(e,t){this.parentContext=e,this.rootRequest=t},A=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),E=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),w=function(){function e(e,t,n,i){this.id=s(),this.type=e,this.serviceIdentifier=n;var r="symbol"==typeof t?t.toString().slice(7,-1):t;this.name=new E(r||""),this.identifier=t,this.metadata=new Array;var a=null;"string"==typeof i?a=new b(d.vO,i):i instanceof b&&(a=i),null!==a&&this.metadata.push(a)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(d.Lc)},e.prototype.matchesArray=function(e){return this.matchesTag(d.Lc)(e)},e.prototype.isNamed=function(){return this.hasTag(d.vO)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return d.xR.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(d.YO)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===d.vO}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return d.xR.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(d.vO)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,r=t.metadata;i<r.length;i++){var a=r[i];if(a.key===e&&a.value===n)return!0}return!1}},e}(),T=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function R(e,t,n,i){var r=e.getConstructorMetadata(n),a=r.compilerGeneratedMetadata;if(void 0===a){var o=u.GF+" "+t+".";throw new Error(o)}var s=r.userGeneratedMetadata,c=Object.keys(s),d=0===n.length&&c.length>0,h=c.length>n.length,l=function(e,t,n,i,r){for(var a=[],o=0;o<r;o++){var s=k(o,e,t,n,i);null!==s&&a.push(s)}return a}(i,t,a,s,d||h?c.length:n.length),_=L(e,n,t);return T(T([],l,!0),_,!0)}function k(e,t,n,i,r){var o=r[e.toString()]||[],s=I(o),c=!0!==s.unmanaged,d=i[e],h=s.inject||s.multiInject;if((d=h||d)instanceof A&&(d=d.unwrap()),c){if(!t&&(d===Object||d===Function||void 0===d)){var l=u.eP+" argument "+e+" in class "+n+".";throw new Error(l)}var _=new w(a.ConstructorArgument,s.targetName,d);return _.metadata=o,_}return null}function D(e,t,n,i){var r=e||t;if(void 0===r){var a=u.GF+" for property "+String(n)+" in class "+i+".";throw new Error(a)}return r}function L(e,t,n){for(var i=e.getPropertiesMetadata(t),r=[],o=Object.getOwnPropertySymbols(i),s=0,c=Object.keys(i).concat(o);s<c.length;s++){var u=c[s],d=i[u],h=I(d),l=h.targetName||u,_=D(h.inject,h.multiInject,u,n),f=new w(a.ClassProperty,l,_);f.metadata=d,r.push(f)}var p=Object.getPrototypeOf(t.prototype).constructor;if(p!==Object){var m=L(e,p,n);r=T(T([],r,!0),m,!0)}return r}function C(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var i=R(e,v(n),n,!0),r=i.map((function(e){return e.metadata.filter((function(e){return e.key===d.Mx}))})),a=[].concat.apply([],r).length,o=i.length-a;return o>0?o:C(e,n)}return 0}function I(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[d.B8],multiInject:t[d.Lc],targetName:t[d.dM],unmanaged:t[d.Mx]}}var O=function(){function e(e,t,n,i,r){this.id=s(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=r,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,i){var r=new e(t,this.parentContext,this,n,i);return this.childRequests.push(r),r},e}();function P(e){return e._bindingDictionary}function B(e,t,n,i,r){var a=x(n.container,r.serviceIdentifier),o=[];return a.length===l.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof r.serviceIdentifier&&e.getConstructorMetadata(r.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(r.serviceIdentifier).toSelf(),a=x(n.container,r.serviceIdentifier)),o=t?a:a.filter((function(e){var t=new O(e.serviceIdentifier,n,i,e,r);return e.constraint(t)})),function(e,t,n,i){switch(t.length){case l.NoBindingsAvailable:if(n.isOptional())return t;var r=f(e),a=u.cm;throw a+=function(e,t){if(t.isTagged()||t.isNamed()){var n="",i=t.getNamedTag(),r=t.getCustomTags();return null!==i&&(n+=i.toString()+"\n"),null!==r&&r.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e}(r,n),a+=p(i,r,x),new Error(a);case l.OnlyOneBindingAvailable:return t;case l.MultipleBindingsAvailable:default:if(n.isArray())return t;r=f(e),a=u.Kt+" "+r;throw a+=p(i,r,x),new Error(a)}}(r.serviceIdentifier,o,r,n.container),o}function M(e,t,n,i,a,o){var s,c;if(null===a){s=B(e,t,i,null,o),c=new O(n,i,null,s,o);var d=new S(i,c);i.addPlan(d)}else s=B(e,t,i,a,o),c=a.addChildRequest(o.serviceIdentifier,s,o);s.forEach((function(t){var n=null;if(o.isArray())n=c.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;n=c}if(t.type===r.Instance&&null!==t.implementationType){var a=function(e,t){return R(e,v(t),t,!1)}(e,t.implementationType);if(!i.container.options.skipBaseClassChecks){var s=C(e,t.implementationType);if(a.length<s){var d=u.iI(v(t.implementationType));throw new Error(d)}}a.forEach((function(t){M(e,!1,t.serviceIdentifier,i,n,t)}))}}))}function x(e,t){var n=[],i=P(e);return i.hasKey(t)?n=i.get(t):null!==e.parent&&(n=x(e.parent,t)),n}function U(e,t,n,i,r,a,o,s){void 0===s&&(s=!1);var c=new y(t),u=function(e,t,n,i,r,a){var o=e?d.Lc:d.B8,s=new b(o,n),c=new w(t,i,n,s);if(void 0!==r){var u=new b(r,a);c.metadata.push(u)}return c}(n,i,r,"",a,o);try{return M(e,s,r,c,null,u),c}catch(h){throw _(h)&&g(c.plan.rootRequest),h}}function N(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}function G(e){return!!N(e)||Array.isArray(e)&&e.some(N)}var F,j=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{c(i.next(e))}catch(t){a(t)}}function s(e){try{c(i.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((i=i.apply(e,t||[])).next())}))},V=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},z=function(e,t,n){e.has(t.id)||e.set(t.id,n)},q=function(e,t){e.cache=t,e.activated=!0,N(t)&&H(e,t)},H=function(e,t){return j(void 0,void 0,void 0,(function(){var n,i;return V(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t];case 1:return n=r.sent(),e.cache=n,[3,3];case 2:throw i=r.sent(),e.cache=null,e.activated=!1,i;case 3:return[2]}}))}))};!function(e){e.DynamicValue="toDynamicValue",e.Factory="toFactory",e.Provider="toProvider"}(F||(F={}));var W=function(){return W=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},W.apply(this,arguments)},K=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{c(i.next(e))}catch(t){a(t)}}function s(e){try{c(i.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((i=i.apply(e,t||[])).next())}))},Y=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},X=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function Z(e,t,n){var i;if(t.length>0){var r=function(e,t){return e.reduce((function(e,n){var i=t(n);return n.target.type===a.ConstructorArgument?e.constructorInjections.push(i):(e.propertyRequests.push(n),e.propertyInjections.push(i)),e.isAsync||(e.isAsync=G(i)),e}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(t,n),o=W(W({},r),{constr:e});i=r.isAsync?function(e){return K(this,void 0,void 0,(function(){var t,n;return Y(this,(function(i){switch(i.label){case 0:return[4,Q(e.constructorInjections)];case 1:return t=i.sent(),[4,Q(e.propertyInjections)];case 2:return n=i.sent(),[2,J(W(W({},e),{constructorInjections:t,propertyInjections:n}))]}}))}))}(o):J(o)}else i=new e;return i}function J(e){var t,n=new((t=e.constr).bind.apply(t,X([void 0],e.constructorInjections,!1)));return e.propertyRequests.forEach((function(t,i){var r=t.target.identifier,a=e.propertyInjections[i];n[r]=a})),n}function Q(e){return K(this,void 0,void 0,(function(){var t,n,i,r;return Y(this,(function(a){for(t=[],n=0,i=e;n<i.length;n++)r=i[n],Array.isArray(r)?t.push(Promise.all(r)):t.push(r);return[2,Promise.all(t)]}))}))}function $(e,t){var n=function(e,t){var n,i;if(Reflect.hasMetadata(d.af,e)){var r=Reflect.getMetadata(d.af,e);try{return null===(i=(n=t)[r.value])||void 0===i?void 0:i.call(n)}catch(a){throw new Error((0,u.gq)(e.name,a.message))}}}(e,t);return N(n)?n.then((function(){return t})):t}function ee(e,t){e.scope!==i.Singleton&&function(e,t){var n="Class cannot be instantiated in "+(e.scope===i.Request?"request":"transient")+" scope.";if("function"==typeof e.onDeactivation)throw new Error((0,u.YG)(t.name,n));if(Reflect.hasMetadata(d.Z8,t))throw new Error((0,u.xZ)(t.name,n))}(e,t)}var te=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{c(i.next(e))}catch(t){a(t)}}function s(e){try{c(i.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((i=i.apply(e,t||[])).next())}))},ne=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},ie=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,i=t.childRequests,r=t.target&&t.target.isArray(),a=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(r&&a)return i.map((function(t){return ie(e)(t)}));if(!t.target.isOptional()||0!==n.length){var o=n[0];return se(e,t,o)}}},re=function(e,t){var n=function(e){switch(e.type){case r.Factory:return{factory:e.factory,factoryType:F.Factory};case r.Provider:return{factory:e.provider,factoryType:F.Provider};case r.DynamicValue:return{factory:e.dynamicValue,factoryType:F.DynamicValue};default:throw new Error("Unexpected factory type "+e.type)}}(e);return function(e,t){try{return e()}catch(n){throw _(n)&&(n=t()),n}}((function(){return n.factory.bind(e)(t)}),(function(){return new Error(u.aD(n.factoryType,t.currentRequest.serviceIdentifier.toString()))}))},ae=function(e,t,n){var i,a=t.childRequests;switch(function(e){var t=null;switch(e.type){case r.ConstantValue:case r.Function:t=e.cache;break;case r.Constructor:case r.Instance:t=e.implementationType;break;case r.DynamicValue:t=e.dynamicValue;break;case r.Provider:t=e.provider;break;case r.Factory:t=e.factory}if(null===t){var n=f(e.serviceIdentifier);throw new Error(u.jT+" "+n)}}(n),n.type){case r.ConstantValue:case r.Function:i=n.cache;break;case r.Constructor:i=n.implementationType;break;case r.Instance:i=function(e,t,n,i){ee(e,t);var r=Z(t,n,i);return N(r)?r.then((function(e){return $(t,e)})):$(t,r)}(n,n.implementationType,a,ie(e));break;default:i=re(n,t.parentContext)}return i},oe=function(e,t,n){var r=function(e,t){return t.scope===i.Singleton&&t.activated?t.cache:t.scope===i.Request&&e.has(t.id)?e.get(t.id):null}(e,t);return null!==r||function(e,t,n){t.scope===i.Singleton&&q(t,n),t.scope===i.Request&&z(e,t,n)}(e,t,r=n()),r},se=function(e,t,n){return oe(e,n,(function(){var i=ae(e,t,n);return i=N(i)?i.then((function(e){return ce(t,n,e)})):ce(t,n,i)}))};function ce(e,t,n){var i,r=ue(e.parentContext,t,n),a=_e(e.parentContext.container),o=a.next();do{i=o.value;var s=e.parentContext,c=e.serviceIdentifier,u=le(i,c);r=N(r)?he(u,s,r):de(u,s,r),o=a.next()}while(!0!==o.done&&!P(i).hasKey(e.serviceIdentifier));return r}var ue=function(e,t,n){return"function"==typeof t.onActivation?t.onActivation(e,n):n},de=function(e,t,n){for(var i=e.next();!i.done;){if(N(n=i.value(t,n)))return he(e,t,n);i=e.next()}return n},he=function(e,t,n){return te(void 0,void 0,void 0,(function(){var i,r;return ne(this,(function(a){switch(a.label){case 0:return[4,n];case 1:i=a.sent(),r=e.next(),a.label=2;case 2:return r.done?[3,4]:[4,r.value(t,i)];case 3:return i=a.sent(),r=e.next(),[3,2];case 4:return[2,i]}}))}))},le=function(e,t){var n=e._activations;return n.hasKey(t)?n.get(t).values():[].values()},_e=function(e){for(var t=[e],n=e.parent;null!==n;)t.push(n),n=n.parent;return{next:function(){var e=t.pop();return void 0!==e?{done:!1,value:e}:{done:!0,value:void 0}}}};var fe=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||fe(n,t))},pe=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new b(e,t),n}},me=pe(d.vO),ge=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var i=t.bindings[0].implementationType;return e===i}return!1}},ve=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new ye(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=me(e),new ye(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e&&(null!==e.target&&!e.target.isNamed()&&!e.target.isTagged())},new ye(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=pe(e)(t),new ye(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return null!==t&&ge(e)(t.parentRequest)},new ye(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return null!==t&&me(e)(t.parentRequest)},new ye(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&pe(e)(t)(n.parentRequest)},new ye(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&fe(t,ge(e))},new ye(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&!fe(t,ge(e))},new ye(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&fe(t,me(e))},new ye(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&!fe(t,me(e))},new ye(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&fe(n,pe(e)(t))},new ye(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&!fe(n,pe(e)(t))},new ye(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&fe(t,e)},new ye(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&!fe(t,e)},new ye(this._binding)},e}(),ye=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new ve(this._binding)},e.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new ve(this._binding)},e}(),be=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ve(this._binding),this._bindingOnSyntax=new ye(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),Se=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=i.Request,new be(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=i.Singleton,new be(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=i.Transient,new be(this._binding)},e}(),Ae=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ve(this._binding),this._bindingOnSyntax=new ye(this._binding),this._bindingInSyntax=new Se(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),Ee=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=r.Instance,this._binding.implementationType=e,new Ae(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+u.wk);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=r.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=i.Singleton,new be(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=r.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new Ae(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=r.Constructor,this._binding.implementationType=e,this._binding.scope=i.Singleton,new be(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=r.Factory,this._binding.factory=e,this._binding.scope=i.Singleton,new be(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(u.d1);var t=this.toConstantValue(e);return this._binding.type=r.Function,this._binding.scope=i.Singleton,t},e.prototype.toAutoFactory=function(e){return this._binding.type=r.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=i.Singleton,new be(this._binding)},e.prototype.toAutoNamedFactory=function(e){return this._binding.type=r.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new be(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=r.Provider,this._binding.provider=e,this._binding.scope=i.Singleton,new be(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),we=function(){function e(){}return e.of=function(t,n,i,r,a){var o=new e;return o.bindings=t,o.middleware=n,o.deactivations=r,o.activations=i,o.moduleActivationStore=a,o},e}();var Te=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(u.H1);if(null==t)throw new Error(u.H1);var n=this._map.get(e);void 0!==n?n.push(t):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(u.H1);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(u.yu)},e.prototype.remove=function(e){if(null==e)throw new Error(u.H1);if(!this._map.delete(e))throw new Error(u.yu)},e.prototype.removeIntersection=function(e){var t=this;this.traverse((function(n,i){var r=e.hasKey(n)?e.get(n):void 0;if(void 0!==r){var a=i.filter((function(e){return!r.some((function(t){return e===t}))}));t._setValue(n,a)}}))},e.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach((function(i,r){for(var a=[],o=0,s=i;o<s.length;o++){var c=s[o];e(c)?n.push(c):a.push(c)}t._setValue(r,a)})),n},e.prototype.hasKey=function(e){if(null==e)throw new Error(u.H1);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,"object"==typeof(i=e)&&null!==i&&"clone"in i&&"function"==typeof i.clone?e.clone():e);var i}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},e}(),Re=function(){function e(){this._map=new Map}return e.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},e.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},e.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){t._map.set(n,{onActivations:e.onActivations.clone(),onDeactivations:e.onDeactivations.clone()})})),t},e.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return void 0===t&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},e.prototype._getEmptyHandlersStore=function(){return{onActivations:new Te,onDeactivations:new Te}},e}(),ke=function(){return ke=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},ke.apply(this,arguments)},De=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{c(i.next(e))}catch(t){a(t)}}function s(e){try{c(i.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((i=i.apply(e,t||[])).next())}))},Le=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},Ce=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Ie=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+u.xU);if(void 0===t.defaultScope)t.defaultScope=i.Transient;else if(t.defaultScope!==i.Singleton&&t.defaultScope!==i.Transient&&t.defaultScope!==i.Request)throw new Error(""+u.k_);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+u.rR);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+u.vD);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=s(),this._bindingDictionary=new Te,this._snapshots=[],this._middleware=null,this._activations=new Te,this._deactivations=new Te,this.parent=null,this._metadataReader=new h,this._moduleActivationStore=new Re}return e.merge=function(t,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var a=new e,o=Ce([t,n],i,!0).map((function(e){return P(e)})),s=P(a);return o.forEach((function(e){var t;t=s,e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))})),a},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,r=e;i<r.length;i++){var a=r[i],o=n(a.id);a.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction,o.unbindAsyncFunction,o.onActivationFunction,o.onDeactivationFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return De(this,void 0,void 0,(function(){var t,n,i,r,a;return Le(this,(function(o){switch(o.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,i=e,o.label=1;case 1:return n<i.length?(r=i[n],a=t(r.id),[4,r.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:o.sent(),o.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){var n=e._removeModuleBindings(t.id);e._deactivateSingletons(n),e._removeModuleHandlers(t.id)}))},e.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return De(this,void 0,void 0,(function(){var t,n,i,r;return Le(this,(function(a){switch(a.label){case 0:t=0,n=e,a.label=1;case 1:return t<n.length?(i=n[t],r=this._removeModuleBindings(i.id),[4,this._deactivateSingletonsAsync(r)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(i.id),a.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.bind=function(e){var t=this.options.defaultScope||i.Transient,n=new c(e,t);return this._bindingDictionary.add(e,n),new Ee(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.rebindAsync=function(e){return De(this,void 0,void 0,(function(){return Le(this,(function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}}))}))},e.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},e.prototype.unbindAsync=function(e){return De(this,void 0,void 0,(function(){var t;return Le(this,(function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}}))}))},e.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse((function(t,n){e._deactivateSingletons(n)})),this._bindingDictionary=new Te},e.prototype.unbindAllAsync=function(){return De(this,void 0,void 0,(function(){var e,t=this;return Le(this,(function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse((function(n,i){e.push(t._deactivateSingletonsAsync(i))})),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new Te,[2]}}))}))},e.prototype.onActivation=function(e,t){this._activations.add(e,t)},e.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,d.vO,t)},e.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var r=this._bindingDictionary.get(e),o=function(e,t,n,i){var r=new w(a.Variable,"",t,new b(n,i)),o=new y(e);return new O(t,o,null,[],r)}(this,e,t,n);i=r.some((function(e){return e.constraint(o)}))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},e.prototype.snapshot=function(){this._snapshots.push(we.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(u.NE);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},e.prototype.getAsync=function(e){return De(this,void 0,void 0,(function(){var t;return Le(this,(function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]}))}))},e.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},e.prototype.getTaggedAsync=function(e,t,n){return De(this,void 0,void 0,(function(){var i;return Le(this,(function(r){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]}))}))},e.prototype.getNamed=function(e,t){return this.getTagged(e,d.vO,t)},e.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,d.vO,t)},e.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},e.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},e.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},e.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,d.vO,t)},e.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,d.vO,t)},e.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},e.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(d.Z8,e))return t[Reflect.getMetadata(d.Z8,e).value]()},e.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},e.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition((function(t){return t.moduleId===e}))},e.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var r=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(N(r))return this._handleDeactivationError(r.then((function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)})),i)}var a=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if(N(a))return this._handleDeactivationError(a,i)}catch(o){throw new Error(u.YG(i.name,o.message))}},e.prototype._handleDeactivationError=function(e,t){return De(this,void 0,void 0,(function(){var n;return Le(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:throw n=i.sent(),new Error(u.YG(t.name,n.message));case 3:return[2]}}))}))},e.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var r=i.value(e);if(N(r))return r.then((function(){return n._deactivateContainerAsync(e,t)}));i=t.next()}},e.prototype._deactivateContainerAsync=function(e,t){return De(this,void 0,void 0,(function(){var n;return Le(this,(function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}}))}))},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(i){var r=e.rebind(i);return t(r,n),r}},i=function(t){return function(n,i){e._moduleActivationStore.addActivation(t,n,i),e.onActivation(n,i)}},r=function(t){return function(n,i){e._moduleActivationStore.addDeactivation(t,n,i),e.onDeactivation(n,i)}};return function(a){return{bindFunction:(o=a,function(n){var i=e.bind(n);return t(i,o),i}),isboundFunction:function(t){return e.isBound(t)},onActivationFunction:i(a),onDeactivationFunction:r(a),rebindFunction:n(a),unbindFunction:function(t){return e.unbind(t)},unbindAsyncFunction:function(t){return e.unbindAsync(t)}};var o}},e.prototype._getAll=function(e){return Promise.all(this._get(e))},e.prototype._get=function(e){var t=ke(ke({},e),{contextInterceptor:function(e){return e},targetType:a.Variable});if(this._middleware){var n=this._middleware(t);if(null==n)throw new Error(u.pv);return n}return this._planAndResolve()(t)},e.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(G(t))throw new Error(u.FJ(e.serviceIdentifier));return t},e.prototype._getAllArgs=function(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}},e.prototype._getNotAllArgs=function(e,t,n,i){return{avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i}},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=U(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return function(e){return ie(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(n=t.contextInterceptor(n))}},e.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return N(e.cache)?e.cache.then((function(n){return t._deactivate(e,n)})):this._deactivate(e,e.cache)},e.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];if(N(this._deactivateIfSingleton(i)))throw new Error(u.iD)}},e.prototype._deactivateSingletonsAsync=function(e){return De(this,void 0,void 0,(function(){var t=this;return Le(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return t._deactivateIfSingleton(e)})))];case 1:return n.sent(),[2]}}))}))},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return De(this,void 0,void 0,(function(){return Le(this,(function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))},e.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(u.VF+" "+f(e))}},e.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if("function"==typeof e.onDeactivation){var r=e.onDeactivation(t);if(N(r))return r.then((function(){return i._preDestroy(n,t)}))}return this._preDestroy(n,t)},e.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return De(this,void 0,void 0,(function(){return Le(this,(function(i){switch(i.label){case 0:return"function"!=typeof e.onDeactivation?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}}))}))},e}(),Oe=new Ie},860:(e,t,n)=>{"use strict";n.d(t,{s:()=>m});var i=n(72),r=n(207),a=n(2229),o=n(2636),s=n(1138);function c(e,t,n,i){var r,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,n,o):r(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}Object.create;Object.create;var u=n(447),d=n(7269);var h=n(6269),l=n.n(h),_=function(){var e=t.prototype;function t(e){(0,s._)(this,"video",void 0),(0,s._)(this,"canvas",void 0),(0,s._)(this,"context",void 0),(0,s._)(this,"mpegtsPlayer",void 0),(0,s._)(this,"root_el",void 0),(0,s._)(this,"aspectRatio",void 0),(0,s._)(this,"metadata",void 0),(0,s._)(this,"config",void 0),this.video=document.createElement("video"),this.video.controls=!0,this.canvas=e.canvas_el,this.root_el=e.root_el,this.config=e.config||{},this.canvas&&(this.context=this.canvas.getContext("2d")),this.root_el.innerHTML="",this.root_el.appendChild(this.video),this.setVideoSize(),this.vedioEvents()}return e.createFlvPlayer=function(e){var t=this,n=e.type,i=e.isLive,r=e.url,a=this.video;a&&(this.mpegtsPlayer=l().createPlayer({type:n,isLive:i,url:r,hasAudio:!0}),this.mpegtsPlayer.attachMediaElement(a),this.getVideoSize(),this.mpegtsPlayer.load(),this.mpegtsPlayer.on(l().Events.MEDIA_INFO,(function(e){var n=e.metadata.width,i=e.metadata.height;t.metadata={video_height:i,video_width:n},t.getVideoSize()})),this.mpegtsPlayer.on(l().Events.METADATA_ARRIVED,(function(e){t.mpegtsPlayer.play()})),this.mpegtsPlayer.on(l().Events.ERROR,(function(e,n){if(e===l().ErrorTypes.NETWORK_ERROR&&(n===l().ErrorDetails.NETWORK_UNRECOVERABLE_EARLY_EOF&&t.reoload(),n===l().ErrorDetails.NETWORK_TIMEOUT))return!1})))},e.setConfig=function(e){this.config=Object.assign({},this.config,e)},e.load=function(){this.mpegtsPlayer.load()},e.play=function(){this.mpegtsPlayer.play()},e.paused=function(){this.mpegtsPlayer.pause()},e.reoload=function(){this.mpegtsPlayer.unload(),this.mpegtsPlayer.detachMediaElement(),this.mpegtsPlayer.attachMediaElement(this.video),this.mpegtsPlayer.load(),this.mpegtsPlayer.play()},e.set_blob_url=function(e){var t=URL.createObjectURL(e);this.video.src=t,this.video.load()},e.vedioEvents=function(){var e=this;this.loadMediaEvent(),this.video.addEventListener("play",(function(){e.analyzeCanvas.call(e)}),!1)},e.getVideoSize=function(){var e={},t=e.videoHeight,n=void 0===t?0:t,i=e.videoWidth,r=void 0===i?0:i;this.metadata?(r=this.metadata.video_width,n=this.metadata.video_height):(n=this.video.videoHeight,r=this.video.videoWidth);var a=function e(t,n){return 0===n?t:e(n,t%n)}(r,n),o=r/a,s=n/a,c=o+":"+s;this.aspectRatio=o/s,console.log("------------------------"),console.log(c),console.log("------------------------")},e.loadMediaEvent=function(){var e=this,t=this.video;t&&t.addEventListener("loadedmetadata",(function(){e.getVideoSize()}))},e.setVideoSize=function(){var e=this.root_el.clientHeight,t=this.root_el.clientWidth;this.video.height=e,this.video.width=t},e.renderByWebGpu=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n,i,a=this;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.gpu.requestAdapter();case 2:return t=e.sent,e.next=5,t.requestDevice();case 5:n=e.sent,i=n.createTexture({size:{width:this.video.videoWidth,height:this.video.videoHeight,depth:1},format:"rgba8unorm",usage:window.GPUTextureUsage.COPY_DST|window.GPUTextureUsage.RENDER_ATTACHMENT}),function e(){n.queue.copyExternalImageToTexture({source:a.video},{texture:i},[a.video.videoWidth,a.video.videoHeight,1]),requestAnimationFrame(e.bind(a))}.call(this);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.analyzeCanvas=function(){var e=this,t=this.canvas.width,n=this.canvas.height/this.aspectRatio,i=this.context.getImageData(0,0,1,1).data;i[0],i[1],i[2];!function i(){e.video.ended||e.video.paused||(e.context.drawImage(e.video,0,0,t,n),requestAnimationFrame(i.bind(e)))}()},(0,o.Z)(t,[{key:"_vedio",get:function(){return this.video}}]),t}();const f=_=c([function(e){if(Reflect.hasOwnMetadata(d.FL,e))throw new Error(u.gf);var t=Reflect.getMetadata(d.rQ,e)||[];return Reflect.defineMetadata(d.FL,t,e),e}],_);var p=n(5894);function m(e){return i.F.get(p.v.IMainPlayerService)(e)}i.F.bind(p.v.IMainPlayerService).toFactory((function(e){return function(e){return new f(e)}}))},5894:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var i={IOriginSerivce:Symbol.for("IOriginSerivce"),IServiceA:Symbol.for("IServiceA"),IAudioProcessingService:Symbol.for("IAudioProcessingService"),IMainPlayerService:Symbol.for("IMainPlayerService")}},447:(e,t,n)=>{"use strict";n.d(t,{$z:()=>D,FJ:()=>m,GF:()=>u,H1:()=>r,Kt:()=>o,NE:()=>_,QY:()=>h,VF:()=>s,YG:()=>R,aD:()=>k,cm:()=>c,d1:()=>p,eP:()=>d,gf:()=>i,gq:()=>w,iD:()=>E,iI:()=>v,jT:()=>l,k_:()=>b,pv:()=>f,rR:()=>S,vD:()=>A,wk:()=>g,xU:()=>y,xZ:()=>T,yu:()=>a});var i="Cannot apply @injectable decorator multiple times.",r="NULL argument",a="Key Not Found",o="Ambiguous match found for serviceIdentifier:",s="Could not unbind serviceIdentifier:",c="No matching bindings found for serviceIdentifier:",u="Missing required @injectable annotation in:",d="Missing required @inject or @multiInject annotation in:",h="Circular dependency found:",l="Invalid binding type:",_="No snapshot available to restore.",f="Invalid return type in middleware. Middleware must return!",p="Value provided to function binding must be a function!",m=function(e){return"You are attempting to construct '"+e+"' in a synchronous way\n but it has asynchronous dependencies."},g="The toSelf function can only be applied when a constructor is used as service identifier",v=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},y="Invalid Container constructor argument. Container options must be an object.",b="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",S="Invalid Container option. Auto bind injectable must be a boolean",A="Invalid Container option. Skip base check must be a boolean",E="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)",w=function(e,t){return"@postConstruct error in class "+e+": "+t},T=function(e,t){return"@preDestroy error in class "+e+": "+t},R=function(e,t){return"onDeactivation() error in class "+e+": "+t},k=function(e,t){return"It looks like there is a circular dependency in one of the '"+e+"' bindings. Please investigate bindings withservice identifier '"+t+"'."},D="Maximum call stack size exceeded"},7269:(e,t,n)=>{"use strict";n.d(t,{B8:()=>s,FL:()=>h,LD:()=>u,Lc:()=>c,Mx:()=>a,Sy:()=>d,YO:()=>o,Z8:()=>f,af:()=>_,dM:()=>r,rQ:()=>l,vO:()=>i,xR:()=>p});var i="named",r="name",a="unmanaged",o="optional",s="inject",c="multi_inject",u="inversify:tagged",d="inversify:tagged_props",h="inversify:paramtypes",l="design:paramtypes",_="post_construct",f="pre_destroy";var p=[s,c,r,a,i,o]},6269:e=>{window,e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";var i=n(6),r=n.n(i),a=function(){function e(){}return e.e=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","error",i),e.ENABLE_ERROR&&(console.error?console.error(i):console.warn?console.warn(i):console.log(i))},e.i=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","info",i),e.ENABLE_INFO&&(console.info?console.info(i):console.log(i))},e.w=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","warn",i),e.ENABLE_WARN&&(console.warn?console.warn(i):console.log(i))},e.d=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","debug",i),e.ENABLE_DEBUG&&(console.debug?console.debug(i):console.log(i))},e.v=function(t,n){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var i="["+t+"] > "+n;e.ENABLE_CALLBACK&&e.emitter.emit("log","verbose",i),e.ENABLE_VERBOSE&&console.log(i)},e}();a.GLOBAL_TAG="mpegts.js",a.FORCE_GLOBAL_TAG=!1,a.ENABLE_ERROR=!0,a.ENABLE_INFO=!0,a.ENABLE_WARN=!0,a.ENABLE_DEBUG=!0,a.ENABLE_VERBOSE=!0,a.ENABLE_CALLBACK=!1,a.emitter=new r.a,t.a=a},function(e,t,n){"use strict";t.a={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",TIMED_ID3_METADATA_ARRIVED:"timed_id3_metadata_arrived",SMPTE2038_METADATA_ARRIVED:"smpte2038_metadata_arrived",SCTE35_METADATA_ARRIVED:"scte35_metadata_arrived",PES_PRIVATE_DATA_DESCRIPTOR:"pes_private_data_descriptor",PES_PRIVATE_DATA_ARRIVED:"pes_private_data_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"}},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var i=n(3),r={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},a={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},o=function(){function e(e){this._type=e||"undefined",this._status=r.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return e.prototype.destroy=function(){this._status=r.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},e.prototype.isWorking=function(){return this._status===r.kConnecting||this._status===r.kBuffering},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(e){this._onContentLengthKnown=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(e){this._onURLRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),e.prototype.open=function(e,t){throw new i.c("Unimplemented abstract function!")},e.prototype.abort=function(){throw new i.c("Unimplemented abstract function!")},e}()},function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var i,r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=function(){function e(e){this._message=e}return Object.defineProperty(e.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.name+": "+this.message},e}(),o=function(e){function t(t){return e.call(this,t)||this}return r(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),t}(a),s=function(e){function t(t){return e.call(this,t)||this}return r(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),t}(a),c=function(e){function t(t){return e.call(this,t)||this}return r(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),t}(a)},function(e,t,n){"use strict";var i={};!function(){var e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],n=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],r={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:n[0]||""},a={};if(r.browser){a[r.browser]=!0;var o=r.majorVersion.split(".");a.version={major:parseInt(r.majorVersion,10),string:r.version},o.length>1&&(a.version.minor=parseInt(o[1],10)),o.length>2&&(a.version.build=parseInt(o[2],10))}for(var s in r.platform&&(a[r.platform]=!0),(a.chrome||a.opr||a.safari)&&(a.webkit=!0),(a.rv||a.iemobile)&&(a.rv&&delete a.rv,r.browser="msie",a.msie=!0),a.edge&&(delete a.edge,r.browser="msedge",a.msedge=!0),a.opr&&(r.browser="opera",a.opera=!0),a.safari&&a.android&&(r.browser="android",a.android=!0),a.name=r.browser,a.platform=r.platform,i)i.hasOwnProperty(s)&&delete i[s];Object.assign(i,a)}(),t.a=i},function(e,t,n){"use strict";t.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(e,t,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,a=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,a),i(n)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}g(e,t,a,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&g(e,"error",t,n)}(e,r,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,n,i){var r,a,o,s;if(u(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=d(e))>0&&o.length>r&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,s=c,console&&console.warn&&console.warn(s)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=l.bind(i);return r.listener=n,i.wrapFn=r,r}function f(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):m(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function g(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(a){i.once&&e.removeEventListener(t,r),n(a)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return d(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=r[e];if(void 0===c)return!1;if("function"==typeof c)a(c,this,t);else{var u=c.length,d=m(c,u);for(n=0;n<u;++n)a(d[n],this,t)}return!0},s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,_(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,_(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,i,r,a,o;if(u(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o}));var i=function(e,t,n,i,r){this.dts=e,this.pts=t,this.duration=n,this.originalDts=i,this.isSyncPoint=r,this.fileposition=null},r=function(){function e(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return e.prototype.appendSyncPoint=function(e){e.isSyncPoint=!0,this.syncPoints.push(e)},e}(),a=function(){function e(){this._list=[]}return e.prototype.clear=function(){this._list=[]},e.prototype.appendArray=function(e){var t=this._list;0!==e.length&&(t.length>0&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))},e.prototype.getLastSyncPointBeforeDts=function(e){if(0==this._list.length)return null;var t=this._list,n=0,i=t.length-1,r=0,a=0,o=i;for(e<t[0].dts&&(n=0,a=o+1);a<=o;){if((r=a+Math.floor((o-a)/2))===i||e>=t[r].dts&&e<t[r+1].dts){n=r;break}t[r].dts<e?a=r+1:o=r-1}return this._list[n]},e}(),o=function(){function e(e){this._type=e,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this._list.length},e.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},e.prototype._searchNearestSegmentBefore=function(e){var t=this._list;if(0===t.length)return-2;var n=t.length-1,i=0,r=0,a=n,o=0;if(e<t[0].originalBeginDts)return-1;for(;r<=a;){if((i=r+Math.floor((a-r)/2))===n||e>t[i].lastSample.originalDts&&e<t[i+1].originalBeginDts){o=i;break}t[i].originalBeginDts<e?r=i+1:a=i-1}return o},e.prototype._searchNearestSegmentAfter=function(e){return this._searchNearestSegmentBefore(e)+1},e.prototype.append=function(e){var t=this._list,n=e,i=this._lastAppendLocation,r=0;-1!==i&&i<t.length&&n.originalBeginDts>=t[i].lastSample.originalDts&&(i===t.length-1||i<t.length-1&&n.originalBeginDts<t[i+1].originalBeginDts)?r=i+1:t.length>0&&(r=this._searchNearestSegmentBefore(n.originalBeginDts)+1),this._lastAppendLocation=r,this._list.splice(r,0,n)},e.prototype.getLastSegmentBefore=function(e){var t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null},e.prototype.getLastSampleBefore=function(e){var t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null},e.prototype.getLastSyncPointBefore=function(e){for(var t=this._searchNearestSegmentBefore(e),n=this._list[t].syncPoints;0===n.length&&t>0;)t--,n=this._list[t].syncPoints;return n.length>0?n[n.length-1]:null},e}()},function(e,t,n){"use strict";var i=function(){function e(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return e.prototype.isComplete=function(){var e=!1===this.hasAudio||!0===this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,t=!1===this.hasVideo||!0===this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&e&&t},e.prototype.isSeekable=function(){return!0===this.hasKeyframesIndex},e.prototype.getNearestKeyframe=function(e){if(null==this.keyframesIndex)return null;var t=this.keyframesIndex,n=this._search(t.times,e);return{index:n,milliseconds:t.times[n],fileposition:t.filepositions[n]}},e.prototype._search=function(e,t){var n=0,i=e.length-1,r=0,a=0,o=i;for(t<e[0]&&(n=0,a=o+1);a<=o;){if((r=a+Math.floor((o-a)/2))===i||t>=e[r]&&t<e[r+1]){n=r;break}e[r]<t?a=r+1:o=r-1}return n},e}();t.a=i},function(e,t,n){"use strict";var i=n(6),r=n.n(i),a=n(0),o=function(){function e(){}return Object.defineProperty(e,"forceGlobalTag",{get:function(){return a.a.FORCE_GLOBAL_TAG},set:function(t){a.a.FORCE_GLOBAL_TAG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"globalTag",{get:function(){return a.a.GLOBAL_TAG},set:function(t){a.a.GLOBAL_TAG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableAll",{get:function(){return a.a.ENABLE_VERBOSE&&a.a.ENABLE_DEBUG&&a.a.ENABLE_INFO&&a.a.ENABLE_WARN&&a.a.ENABLE_ERROR},set:function(t){a.a.ENABLE_VERBOSE=t,a.a.ENABLE_DEBUG=t,a.a.ENABLE_INFO=t,a.a.ENABLE_WARN=t,a.a.ENABLE_ERROR=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableDebug",{get:function(){return a.a.ENABLE_DEBUG},set:function(t){a.a.ENABLE_DEBUG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableVerbose",{get:function(){return a.a.ENABLE_VERBOSE},set:function(t){a.a.ENABLE_VERBOSE=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableInfo",{get:function(){return a.a.ENABLE_INFO},set:function(t){a.a.ENABLE_INFO=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableWarn",{get:function(){return a.a.ENABLE_WARN},set:function(t){a.a.ENABLE_WARN=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableError",{get:function(){return a.a.ENABLE_ERROR},set:function(t){a.a.ENABLE_ERROR=t,e._notifyChange()},enumerable:!1,configurable:!0}),e.getConfig=function(){return{globalTag:a.a.GLOBAL_TAG,forceGlobalTag:a.a.FORCE_GLOBAL_TAG,enableVerbose:a.a.ENABLE_VERBOSE,enableDebug:a.a.ENABLE_DEBUG,enableInfo:a.a.ENABLE_INFO,enableWarn:a.a.ENABLE_WARN,enableError:a.a.ENABLE_ERROR,enableCallback:a.a.ENABLE_CALLBACK}},e.applyConfig=function(e){a.a.GLOBAL_TAG=e.globalTag,a.a.FORCE_GLOBAL_TAG=e.forceGlobalTag,a.a.ENABLE_VERBOSE=e.enableVerbose,a.a.ENABLE_DEBUG=e.enableDebug,a.a.ENABLE_INFO=e.enableInfo,a.a.ENABLE_WARN=e.enableWarn,a.a.ENABLE_ERROR=e.enableError,a.a.ENABLE_CALLBACK=e.enableCallback},e._notifyChange=function(){var t=e.emitter;if(t.listenerCount("change")>0){var n=e.getConfig();t.emit("change",n)}},e.registerListener=function(t){e.emitter.addListener("change",t)},e.removeListener=function(t){e.emitter.removeListener("change",t)},e.addLogListener=function(t){a.a.emitter.addListener("log",t),a.a.emitter.listenerCount("log")>0&&(a.a.ENABLE_CALLBACK=!0,e._notifyChange())},e.removeLogListener=function(t){a.a.emitter.removeListener("log",t),0===a.a.emitter.listenerCount("log")&&(a.a.ENABLE_CALLBACK=!1,e._notifyChange())},e}();o.emitter=new r.a,t.a=o},function(e,t,n){"use strict";var i=n(6),r=n.n(i),a=n(0),o=n(4),s=n(8);function c(e,t,n){var i=e;if(t+n<i.length){for(;n--;)if(128!=(192&i[++t]))return!1;return!0}return!1}var u,d=function(e){for(var t=[],n=e,i=0,r=e.length;i<r;)if(n[i]<128)t.push(String.fromCharCode(n[i])),++i;else{if(n[i]<192);else if(n[i]<224){if(c(n,i,1)&&(a=(31&n[i])<<6|63&n[i+1])>=128){t.push(String.fromCharCode(65535&a)),i+=2;continue}}else if(n[i]<240){if(c(n,i,2)&&(a=(15&n[i])<<12|(63&n[i+1])<<6|63&n[i+2])>=2048&&55296!=(63488&a)){t.push(String.fromCharCode(65535&a)),i+=3;continue}}else if(n[i]<248){var a;if(c(n,i,3)&&(a=(7&n[i])<<18|(63&n[i+1])<<12|(63&n[i+2])<<6|63&n[i+3])>65536&&a<1114112){a-=65536,t.push(String.fromCharCode(a>>>10|55296)),t.push(String.fromCharCode(1023&a|56320)),i+=4;continue}}t.push(String.fromCharCode(65533)),++i}return t.join("")},h=n(3),l=(u=new ArrayBuffer(2),new DataView(u).setInt16(0,256,!0),256===new Int16Array(u)[0]),_=function(){function e(){}return e.parseScriptData=function(t,n,i){var r={};try{var o=e.parseValue(t,n,i),s=e.parseValue(t,n+o.size,i-o.size);r[o.data]=s.data}catch(e){a.a.e("AMF",e.toString())}return r},e.parseObject=function(t,n,i){if(i<3)throw new h.a("Data not enough when parse ScriptDataObject");var r=e.parseString(t,n,i),a=e.parseValue(t,n+r.size,i-r.size),o=a.objectEnd;return{data:{name:r.data,value:a.data},size:r.size+a.size,objectEnd:o}},e.parseVariable=function(t,n,i){return e.parseObject(t,n,i)},e.parseString=function(e,t,n){if(n<2)throw new h.a("Data not enough when parse String");var i=new DataView(e,t,n).getUint16(0,!l);return{data:i>0?d(new Uint8Array(e,t+2,i)):"",size:2+i}},e.parseLongString=function(e,t,n){if(n<4)throw new h.a("Data not enough when parse LongString");var i=new DataView(e,t,n).getUint32(0,!l);return{data:i>0?d(new Uint8Array(e,t+4,i)):"",size:4+i}},e.parseDate=function(e,t,n){if(n<10)throw new h.a("Data size invalid when parse Date");var i=new DataView(e,t,n),r=i.getFloat64(0,!l),a=i.getInt16(8,!l);return{data:new Date(r+=60*a*1e3),size:10}},e.parseValue=function(t,n,i){if(i<1)throw new h.a("Data not enough when parse Value");var r,o=new DataView(t,n,i),s=1,c=o.getUint8(0),u=!1;try{switch(c){case 0:r=o.getFloat64(1,!l),s+=8;break;case 1:r=!!o.getUint8(1),s+=1;break;case 2:var d=e.parseString(t,n+1,i-1);r=d.data,s+=d.size;break;case 3:r={};var _=0;for(9==(16777215&o.getUint32(i-4,!l))&&(_=3);s<i-4;){var f=e.parseObject(t,n+s,i-s-_);if(f.objectEnd)break;r[f.data.name]=f.data.value,s+=f.size}s<=i-3&&9==(16777215&o.getUint32(s-1,!l))&&(s+=3);break;case 8:for(r={},s+=4,_=0,9==(16777215&o.getUint32(i-4,!l))&&(_=3);s<i-8;){var p=e.parseVariable(t,n+s,i-s-_);if(p.objectEnd)break;r[p.data.name]=p.data.value,s+=p.size}s<=i-3&&9==(16777215&o.getUint32(s-1,!l))&&(s+=3);break;case 9:r=void 0,s=1,u=!0;break;case 10:r=[];var m=o.getUint32(1,!l);s+=4;for(var g=0;g<m;g++){var v=e.parseValue(t,n+s,i-s);r.push(v.data),s+=v.size}break;case 11:var y=e.parseDate(t,n+1,i-1);r=y.data,s+=y.size;break;case 12:var b=e.parseString(t,n+1,i-1);r=b.data,s+=b.size;break;default:s=i,a.a.w("AMF","Unsupported AMF value type "+c)}}catch(e){a.a.e("AMF",e.toString())}return{data:r,size:s,objectEnd:u}},e}(),f=function(){function e(e){this.TAG="ExpGolomb",this._buffer=e,this._buffer_index=0,this._total_bytes=e.byteLength,this._total_bits=8*e.byteLength,this._current_word=0,this._current_word_bits_left=0}return e.prototype.destroy=function(){this._buffer=null},e.prototype._fillCurrentWord=function(){var e=this._total_bytes-this._buffer_index;if(e<=0)throw new h.a("ExpGolomb: _fillCurrentWord() but no bytes available");var t=Math.min(4,e),n=new Uint8Array(4);n.set(this._buffer.subarray(this._buffer_index,this._buffer_index+t)),this._current_word=new DataView(n.buffer).getUint32(0,!1),this._buffer_index+=t,this._current_word_bits_left=8*t},e.prototype.readBits=function(e){if(e>32)throw new h.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(e<=this._current_word_bits_left){var t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}var n=this._current_word_bits_left?this._current_word:0;n>>>=32-this._current_word_bits_left;var i=e-this._current_word_bits_left;this._fillCurrentWord();var r=Math.min(i,this._current_word_bits_left),a=this._current_word>>>32-r;return this._current_word<<=r,this._current_word_bits_left-=r,n<<r|a},e.prototype.readBool=function(){return 1===this.readBits(1)},e.prototype.readByte=function(){return this.readBits(8)},e.prototype._skipLeadingZero=function(){var e;for(e=0;e<this._current_word_bits_left;e++)if(0!=(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()},e.prototype.readUEG=function(){var e=this._skipLeadingZero();return this.readBits(e+1)-1},e.prototype.readSEG=function(){var e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)},e}(),p=function(){function e(){}return e._ebsp2rbsp=function(e){for(var t=e,n=t.byteLength,i=new Uint8Array(n),r=0,a=0;a<n;a++)a>=2&&3===t[a]&&0===t[a-1]&&0===t[a-2]||(i[r]=t[a],r++);return new Uint8Array(i.buffer,0,r)},e.parseSPS=function(t){for(var n=t.subarray(1,4),i="avc1.",r=0;r<3;r++){var a=n[r].toString(16);a.length<2&&(a="0"+a),i+=a}var o=e._ebsp2rbsp(t),s=new f(o);s.readByte();var c=s.readByte();s.readByte();var u=s.readByte();s.readUEG();var d=e.getProfileString(c),h=e.getLevelString(u),l=1,_=420,p=8,m=8;if((100===c||110===c||122===c||244===c||44===c||83===c||86===c||118===c||128===c||138===c||144===c)&&(3===(l=s.readUEG())&&s.readBits(1),l<=3&&(_=[0,420,422,444][l]),p=s.readUEG()+8,m=s.readUEG()+8,s.readBits(1),s.readBool()))for(var g=3!==l?8:12,v=0;v<g;v++)s.readBool()&&(v<6?e._skipScalingList(s,16):e._skipScalingList(s,64));s.readUEG();var y=s.readUEG();if(0===y)s.readUEG();else if(1===y){s.readBits(1),s.readSEG(),s.readSEG();var b=s.readUEG();for(v=0;v<b;v++)s.readSEG()}var S=s.readUEG();s.readBits(1);var A=s.readUEG(),E=s.readUEG(),w=s.readBits(1);0===w&&s.readBits(1),s.readBits(1);var T=0,R=0,k=0,D=0;s.readBool()&&(T=s.readUEG(),R=s.readUEG(),k=s.readUEG(),D=s.readUEG());var L=1,C=1,I=0,O=!0,P=0,B=0;if(s.readBool()){if(s.readBool()){var M=s.readByte();M>0&&M<16?(L=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][M-1],C=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][M-1]):255===M&&(L=s.readByte()<<8|s.readByte(),C=s.readByte()<<8|s.readByte())}if(s.readBool()&&s.readBool(),s.readBool()&&(s.readBits(4),s.readBool()&&s.readBits(24)),s.readBool()&&(s.readUEG(),s.readUEG()),s.readBool()){var x=s.readBits(32),U=s.readBits(32);O=s.readBool(),I=(P=U)/(B=2*x)}}var N=1;1===L&&1===C||(N=L/C);var G=0,F=0;0===l?(G=1,F=2-w):(G=3===l?1:2,F=(1===l?2:1)*(2-w));var j=16*(A+1),V=16*(E+1)*(2-w);j-=(T+R)*G,V-=(k+D)*F;var z=Math.ceil(j*N);return s.destroy(),s=null,{codec_mimetype:i,profile_idc:c,level_idc:u,profile_string:d,level_string:h,chroma_format_idc:l,bit_depth:p,bit_depth_luma:p,bit_depth_chroma:m,ref_frames:S,chroma_format:_,chroma_format_string:e.getChromaFormatString(_),frame_rate:{fixed:O,fps:I,fps_den:B,fps_num:P},sar_ratio:{width:L,height:C},codec_size:{width:j,height:V},present_size:{width:z,height:V}}},e._skipScalingList=function(e,t){for(var n=8,i=8,r=0;r<t;r++)0!==i&&(i=(n+e.readSEG()+256)%256),n=0===i?n:i},e.getProfileString=function(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},e.getLevelString=function(e){return(e/10).toFixed(1)},e.getChromaFormatString=function(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},e}(),m=n(5),g=function(){function e(){}return e._ebsp2rbsp=function(e){for(var t=e,n=t.byteLength,i=new Uint8Array(n),r=0,a=0;a<n;a++)a>=2&&3===t[a]&&0===t[a-1]&&0===t[a-2]||(i[r]=t[a],r++);return new Uint8Array(i.buffer,0,r)},e.parseVPS=function(t){var n=e._ebsp2rbsp(t),i=new f(n);return i.readByte(),i.readByte(),i.readBits(4),i.readBits(2),i.readBits(6),{num_temporal_layers:i.readBits(3)+1,temporal_id_nested:i.readBool()}},e.parseSPS=function(t){var n=e._ebsp2rbsp(t),i=new f(n);i.readByte(),i.readByte();for(var r=0,a=0,o=0,s=0,c=(i.readBits(4),i.readBits(3)),u=(i.readBool(),i.readBits(2)),d=i.readBool(),h=i.readBits(5),l=i.readByte(),_=i.readByte(),p=i.readByte(),m=i.readByte(),g=i.readByte(),v=i.readByte(),y=i.readByte(),b=i.readByte(),S=i.readByte(),A=i.readByte(),E=i.readByte(),w=[],T=[],R=0;R<c;R++)w.push(i.readBool()),T.push(i.readBool());if(c>0)for(R=c;R<8;R++)i.readBits(2);for(R=0;R<c;R++)w[R]&&(i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte(),i.readByte()),T[R]&&i.readByte();i.readUEG();var k=i.readUEG();3==k&&i.readBits(1);var D=i.readUEG(),L=i.readUEG();i.readBool()&&(r+=i.readUEG(),a+=i.readUEG(),o+=i.readUEG(),s+=i.readUEG());var C=i.readUEG(),I=i.readUEG(),O=i.readUEG();for(R=i.readBool()?0:c;R<=c;R++)i.readUEG(),i.readUEG(),i.readUEG();if(i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readBool()&&i.readBool())for(var P=0;P<4;P++)for(var B=0;B<(3===P?2:6);B++)if(i.readBool()){var M=Math.min(64,1<<4+(P<<1));for(P>1&&i.readSEG(),R=0;R<M;R++)i.readSEG()}else i.readUEG();i.readBool(),i.readBool(),i.readBool()&&(i.readByte(),i.readUEG(),i.readUEG(),i.readBool());var x=i.readUEG(),U=0;for(R=0;R<x;R++){var N=!1;if(0!==R&&(N=i.readBool()),N){R===x&&i.readUEG(),i.readBool(),i.readUEG();for(var G=0,F=0;F<=U;F++){var j=i.readBool(),V=!1;j||(V=i.readBool()),(j||V)&&G++}U=G}else{var z=i.readUEG(),q=i.readUEG();for(U=z+q,F=0;F<z;F++)i.readUEG(),i.readBool();for(F=0;F<q;F++)i.readUEG(),i.readBool()}}if(i.readBool()){var H=i.readUEG();for(R=0;R<H;R++){for(F=0;F<O+4;F++)i.readBits(1);i.readBits(1)}}var W=0,K=1,Y=1,X=!1,Z=1,J=1;if(i.readBool(),i.readBool(),i.readBool()){if(i.readBool()){var Q=i.readByte();Q>0&&Q<=16?(K=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][Q-1],Y=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][Q-1]):255===Q&&(K=i.readBits(16),Y=i.readBits(16))}if(i.readBool()&&i.readBool(),i.readBool()&&(i.readBits(3),i.readBool(),i.readBool()&&(i.readByte(),i.readByte(),i.readByte())),i.readBool()&&(i.readUEG(),i.readUEG()),i.readBool(),i.readBool(),i.readBool(),i.readBool()&&(i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG()),i.readBool()&&(Z=i.readBits(32),J=i.readBits(32),i.readBool()&&(i.readUEG(),i.readBool()))){var $=!1,ee=!1,te=!1;for($=i.readBool(),ee=i.readBool(),($||ee)&&((te=i.readBool())&&(i.readByte(),i.readBits(5),i.readBool(),i.readBits(5)),i.readBits(4),i.readBits(4),te&&i.readBits(4),i.readBits(5),i.readBits(5),i.readBits(5)),R=0;R<=c;R++){var ne=i.readBool();X=ne;var ie=!1,re=1;ne||(ie=i.readBool());var ae=!1;if(ie?i.readSEG():ae=i.readBool(),ae||(re=i.readUEG()+1),$)for(F=0;F<re;F++)i.readUEG(),i.readUEG(),te&&(i.readUEG(),i.readUEG());if(ee)for(F=0;F<re;F++)i.readUEG(),i.readUEG(),te&&(i.readUEG(),i.readUEG())}}i.readBool()&&(i.readBool(),i.readBool(),i.readBool(),W=i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG(),i.readUEG())}i.readBool();var oe="hvc1."+h+".1.L"+E+".B0",se=D-(r+a)*(1===k||2===k?2:1),ce=L-(o+s)*(1===k?2:1),ue=1;return 1!==K&&1!==Y&&(ue=K/Y),i.destroy(),i=null,{codec_mimetype:oe,level_string:e.getLevelString(E),profile_idc:h,bit_depth:C+8,ref_frames:1,chroma_format:k,chroma_format_string:e.getChromaFormatString(k),general_level_idc:E,general_profile_space:u,general_tier_flag:d,general_profile_idc:h,general_profile_compatibility_flags_1:l,general_profile_compatibility_flags_2:_,general_profile_compatibility_flags_3:p,general_profile_compatibility_flags_4:m,general_constraint_indicator_flags_1:g,general_constraint_indicator_flags_2:v,general_constraint_indicator_flags_3:y,general_constraint_indicator_flags_4:b,general_constraint_indicator_flags_5:S,general_constraint_indicator_flags_6:A,min_spatial_segmentation_idc:W,constant_frame_rate:0,chroma_format_idc:k,bit_depth_luma_minus8:C,bit_depth_chroma_minus8:I,frame_rate:{fixed:X,fps:J/Z,fps_den:Z,fps_num:J},sar_ratio:{width:K,height:Y},codec_size:{width:se,height:ce},present_size:{width:se*ue,height:ce}}},e.parsePPS=function(t){var n=e._ebsp2rbsp(t),i=new f(n);i.readByte(),i.readByte(),i.readUEG(),i.readUEG(),i.readBool(),i.readBool(),i.readBits(3),i.readBool(),i.readBool(),i.readUEG(),i.readUEG(),i.readSEG(),i.readBool(),i.readBool(),i.readBool()&&i.readUEG(),i.readSEG(),i.readSEG(),i.readBool(),i.readBool(),i.readBool(),i.readBool();var r=i.readBool(),a=i.readBool(),o=1;return a&&r?o=0:a?o=3:r&&(o=2),{parallelismType:o}},e.getChromaFormatString=function(e){switch(e){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},e.getProfileString=function(e){switch(e){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},e.getLevelString=function(e){return(e/30).toFixed(1)},e}();function v(e){return e.byteOffset%2==0&&e.byteLength%2==0}function y(e){return e.byteOffset%4==0&&e.byteLength%4==0}function b(e,t){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var S,A=function(e,t){return e.byteLength===t.byteLength&&(y(e)&&y(t)?function(e,t){return b(new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4),new Uint32Array(t.buffer,t.byteOffset,t.byteLength/4))}(e,t):v(e)&&v(t)?function(e,t){return b(new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2))}(e,t):function(e,t){return b(e,t)}(e,t))},E=function(){function e(e,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=e.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=e.hasAudioTrack,this._hasVideo=e.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new s.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}()}return e.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},e.probe=function(e){var t=new Uint8Array(e);if(t.byteLength<9)return{needMoreData:!0};var n={match:!1};if(70!==t[0]||76!==t[1]||86!==t[2]||1!==t[3])return n;var i,r,a=(4&t[4])>>>2!=0,o=0!=(1&t[4]),s=(i=t)[r=5]<<24|i[r+1]<<16|i[r+2]<<8|i[r+3];return s<9?n:{match:!0,consumed:s,dataOffset:s,hasAudioTrack:a,hasVideoTrack:o}},e.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(e.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(e){this._onTrackMetadata=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(e){this._onMediaInfo=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(e){this._onMetaDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(e){this._onScriptDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(e){this._onDataAvailable=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(e){this._timestampBase=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedDuration",{get:function(){return this._duration},set:function(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo.duration=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasAudio",{set:function(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo.hasAudio=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasVideo",{set:function(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo.hasVideo=e},enumerable:!1,configurable:!0}),e.prototype.resetMediaInfo=function(){this._mediaInfo=new s.a},e.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},e.prototype.parseChunks=function(t,n){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new h.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var i=0,r=this._littleEndian;if(0===n){if(!(t.byteLength>13))return 0;i=e.probe(t).dataOffset}for(this._firstParse&&(this._firstParse=!1,n+i!==this._dataOffset&&a.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),0!==(o=new DataView(t,i)).getUint32(0,!r)&&a.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),i+=4);i<t.byteLength;){this._dispatch=!0;var o=new DataView(t,i);if(i+11+4>t.byteLength)break;var s=o.getUint8(0),c=16777215&o.getUint32(0,!r);if(i+11+c+4>t.byteLength)break;if(8===s||9===s||18===s){var u=o.getUint8(4),d=o.getUint8(5),l=o.getUint8(6)|d<<8|u<<16|o.getUint8(7)<<24;0!=(16777215&o.getUint32(7,!r))&&a.a.w(this.TAG,"Meet tag which has StreamID != 0!");var _=i+11;switch(s){case 8:this._parseAudioData(t,_,c,l);break;case 9:this._parseVideoData(t,_,c,l,n+i);break;case 18:this._parseScriptData(t,_,c)}var f=o.getUint32(11+c,!r);f!==11+c&&a.a.w(this.TAG,"Invalid PrevTagSize "+f),i+=11+c+4}else a.a.w(this.TAG,"Unsupported tag type "+s+", skipped"),i+=11+c+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),i},e.prototype._parseScriptData=function(e,t,n){var i=_.parseScriptData(e,t,n);if(i.hasOwnProperty("onMetaData")){if(null==i.onMetaData||"object"!=typeof i.onMetaData)return void a.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&a.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=i;var r=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},r)),"boolean"==typeof r.hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=r.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),"boolean"==typeof r.hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=r.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),"number"==typeof r.audiodatarate&&(this._mediaInfo.audioDataRate=r.audiodatarate),"number"==typeof r.videodatarate&&(this._mediaInfo.videoDataRate=r.videodatarate),"number"==typeof r.width&&(this._mediaInfo.width=r.width),"number"==typeof r.height&&(this._mediaInfo.height=r.height),"number"==typeof r.duration){if(!this._durationOverrided){var o=Math.floor(r.duration*this._timescale);this._duration=o,this._mediaInfo.duration=o}}else this._mediaInfo.duration=0;if("number"==typeof r.framerate){var s=Math.floor(1e3*r.framerate);if(s>0){var c=s/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=c,this._referenceFrameRate.fps_num=s,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=c}}if("object"==typeof r.keyframes){this._mediaInfo.hasKeyframesIndex=!0;var u=r.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(u),r.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=r,a.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(i).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},i))},e.prototype._parseKeyframesIndex=function(e){for(var t=[],n=[],i=1;i<e.times.length;i++){var r=this._timestampBase+Math.floor(1e3*e.times[i]);t.push(r),n.push(e.filepositions[i])}return{times:t,filepositions:n}},e.prototype._parseAudioData=function(e,t,n,i){if(n<=1)a.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(!0!==this._hasAudioFlagOverrided||!1!==this._hasAudio){this._littleEndian;var r=new DataView(e,t,n).getUint8(0),o=r>>>4;if(2===o||10===o){var s=0,c=(12&r)>>>2;if(c>=0&&c<=4){s=this._flvSoundRateTable[c];var u=1&r,d=this._audioMetadata,h=this._audioTrack;if(d||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(d=this._audioMetadata={}).type="audio",d.id=h.id,d.timescale=this._timescale,d.duration=this._duration,d.audioSampleRate=s,d.channelCount=0===u?1:2),10===o){var l=this._parseAACAudioData(e,t+1,n-1);if(null==l)return;if(0===l.packetType){if(d.config){if(A(l.data.config,d.config))return;a.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var _=l.data;d.audioSampleRate=_.samplingRate,d.channelCount=_.channelCount,d.codec=_.codec,d.originalCodec=_.originalCodec,d.config=_.config,d.refSampleDuration=1024/d.audioSampleRate*d.timescale,a.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",d),(g=this._mediaInfo).audioCodec=d.originalCodec,g.audioSampleRate=d.audioSampleRate,g.audioChannelCount=d.channelCount,g.hasVideo?null!=g.videoCodec&&(g.mimeType='video/x-flv; codecs="'+g.videoCodec+","+g.audioCodec+'"'):g.mimeType='video/x-flv; codecs="'+g.audioCodec+'"',g.isComplete()&&this._onMediaInfo(g)}else if(1===l.packetType){var f=this._timestampBase+i,p={unit:l.data,length:l.data.byteLength,dts:f,pts:f};h.samples.push(p),h.length+=l.data.length}else a.a.e(this.TAG,"Flv: Unsupported AAC data type "+l.packetType)}else if(2===o){if(!d.codec){var g;if(null==(_=this._parseMP3AudioData(e,t+1,n-1,!0)))return;d.audioSampleRate=_.samplingRate,d.channelCount=_.channelCount,d.codec=_.codec,d.originalCodec=_.originalCodec,d.refSampleDuration=1152/d.audioSampleRate*d.timescale,a.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",d),(g=this._mediaInfo).audioCodec=d.codec,g.audioSampleRate=d.audioSampleRate,g.audioChannelCount=d.channelCount,g.audioDataRate=_.bitRate,g.hasVideo?null!=g.videoCodec&&(g.mimeType='video/x-flv; codecs="'+g.videoCodec+","+g.audioCodec+'"'):g.mimeType='video/x-flv; codecs="'+g.audioCodec+'"',g.isComplete()&&this._onMediaInfo(g)}var v=this._parseMP3AudioData(e,t+1,n-1,!1);if(null==v)return;f=this._timestampBase+i;var y={unit:v,length:v.byteLength,dts:f,pts:f};h.samples.push(y),h.length+=v.length}}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+c)}else this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+o)}},e.prototype._parseAACAudioData=function(e,t,n){if(!(n<=1)){var i={},r=new Uint8Array(e,t,n);return i.packetType=r[0],0===r[0]?i.data=this._parseAACAudioSpecificConfig(e,t+1,n-1):i.data=r.subarray(1),i}a.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},e.prototype._parseAACAudioSpecificConfig=function(e,t,n){var i,r,a=new Uint8Array(e,t,n),o=null,s=0,c=null;if(s=i=a[0]>>>3,(r=(7&a[0])<<1|a[1]>>>7)<0||r>=this._mpegSamplingRates.length)this._onError(m.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var u=this._mpegSamplingRates[r],d=(120&a[1])>>>3;if(!(d<0||d>=8)){5===s&&(c=(7&a[1])<<1|a[2]>>>7,a[2]);var h=self.navigator.userAgent.toLowerCase();return-1!==h.indexOf("firefox")?r>=6?(s=5,o=new Array(4),c=r-3):(s=2,o=new Array(2),c=r):-1!==h.indexOf("android")?(s=2,o=new Array(2),c=r):(s=5,c=r,o=new Array(4),r>=6?c=r-3:1===d&&(s=2,o=new Array(2),c=r)),o[0]=s<<3,o[0]|=(15&r)>>>1,o[1]=(15&r)<<7,o[1]|=(15&d)<<3,5===s&&(o[1]|=(15&c)>>>1,o[2]=(1&c)<<7,o[2]|=8,o[3]=0),{config:o,samplingRate:u,channelCount:d,codec:"mp4a.40."+s,originalCodec:"mp4a.40."+i}}this._onError(m.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},e.prototype._parseMP3AudioData=function(e,t,n,i){if(!(n<4)){this._littleEndian;var r=new Uint8Array(e,t,n),o=null;if(i){if(255!==r[0])return;var s=r[1]>>>3&3,c=(6&r[1])>>1,u=(240&r[2])>>>4,d=(12&r[2])>>>2,h=3!=(r[3]>>>6&3)?2:1,l=0,_=0;switch(s){case 0:l=this._mpegAudioV25SampleRateTable[d];break;case 2:l=this._mpegAudioV20SampleRateTable[d];break;case 3:l=this._mpegAudioV10SampleRateTable[d]}switch(c){case 1:u<this._mpegAudioL3BitRateTable.length&&(_=this._mpegAudioL3BitRateTable[u]);break;case 2:u<this._mpegAudioL2BitRateTable.length&&(_=this._mpegAudioL2BitRateTable[u]);break;case 3:u<this._mpegAudioL1BitRateTable.length&&(_=this._mpegAudioL1BitRateTable[u])}o={bitRate:_,samplingRate:l,channelCount:h,codec:"mp3",originalCodec:"mp3"}}else o=r;return o}a.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},e.prototype._parseVideoData=function(e,t,n,i,r){if(n<=1)a.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(!0!==this._hasVideoFlagOverrided||!1!==this._hasVideo){var o=new Uint8Array(e,t,n)[0],s=(112&o)>>>4;if(0!=(128&o)){var c=15&o,u=String.fromCharCode.apply(String,new Uint8Array(e,t,n).slice(1,5));if("hvc1"!==u)return void this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+u);this._parseEnhancedHEVCVideoPacket(e,t+5,n-5,i,r,s,c)}else{var d=15&o;if(7===d)this._parseAVCVideoPacket(e,t+1,n-1,i,r,s);else{if(12!==d)return void this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+d);this._parseHEVCVideoPacket(e,t+1,n-1,i,r,s)}}}},e.prototype._parseAVCVideoPacket=function(e,t,n,i,r,o){if(n<4)a.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var s=this._littleEndian,c=new DataView(e,t,n),u=c.getUint8(0),d=(16777215&c.getUint32(0,!s))<<8>>8;if(0===u)this._parseAVCDecoderConfigurationRecord(e,t+4,n-4);else if(1===u)this._parseAVCVideoData(e,t+4,n-4,i,r,o,d);else if(2!==u)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+u)}},e.prototype._parseHEVCVideoPacket=function(e,t,n,i,r,o){if(n<4)a.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var s=this._littleEndian,c=new DataView(e,t,n),u=c.getUint8(0),d=(16777215&c.getUint32(0,!s))<<8>>8;if(0===u)this._parseHEVCDecoderConfigurationRecord(e,t+4,n-4);else if(1===u)this._parseHEVCVideoData(e,t+4,n-4,i,r,o,d);else if(2!==u)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+u)}},e.prototype._parseEnhancedHEVCVideoPacket=function(e,t,n,i,r,o,s){if(n<4)a.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var c=this._littleEndian,u=new DataView(e,t,n);if(0===s)this._parseHEVCDecoderConfigurationRecord(e,t,n);else if(1===s){var d=(4294967040&u.getUint32(0,!c))>>8;this._parseHEVCVideoData(e,t+3,n-3,i,r,o,d)}else if(3===s)this._parseHEVCVideoData(e,t,n,i,r,o,0);else if(2!==s)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+s)}},e.prototype._parseAVCDecoderConfigurationRecord=function(e,t,n){if(n<7)a.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var i=this._videoMetadata,r=this._videoTrack,o=this._littleEndian,s=new DataView(e,t,n);if(i){if(void 0!==i.avcc){var c=new Uint8Array(e,t,n);if(A(c,i.avcc))return;a.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(i=this._videoMetadata={}).type="video",i.id=r.id,i.timescale=this._timescale,i.duration=this._duration;var u=s.getUint8(0),d=s.getUint8(1);if(s.getUint8(2),s.getUint8(3),1===u&&0!==d)if(this._naluLengthSize=1+(3&s.getUint8(4)),3===this._naluLengthSize||4===this._naluLengthSize){var h=31&s.getUint8(5);if(0!==h){h>1&&a.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+h);for(var l=6,_=0;_<h;_++){var f=s.getUint16(l,!o);if(l+=2,0!==f){var g=new Uint8Array(e,t+l,f);l+=f;var v=p.parseSPS(g);if(0===_){i.codecWidth=v.codec_size.width,i.codecHeight=v.codec_size.height,i.presentWidth=v.present_size.width,i.presentHeight=v.present_size.height,i.profile=v.profile_string,i.level=v.level_string,i.bitDepth=v.bit_depth,i.chromaFormat=v.chroma_format,i.sarRatio=v.sar_ratio,i.frameRate=v.frame_rate,!1!==v.frame_rate.fixed&&0!==v.frame_rate.fps_num&&0!==v.frame_rate.fps_den||(i.frameRate=this._referenceFrameRate);var y=i.frameRate.fps_den,b=i.frameRate.fps_num;i.refSampleDuration=i.timescale*(y/b);for(var S=g.subarray(1,4),E="avc1.",w=0;w<3;w++){var T=S[w].toString(16);T.length<2&&(T="0"+T),E+=T}i.codec=E;var R=this._mediaInfo;R.width=i.codecWidth,R.height=i.codecHeight,R.fps=i.frameRate.fps,R.profile=i.profile,R.level=i.level,R.refFrames=v.ref_frames,R.chromaFormat=v.chroma_format_string,R.sarNum=i.sarRatio.width,R.sarDen=i.sarRatio.height,R.videoCodec=E,R.hasAudio?null!=R.audioCodec&&(R.mimeType='video/x-flv; codecs="'+R.videoCodec+","+R.audioCodec+'"'):R.mimeType='video/x-flv; codecs="'+R.videoCodec+'"',R.isComplete()&&this._onMediaInfo(R)}}}var k=s.getUint8(l);if(0!==k){for(k>1&&a.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+k),l++,_=0;_<k;_++)f=s.getUint16(l,!o),l+=2,0!==f&&(l+=f);i.avcc=new Uint8Array(n),i.avcc.set(new Uint8Array(e,t,n),0),a.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",i)}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(m.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},e.prototype._parseHEVCDecoderConfigurationRecord=function(e,t,n){if(n<22)a.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var i=this._videoMetadata,r=this._videoTrack,o=this._littleEndian,s=new DataView(e,t,n);if(i){if(void 0!==i.hvcc){var c=new Uint8Array(e,t,n);if(A(c,i.hvcc))return;a.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(i=this._videoMetadata={}).type="video",i.id=r.id,i.timescale=this._timescale,i.duration=this._duration;var u=s.getUint8(0),d=31&s.getUint8(1);if(1===u&&0!==d)if(this._naluLengthSize=1+(3&s.getUint8(21)),3===this._naluLengthSize||4===this._naluLengthSize){for(var h=s.getUint8(22),l=0,_=23;l<h;l++){var f=63&s.getUint8(_+0),p=s.getUint16(_+1,!o);_+=3;for(var v=0;v<p;v++){var y=s.getUint16(_+0,!o);if(0===v)if(33===f){_+=2;var b=new Uint8Array(e,t+_,y),S=g.parseSPS(b);i.codecWidth=S.codec_size.width,i.codecHeight=S.codec_size.height,i.presentWidth=S.present_size.width,i.presentHeight=S.present_size.height,i.profile=S.profile_string,i.level=S.level_string,i.bitDepth=S.bit_depth,i.chromaFormat=S.chroma_format,i.sarRatio=S.sar_ratio,i.frameRate=S.frame_rate,!1!==S.frame_rate.fixed&&0!==S.frame_rate.fps_num&&0!==S.frame_rate.fps_den||(i.frameRate=this._referenceFrameRate);var E=i.frameRate.fps_den,w=i.frameRate.fps_num;i.refSampleDuration=i.timescale*(E/w),i.codec=S.codec_mimetype;var T=this._mediaInfo;T.width=i.codecWidth,T.height=i.codecHeight,T.fps=i.frameRate.fps,T.profile=i.profile,T.level=i.level,T.refFrames=S.ref_frames,T.chromaFormat=S.chroma_format_string,T.sarNum=i.sarRatio.width,T.sarDen=i.sarRatio.height,T.videoCodec=S.codec_mimetype,T.hasAudio?null!=T.audioCodec&&(T.mimeType='video/x-flv; codecs="'+T.videoCodec+","+T.audioCodec+'"'):T.mimeType='video/x-flv; codecs="'+T.videoCodec+'"',T.isComplete()&&this._onMediaInfo(T),_+=y}else _+=2+y;else _+=2+y}}i.hvcc=new Uint8Array(n),i.hvcc.set(new Uint8Array(e,t,n),0),a.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",i)}else this._onError(m.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord")}},e.prototype._parseAVCVideoData=function(e,t,n,i,r,o,s){for(var c=this._littleEndian,u=new DataView(e,t,n),d=[],h=0,l=0,_=this._naluLengthSize,f=this._timestampBase+i,p=1===o;l<n;){if(l+4>=n){a.a.w(this.TAG,"Malformed Nalu near timestamp "+f+", offset = "+l+", dataSize = "+n);break}var m=u.getUint32(l,!c);if(3===_&&(m>>>=8),m>n-_)return void a.a.w(this.TAG,"Malformed Nalus near timestamp "+f+", NaluSize > DataSize!");var g=31&u.getUint8(l+_);5===g&&(p=!0);var v=new Uint8Array(e,t+l,_+m),y={type:g,data:v};d.push(y),h+=v.byteLength,l+=_+m}if(d.length){var b=this._videoTrack,S={units:d,length:h,isKeyframe:p,dts:f,cts:s,pts:f+s};p&&(S.fileposition=r),b.samples.push(S),b.length+=h}},e.prototype._parseHEVCVideoData=function(e,t,n,i,r,o,s){for(var c=this._littleEndian,u=new DataView(e,t,n),d=[],h=0,l=0,_=this._naluLengthSize,f=this._timestampBase+i,p=1===o;l<n;){if(l+4>=n){a.a.w(this.TAG,"Malformed Nalu near timestamp "+f+", offset = "+l+", dataSize = "+n);break}var m=u.getUint32(l,!c);if(3===_&&(m>>>=8),m>n-_)return void a.a.w(this.TAG,"Malformed Nalus near timestamp "+f+", NaluSize > DataSize!");var g=31&u.getUint8(l+_);19!==g&&20!==g||(p=!0);var v=new Uint8Array(e,t+l,_+m),y={type:g,data:v};d.push(y),h+=v.byteLength,l+=_+m}if(d.length){var b=this._videoTrack,S={units:d,length:h,isKeyframe:p,dts:f,cts:s,pts:f+s};p&&(S.fileposition=r),b.samples.push(S),b.length+=h}},e}(),w=function(){function e(){}return e.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null},e}(),T=function(){this.program_pmt_pid={}};!function(e){e[e.kMPEG1Audio=3]="kMPEG1Audio",e[e.kMPEG2Audio=4]="kMPEG2Audio",e[e.kPESPrivateData=6]="kPESPrivateData",e[e.kADTSAAC=15]="kADTSAAC",e[e.kLOASAAC=17]="kLOASAAC",e[e.kAC3=129]="kAC3",e[e.kID3=21]="kID3",e[e.kSCTE35=134]="kSCTE35",e[e.kH264=27]="kH264",e[e.kH265=36]="kH265"}(S||(S={}));var R,k=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.scte_35_pids={},this.smpte2038_pids={}},D=function(){},L=function(){},C=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};!function(e){e[e.kUnspecified=0]="kUnspecified",e[e.kSliceNonIDR=1]="kSliceNonIDR",e[e.kSliceDPA=2]="kSliceDPA",e[e.kSliceDPB=3]="kSliceDPB",e[e.kSliceDPC=4]="kSliceDPC",e[e.kSliceIDR=5]="kSliceIDR",e[e.kSliceSEI=6]="kSliceSEI",e[e.kSliceSPS=7]="kSliceSPS",e[e.kSlicePPS=8]="kSlicePPS",e[e.kSliceAUD=9]="kSliceAUD",e[e.kEndOfSequence=10]="kEndOfSequence",e[e.kEndOfStream=11]="kEndOfStream",e[e.kFiller=12]="kFiller",e[e.kSPSExt=13]="kSPSExt",e[e.kReserved0=14]="kReserved0"}(R||(R={}));var I,O,P=function(){},B=function(e){var t=e.data.byteLength;this.type=e.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(e.data,4)},M=function(){function e(e){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return e.prototype.findNextStartCodeOffset=function(e){for(var t=e,n=this.data_;;){if(t+3>=n.byteLength)return this.eof_flag_=!0,n.byteLength;var i=n[t+0]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3],r=n[t+0]<<16|n[t+1]<<8|n[t+2];if(1===i||1===r)return t;t++}},e.prototype.readNextNaluPayload=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var n=this.current_startcode_offset_,i=31&e[n+=1==(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3])?4:3],r=(128&e[n])>>>7,a=this.findNextStartCodeOffset(n);if(this.current_startcode_offset_=a,!(i>=R.kReserved0)&&0===r){var o=e.subarray(n,a);(t=new P).type=i,t.data=o}}return t},e}(),x=function(){function e(e,t,n){var i=8+e.byteLength+1+2+t.byteLength,r=!1;66!==e[3]&&77!==e[3]&&88!==e[3]&&(r=!0,i+=4);var a=this.data=new Uint8Array(i);a[0]=1,a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=255,a[5]=225;var o=e.byteLength;a[6]=o>>>8,a[7]=255&o;var s=8;a.set(e,8),a[s+=o]=1;var c=t.byteLength;a[s+1]=c>>>8,a[s+2]=255&c,a.set(t,s+3),s+=3+c,r&&(a[s]=252|n.chroma_format_idc,a[s+1]=248|n.bit_depth_luma-8,a[s+2]=248|n.bit_depth_chroma-8,a[s+3]=0,s+=4)}return e.prototype.getData=function(){return this.data},e}();!function(e){e[e.kNull=0]="kNull",e[e.kAACMain=1]="kAACMain",e[e.kAAC_LC=2]="kAAC_LC",e[e.kAAC_SSR=3]="kAAC_SSR",e[e.kAAC_LTP=4]="kAAC_LTP",e[e.kAAC_SBR=5]="kAAC_SBR",e[e.kAAC_Scalable=6]="kAAC_Scalable",e[e.kLayer1=32]="kLayer1",e[e.kLayer2=33]="kLayer2",e[e.kLayer3=34]="kLayer3"}(I||(I={})),function(e){e[e.k96000Hz=0]="k96000Hz",e[e.k88200Hz=1]="k88200Hz",e[e.k64000Hz=2]="k64000Hz",e[e.k48000Hz=3]="k48000Hz",e[e.k44100Hz=4]="k44100Hz",e[e.k32000Hz=5]="k32000Hz",e[e.k24000Hz=6]="k24000Hz",e[e.k22050Hz=7]="k22050Hz",e[e.k16000Hz=8]="k16000Hz",e[e.k12000Hz=9]="k12000Hz",e[e.k11025Hz=10]="k11025Hz",e[e.k8000Hz=11]="k8000Hz",e[e.k7350Hz=12]="k7350Hz"}(O||(O={}));var U,N,G=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],F=(U=function(e,t){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}U(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),j=function(){},V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return F(t,e),t}(j),z=function(){function e(e){this.TAG="AACADTSParser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,n=this.data_;;){if(t+7>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if(4095==(n[t+0]<<8|n[t+1])>>>4)return t;t++}},e.prototype.readNextAACFrame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var n=this.current_syncword_offset_,i=(8&e[n+1])>>>3,r=(6&e[n+1])>>>1,a=1&e[n+1],o=(192&e[n+2])>>>6,s=(60&e[n+2])>>>2,c=(1&e[n+2])<<2|(192&e[n+3])>>>6,u=(3&e[n+3])<<11|e[n+4]<<3|(224&e[n+5])>>>5;if(e[n+6],n+u>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var d=1===a?7:9,h=u-d;n+=d;var l=this.findNextSyncwordOffset(n+h);if(this.current_syncword_offset_=l,(0===i||1===i)&&0===r){var _=e.subarray(n,n+h);(t=new j).audio_object_type=o+1,t.sampling_freq_index=s,t.sampling_frequency=G[s],t.channel_config=c,t.data=_}}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),q=function(){function e(e){this.TAG="AACLOASParser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not found LOAS syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,n=this.data_;;){if(t+1>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if(695==(n[t+0]<<3|n[t+1]>>>5))return t;t++}},e.prototype.getLATMValue=function(e){for(var t=e.readBits(2),n=0,i=0;i<=t;i++)n<<=8,n|=e.readByte();return n},e.prototype.readNextAACFrame=function(e){for(var t=this.data_,n=null;null==n&&!this.eof_flag_;){var i=this.current_syncword_offset_,r=(31&t[i+1])<<8|t[i+2];if(i+3+r>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var o=new f(t.subarray(i+3,i+3+r)),s=null;if(o.readBool()){if(null==e){a.a.w(this.TAG,"StreamMuxConfig Missing"),this.current_syncword_offset_=this.findNextSyncwordOffset(i+3+r),o.destroy();continue}s=e}else{var c=o.readBool();if(c&&o.readBool()){a.a.e(this.TAG,"audioMuxVersionA is Not Supported"),o.destroy();break}if(c&&this.getLATMValue(o),!o.readBool()){a.a.e(this.TAG,"allStreamsSameTimeFraming zero is Not Supported"),o.destroy();break}if(0!==o.readBits(6)){a.a.e(this.TAG,"more than 2 numSubFrames Not Supported"),o.destroy();break}if(0!==o.readBits(4)){a.a.e(this.TAG,"more than 2 numProgram Not Supported"),o.destroy();break}if(0!==o.readBits(3)){a.a.e(this.TAG,"more than 2 numLayer Not Supported"),o.destroy();break}var u=c?this.getLATMValue(o):0,d=o.readBits(5);u-=5;var h=o.readBits(4);u-=4;var l=o.readBits(4);u-=4,o.readBits(3),(u-=3)>0&&o.readBits(u);var _=o.readBits(3);if(0!==_){a.a.e(this.TAG,"frameLengthType = "+_+". Only frameLengthType = 0 Supported"),o.destroy();break}o.readByte();var p=o.readBool();if(p)if(c)this.getLATMValue(o);else{for(var m=0;;){m<<=8;var g=o.readBool();if(m+=o.readByte(),!g)break}console.log(m)}o.readBool()&&o.readByte(),(s=new V).audio_object_type=d,s.sampling_freq_index=h,s.sampling_frequency=G[s.sampling_freq_index],s.channel_config=l,s.other_data_present=p}for(var v=0;;){var y=o.readByte();if(v+=y,255!==y)break}for(var b=new Uint8Array(v),S=0;S<v;S++)b[S]=o.readByte();(n=new V).audio_object_type=s.audio_object_type,n.sampling_freq_index=s.sampling_freq_index,n.sampling_frequency=G[s.sampling_freq_index],n.channel_config=s.channel_config,n.other_data_present=s.other_data_present,n.data=b,this.current_syncword_offset_=this.findNextSyncwordOffset(i+3+r)}return n},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),H=function(e){var t=null,n=e.audio_object_type,i=e.audio_object_type,r=e.sampling_freq_index,a=e.channel_config,o=0,s=navigator.userAgent.toLowerCase();-1!==s.indexOf("firefox")?r>=6?(i=5,t=new Array(4),o=r-3):(i=2,t=new Array(2),o=r):-1!==s.indexOf("android")?(i=2,t=new Array(2),o=r):(i=5,o=r,t=new Array(4),r>=6?o=r-3:1===a&&(i=2,t=new Array(2),o=r)),t[0]=i<<3,t[0]|=(15&r)>>>1,t[1]=(15&r)<<7,t[1]|=(15&a)<<3,5===i&&(t[1]|=(15&o)>>>1,t[2]=(1&o)<<7,t[2]|=8,t[3]=0),this.config=t,this.sampling_rate=G[r],this.channel_count=a,this.codec_mimetype="mp4a.40."+i,this.original_codec_mimetype="mp4a.40."+n},W=function(){},K=function(){};!function(e){e[e.kSpliceNull=0]="kSpliceNull",e[e.kSpliceSchedule=4]="kSpliceSchedule",e[e.kSpliceInsert=5]="kSpliceInsert",e[e.kTimeSignal=6]="kTimeSignal",e[e.kBandwidthReservation=7]="kBandwidthReservation",e[e.kPrivateCommand=255]="kPrivateCommand"}(N||(N={}));var Y,X=function(e){var t=e.readBool();return t?(e.readBits(6),{time_specified_flag:t,pts_time:4*e.readBits(31)+e.readBits(2)}):(e.readBits(7),{time_specified_flag:t})},Z=function(e){var t=e.readBool();return e.readBits(6),{auto_return:t,duration:4*e.readBits(31)+e.readBits(2)}},J=function(e,t){var n=t.readBits(8);return e?{component_tag:n}:{component_tag:n,splice_time:X(t)}},Q=function(e){return{component_tag:e.readBits(8),utc_splice_time:e.readBits(32)}},$=function(e){var t=e.readBits(32),n=e.readBool();e.readBits(7);var i={splice_event_id:t,splice_event_cancel_indicator:n};if(n)return i;if(i.out_of_network_indicator=e.readBool(),i.program_splice_flag=e.readBool(),i.duration_flag=e.readBool(),e.readBits(5),i.program_splice_flag)i.utc_splice_time=e.readBits(32);else{i.component_count=e.readBits(8),i.components=[];for(var r=0;r<i.component_count;r++)i.components.push(Q(e))}return i.duration_flag&&(i.break_duration=Z(e)),i.unique_program_id=e.readBits(16),i.avail_num=e.readBits(8),i.avails_expected=e.readBits(8),i},ee=function(e,t,n,i){return{descriptor_tag:e,descriptor_length:t,identifier:n,provider_avail_id:i.readBits(32)}},te=function(e,t,n,i){var r=i.readBits(8),a=i.readBits(3);i.readBits(5);for(var o="",s=0;s<a;s++)o+=String.fromCharCode(i.readBits(8));return{descriptor_tag:e,descriptor_length:t,identifier:n,preroll:r,dtmf_count:a,DTMF_char:o}},ne=function(e){var t=e.readBits(8);return e.readBits(7),{component_tag:t,pts_offset:4*e.readBits(31)+e.readBits(2)}},ie=function(e,t,n,i){var r=i.readBits(32),a=i.readBool();i.readBits(7);var o={descriptor_tag:e,descriptor_length:t,identifier:n,segmentation_event_id:r,segmentation_event_cancel_indicator:a};if(a)return o;if(o.program_segmentation_flag=i.readBool(),o.segmentation_duration_flag=i.readBool(),o.delivery_not_restricted_flag=i.readBool(),o.delivery_not_restricted_flag?i.readBits(5):(o.web_delivery_allowed_flag=i.readBool(),o.no_regional_blackout_flag=i.readBool(),o.archive_allowed_flag=i.readBool(),o.device_restrictions=i.readBits(2)),!o.program_segmentation_flag){o.component_count=i.readBits(8),o.components=[];for(var s=0;s<o.component_count;s++)o.components.push(ne(i))}o.segmentation_duration_flag&&(o.segmentation_duration=i.readBits(40)),o.segmentation_upid_type=i.readBits(8),o.segmentation_upid_length=i.readBits(8);var c=new Uint8Array(o.segmentation_upid_length);for(s=0;s<o.segmentation_upid_length;s++)c[s]=i.readBits(8);return o.segmentation_upid=c.buffer,o.segmentation_type_id=i.readBits(8),o.segment_num=i.readBits(8),o.segments_expected=i.readBits(8),52!==o.segmentation_type_id&&54!==o.segmentation_type_id&&56!==o.segmentation_type_id&&58!==o.segmentation_type_id||(o.sub_segment_num=i.readBits(8),o.sub_segments_expected=i.readBits(8)),o},re=function(e,t,n,i){return{descriptor_tag:e,descriptor_length:t,identifier:n,TAI_seconds:i.readBits(48),TAI_ns:i.readBits(32),UTC_offset:i.readBits(16)}},ae=function(e){return{component_tag:e.readBits(8),ISO_code:String.fromCharCode(e.readBits(8),e.readBits(8),e.readBits(8)),Bit_Stream_Mode:e.readBits(3),Num_Channels:e.readBits(4),Full_Srvc_Audio:e.readBool()}},oe=function(e,t,n,i){for(var r=i.readBits(4),a=[],o=0;o<r;o++)a.push(ae(i));return{descriptor_tag:e,descriptor_length:t,identifier:n,audio_count:r,components:a}},se=function(e){var t=new f(e),n=t.readBits(8),i=t.readBool(),r=t.readBool();t.readBits(2);var a=t.readBits(12),o=t.readBits(8),s=t.readBool(),c=t.readBits(6),u=4*t.readBits(31)+t.readBits(2),d=t.readBits(8),h=t.readBits(12),l=t.readBits(12),_=t.readBits(8),p=null;_===N.kSpliceNull?p={}:_===N.kSpliceSchedule?p=function(e){for(var t=e.readBits(8),n=[],i=0;i<t;i++)n.push($(e));return{splice_count:t,events:n}}(t):_===N.kSpliceInsert?p=function(e){var t=e.readBits(32),n=e.readBool();e.readBits(7);var i={splice_event_id:t,splice_event_cancel_indicator:n};if(n)return i;if(i.out_of_network_indicator=e.readBool(),i.program_splice_flag=e.readBool(),i.duration_flag=e.readBool(),i.splice_immediate_flag=e.readBool(),e.readBits(4),i.program_splice_flag&&!i.splice_immediate_flag&&(i.splice_time=X(e)),!i.program_splice_flag){i.component_count=e.readBits(8),i.components=[];for(var r=0;r<i.component_count;r++)i.components.push(J(i.splice_immediate_flag,e))}return i.duration_flag&&(i.break_duration=Z(e)),i.unique_program_id=e.readBits(16),i.avail_num=e.readBits(8),i.avails_expected=e.readBits(8),i}(t):_===N.kTimeSignal?p=function(e){return{splice_time:X(e)}}(t):_===N.kBandwidthReservation?p={}:_===N.kPrivateCommand?p=function(e,t){for(var n=String.fromCharCode(t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8)),i=new Uint8Array(e-4),r=0;r<e-4;r++)i[r]=t.readBits(8);return{identifier:n,private_data:i.buffer}}(l,t):t.readBits(8*l);for(var m=[],g=t.readBits(16),v=0;v<g;){var y=t.readBits(8),b=t.readBits(8),S=String.fromCharCode(t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8));0===y?m.push(ee(y,b,S,t)):1===y?m.push(te(y,b,S,t)):2===y?m.push(ie(y,b,S,t)):3===y?m.push(re(y,b,S,t)):4===y?m.push(oe(y,b,S,t)):t.readBits(8*(b-4)),v+=2+b}var A={table_id:n,section_syntax_indicator:i,private_indicator:r,section_length:a,protocol_version:o,encrypted_packet:s,encryption_algorithm:c,pts_adjustment:u,cw_index:d,tier:h,splice_command_length:l,splice_command_type:_,splice_command:p,descriptor_loop_length:g,splice_descriptors:m,E_CRC32:s?t.readBits(32):void 0,CRC32:t.readBits(32)};if(_===N.kSpliceInsert){var E=p;if(E.splice_event_cancel_indicator)return{splice_command_type:_,detail:A,data:e};if(E.program_splice_flag&&!E.splice_immediate_flag){var w=E.duration_flag?E.break_duration.auto_return:void 0,T=E.duration_flag?E.break_duration.duration/90:void 0;return E.splice_time.time_specified_flag?{splice_command_type:_,pts:(u+E.splice_time.pts_time)%Math.pow(2,33),auto_return:w,duraiton:T,detail:A,data:e}:{splice_command_type:_,auto_return:w,duraiton:T,detail:A,data:e}}return{splice_command_type:_,auto_return:w=E.duration_flag?E.break_duration.auto_return:void 0,duraiton:T=E.duration_flag?E.break_duration.duration/90:void 0,detail:A,data:e}}if(_===N.kTimeSignal){var R=p;return R.splice_time.time_specified_flag?{splice_command_type:_,pts:(u+R.splice_time.pts_time)%Math.pow(2,33),detail:A,data:e}:{splice_command_type:_,detail:A,data:e}}return{splice_command_type:_,detail:A,data:e}};!function(e){e[e.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",e[e.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",e[e.kSliceCRA_NUT=21]="kSliceCRA_NUT",e[e.kSliceVPS=32]="kSliceVPS",e[e.kSliceSPS=33]="kSliceSPS",e[e.kSlicePPS=34]="kSlicePPS",e[e.kSliceAUD=35]="kSliceAUD"}(Y||(Y={}));var ce=function(){},ue=function(e){var t=e.data.byteLength;this.type=e.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(e.data,4)},de=function(){function e(e){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return e.prototype.findNextStartCodeOffset=function(e){for(var t=e,n=this.data_;;){if(t+3>=n.byteLength)return this.eof_flag_=!0,n.byteLength;var i=n[t+0]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3],r=n[t+0]<<16|n[t+1]<<8|n[t+2];if(1===i||1===r)return t;t++}},e.prototype.readNextNaluPayload=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var n=this.current_startcode_offset_,i=e[n+=1==(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3])?4:3]>>1&63,r=(128&e[n])>>>7,a=this.findNextStartCodeOffset(n);if(this.current_startcode_offset_=a,0===r){var o=e.subarray(n,a);(t=new ce).type=i,t.data=o}}return t},e}(),he=function(){function e(e,t,n,i){var r=23+(5+e.byteLength)+(5+t.byteLength)+(5+n.byteLength),a=this.data=new Uint8Array(r);a[0]=1,a[1]=(3&i.general_profile_space)<<6|(i.general_tier_flag?1:0)<<5|31&i.general_profile_idc,a[2]=i.general_profile_compatibility_flags_1,a[3]=i.general_profile_compatibility_flags_2,a[4]=i.general_profile_compatibility_flags_3,a[5]=i.general_profile_compatibility_flags_4,a[6]=i.general_constraint_indicator_flags_1,a[7]=i.general_constraint_indicator_flags_2,a[8]=i.general_constraint_indicator_flags_3,a[9]=i.general_constraint_indicator_flags_4,a[10]=i.general_constraint_indicator_flags_5,a[11]=i.general_constraint_indicator_flags_6,a[12]=i.general_level_idc,a[13]=240|(3840&i.min_spatial_segmentation_idc)>>8,a[14]=255&i.min_spatial_segmentation_idc,a[15]=252|3&i.parallelismType,a[16]=252|3&i.chroma_format_idc,a[17]=248|7&i.bit_depth_luma_minus8,a[18]=248|7&i.bit_depth_chroma_minus8,a[19]=0,a[20]=0,a[21]=(3&i.constant_frame_rate)<<6|(7&i.num_temporal_layers)<<3|(i.temporal_id_nested?1:0)<<2|3,a[22]=3,a[23]=128|Y.kSliceVPS,a[24]=0,a[25]=1,a[26]=(65280&e.byteLength)>>8,a[27]=(255&e.byteLength)>>0,a.set(e,28),a[23+(5+e.byteLength)+0]=128|Y.kSliceSPS,a[23+(5+e.byteLength)+1]=0,a[23+(5+e.byteLength)+2]=1,a[23+(5+e.byteLength)+3]=(65280&t.byteLength)>>8,a[23+(5+e.byteLength)+4]=(255&t.byteLength)>>0,a.set(t,23+(5+e.byteLength)+5),a[23+(5+e.byteLength+5+t.byteLength)+0]=128|Y.kSlicePPS,a[23+(5+e.byteLength+5+t.byteLength)+1]=0,a[23+(5+e.byteLength+5+t.byteLength)+2]=1,a[23+(5+e.byteLength+5+t.byteLength)+3]=(65280&n.byteLength)>>8,a[23+(5+e.byteLength+5+t.byteLength)+4]=(255&n.byteLength)>>0,a.set(n,23+(5+e.byteLength+5+t.byteLength)+5)}return e.prototype.getData=function(){return this.data},e}(),le=function(){},_e=function(){},fe=function(){},pe=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]],me=function(){function e(e){this.TAG="AC3Parser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&a.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,n=this.data_;;){if(t+7>=n.byteLength)return this.eof_flag_=!0,n.byteLength;if(2935==(n[t+0]<<8|n[t+1]<<0))return t;t++}},e.prototype.readNextAC3Frame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var n=this.current_syncword_offset_,i=e[n+4]>>6,r=[48e3,44200,33e3][i],a=63&e[n+4],o=2*pe[i][a];if(n+o>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var s=this.findNextSyncwordOffset(n+o);this.current_syncword_offset_=s;var c=e[n+5]>>3,u=7&e[n+5],d=e[n+6]>>5,h=0;0!=(1&d)&&1!==d&&(h+=2),0!=(4&d)&&(h+=2),2===d&&(h+=2);var l=(e[n+6]<<8|e[n+7]<<0)>>12-h&1,_=[2,1,2,3,3,4,4,5][d]+l;(t=new fe).sampling_frequency=r,t.channel_count=_,t.channel_mode=d,t.bit_stream_identification=c,t.low_frequency_effects_channel_on=l,t.bit_stream_mode=u,t.frame_size_code=a,t.data=e.subarray(n,n+o)}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),ge=function(e){var t;t=[e.sampling_rate_code<<6|e.bit_stream_identification<<1|e.bit_stream_mode>>2,(3&e.bit_stream_mode)<<6|e.channel_mode<<3|e.low_frequency_effects_channel_on<<2|e.frame_size_code>>4,e.frame_size_code<<4&224],this.config=t,this.sampling_rate=e.sampling_frequency,this.bit_stream_identification=e.bit_stream_identification,this.bit_stream_mode=e.bit_stream_mode,this.low_frequency_effects_channel_on=e.low_frequency_effects_channel_on,this.channel_count=e.channel_count,this.channel_mode=e.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"},ve=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ye=function(){return(ye=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},be=function(e){function t(t,n){var i=e.call(this)||this;return i.TAG="TSDemuxer",i.first_parse_=!0,i.media_info_=new s.a,i.timescale_=90,i.duration_=0,i.current_pmt_pid_=-1,i.program_pmt_map_={},i.pes_slice_queues_={},i.section_slice_queues_={},i.video_metadata_={vps:void 0,sps:void 0,pps:void 0,details:void 0},i.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},i.aac_last_sample_pts_=void 0,i.aac_last_incomplete_data_=null,i.has_video_=!1,i.has_audio_=!1,i.video_init_segment_dispatched_=!1,i.audio_init_segment_dispatched_=!1,i.video_metadata_changed_=!1,i.audio_metadata_changed_=!1,i.loas_previous_frame=null,i.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},i.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},i.ts_packet_size_=t.ts_packet_size,i.sync_offset_=t.sync_offset,i.config_=n,i}return ve(t,e),t.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,e.prototype.destroy.call(this)},t.probe=function(e){var t=new Uint8Array(e),n=-1,i=188;if(t.byteLength<=3*i)return{needMoreData:!0};for(;-1===n;){for(var r=Math.min(1e3,t.byteLength-3*i),o=0;o<r;){if(71===t[o]&&71===t[o+i]&&71===t[o+2*i]){n=o;break}o++}if(-1===n)if(188===i)i=192;else{if(192!==i)break;i=204}}return-1===n?{match:!1}:(192===i&&n>=4?(a.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),n-=4):204===i&&a.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:i,sync_offset:n})},t.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},t.prototype.resetMediaInfo=function(){this.media_info_=new s.a},t.prototype.parseChunks=function(e,t){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new h.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var n=0;for(this.first_parse_&&(this.first_parse_=!1,n=this.sync_offset_);n+this.ts_packet_size_<=e.byteLength;){var i=t+n;192===this.ts_packet_size_&&(n+=4);var r=new Uint8Array(e,n,188),o=r[0];if(71!==o){a.a.e(this.TAG,"sync_byte = "+o+", not 0x47");break}var s=(64&r[1])>>>6,c=(r[1],(31&r[1])<<8|r[2]),u=(48&r[3])>>>4,d=15&r[3],l={},_=4;if(2==u||3==u){var f=r[4];if(5+f===188){n+=188,204===this.ts_packet_size_&&(n+=16);continue}f>0&&(l=this.parseAdaptationField(e,n+4,1+f)),_=5+f}if(1==u||3==u)if(0===c||c===this.current_pmt_pid_||null!=this.pmt_&&this.pmt_.pid_stream_type[c]===S.kSCTE35){var p=188-_;this.handleSectionSlice(e,n+_,p,{pid:c,file_position:i,payload_unit_start_indicator:s,continuity_conunter:d,random_access_indicator:l.random_access_indicator})}else if(null!=this.pmt_&&null!=this.pmt_.pid_stream_type[c]){p=188-_;var m=this.pmt_.pid_stream_type[c];c!==this.pmt_.common_pids.h264&&c!==this.pmt_.common_pids.h265&&c!==this.pmt_.common_pids.adts_aac&&c!==this.pmt_.common_pids.loas_aac&&c!==this.pmt_.common_pids.ac3&&c!==this.pmt_.common_pids.opus&&c!==this.pmt_.common_pids.mp3&&!0!==this.pmt_.pes_private_data_pids[c]&&!0!==this.pmt_.timed_id3_pids[c]||this.handlePESSlice(e,n+_,p,{pid:c,stream_type:m,file_position:i,payload_unit_start_indicator:s,continuity_conunter:d,random_access_indicator:l.random_access_indicator})}n+=188,204===this.ts_packet_size_&&(n+=16)}return this.dispatchAudioVideoMediaSegment(),n},t.prototype.parseAdaptationField=function(e,t,n){var i=new Uint8Array(e,t,n),r=i[0];return r>0?r>183?(a.a.w(this.TAG,"Illegal adaptation_field_length: "+r),{}):{discontinuity_indicator:(128&i[1])>>>7,random_access_indicator:(64&i[1])>>>6,elementary_stream_priority_indicator:(32&i[1])>>>5}:{}},t.prototype.handleSectionSlice=function(e,t,n,i){var r=new Uint8Array(e,t,n),a=this.section_slice_queues_[i.pid];if(i.payload_unit_start_indicator){var o=r[0];if(null!=a&&0!==a.total_length){var s=new Uint8Array(e,t+1,Math.min(n,o));a.slices.push(s),a.total_length+=s.byteLength,a.total_length===a.expected_length?this.emitSectionSlices(a,i):this.clearSlices(a,i)}for(var c=1+o;c<r.byteLength&&255!==r[c+0];){var u=(15&r[c+1])<<8|r[c+2];this.section_slice_queues_[i.pid]=new C,(a=this.section_slice_queues_[i.pid]).expected_length=u+3,a.file_position=i.file_position,a.random_access_indicator=i.random_access_indicator,s=new Uint8Array(e,t+c,Math.min(n-c,a.expected_length-a.total_length)),a.slices.push(s),a.total_length+=s.byteLength,a.total_length===a.expected_length?this.emitSectionSlices(a,i):a.total_length>=a.expected_length&&this.clearSlices(a,i),c+=s.byteLength}}else null!=a&&0!==a.total_length&&(s=new Uint8Array(e,t,Math.min(n,a.expected_length-a.total_length)),a.slices.push(s),a.total_length+=s.byteLength,a.total_length===a.expected_length?this.emitSectionSlices(a,i):a.total_length>=a.expected_length&&this.clearSlices(a,i))},t.prototype.handlePESSlice=function(e,t,n,i){var r=new Uint8Array(e,t,n),o=r[0]<<16|r[1]<<8|r[2],s=(r[3],r[4]<<8|r[5]);if(i.payload_unit_start_indicator){if(1!==o)return void a.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value "+o);var c=this.pes_slice_queues_[i.pid];c&&(0===c.expected_length||c.expected_length===c.total_length?this.emitPESSlices(c,i):this.clearSlices(c,i)),this.pes_slice_queues_[i.pid]=new C,this.pes_slice_queues_[i.pid].file_position=i.file_position,this.pes_slice_queues_[i.pid].random_access_indicator=i.random_access_indicator}if(null!=this.pes_slice_queues_[i.pid]){var u=this.pes_slice_queues_[i.pid];u.slices.push(r),i.payload_unit_start_indicator&&(u.expected_length=0===s?0:s+6),u.total_length+=r.byteLength,u.expected_length>0&&u.expected_length===u.total_length?this.emitPESSlices(u,i):u.expected_length>0&&u.expected_length<u.total_length&&this.clearSlices(u,i)}},t.prototype.emitSectionSlices=function(e,t){for(var n=new Uint8Array(e.total_length),i=0,r=0;i<e.slices.length;i++){var a=e.slices[i];n.set(a,r),r+=a.byteLength}e.slices=[],e.expected_length=-1,e.total_length=0;var o=new L;o.pid=t.pid,o.data=n,o.file_position=e.file_position,o.random_access_indicator=e.random_access_indicator,this.parseSection(o)},t.prototype.emitPESSlices=function(e,t){for(var n=new Uint8Array(e.total_length),i=0,r=0;i<e.slices.length;i++){var a=e.slices[i];n.set(a,r),r+=a.byteLength}e.slices=[],e.expected_length=-1,e.total_length=0;var o=new D;o.pid=t.pid,o.data=n,o.stream_type=t.stream_type,o.file_position=e.file_position,o.random_access_indicator=e.random_access_indicator,this.parsePES(o)},t.prototype.clearSlices=function(e,t){e.slices=[],e.expected_length=-1,e.total_length=0},t.prototype.parseSection=function(e){var t=e.data,n=e.pid;0===n?this.parsePAT(t):n===this.current_pmt_pid_?this.parsePMT(t):null!=this.pmt_&&this.pmt_.scte_35_pids[n]&&this.parseSCTE35(t)},t.prototype.parsePES=function(e){var t=e.data,n=t[0]<<16|t[1]<<8|t[2],i=t[3],r=t[4]<<8|t[5];if(1===n)if(188!==i&&190!==i&&191!==i&&240!==i&&241!==i&&255!==i&&242!==i&&248!==i){t[6];var o=(192&t[7])>>>6,s=t[8],c=void 0,u=void 0;2!==o&&3!==o||(c=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,u=3===o?536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2:c);var d=9+s,h=void 0;if(0!==r){if(r<3+s)return void a.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");h=r-3-s}else h=t.byteLength-d;var l=t.subarray(d,d+h);switch(e.stream_type){case S.kMPEG1Audio:case S.kMPEG2Audio:this.parseMP3Payload(l,c);break;case S.kPESPrivateData:this.pmt_.common_pids.opus===e.pid?this.parseOpusPayload(l,c):this.pmt_.common_pids.ac3===e.pid?this.parseAC3Payload(l,c):this.pmt_.smpte2038_pids[e.pid]?this.parseSMPTE2038MetadataPayload(l,c,u,e.pid,i):this.parsePESPrivateDataPayload(l,c,u,e.pid,i);break;case S.kADTSAAC:this.parseADTSAACPayload(l,c);break;case S.kLOASAAC:this.parseLOASAACPayload(l,c);break;case S.kAC3:this.parseAC3Payload(l,c);break;case S.kID3:this.parseTimedID3MetadataPayload(l,c,u,e.pid,i);break;case S.kH264:this.parseH264Payload(l,c,u,e.file_position,e.random_access_indicator);break;case S.kH265:this.parseH265Payload(l,c,u,e.file_position,e.random_access_indicator)}}else 188!==i&&191!==i&&240!==i&&241!==i&&255!==i&&242!==i&&248!==i||e.stream_type!==S.kPESPrivateData||(d=6,h=void 0,h=0!==r?r:t.byteLength-d,l=t.subarray(d,d+h),this.parsePESPrivateDataPayload(l,void 0,void 0,e.pid,i));else a.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value "+n)},t.prototype.parsePAT=function(e){var t=e[0];if(0===t){var n=(15&e[1])<<8|e[2],i=(e[3],e[4],(62&e[5])>>>1),r=1&e[5],o=e[6],s=(e[7],null);if(1===r&&0===o)(s=new T).version_number=i;else if(null==(s=this.pat_))return;for(var c=n-5-4,u=-1,d=-1,h=8;h<8+c;h+=4){var l=e[h]<<8|e[h+1],_=(31&e[h+2])<<8|e[h+3];0===l?s.network_pid=_:(s.program_pmt_pid[l]=_,-1===u&&(u=l),-1===d&&(d=_))}1===r&&0===o&&(null==this.pat_&&a.a.v(this.TAG,"Parsed first PAT: "+JSON.stringify(s)),this.pat_=s,this.current_program_=u,this.current_pmt_pid_=d)}else a.a.e(this.TAG,"parsePAT: table_id "+t+" is not corresponded to PAT!")},t.prototype.parsePMT=function(e){var t=e[0];if(2===t){var n=(15&e[1])<<8|e[2],i=e[3]<<8|e[4],r=(62&e[5])>>>1,o=1&e[5],s=e[6],c=(e[7],null);if(1===o&&0===s)(c=new k).program_number=i,c.version_number=r,this.program_pmt_map_[i]=c;else if(null==(c=this.program_pmt_map_[i]))return;e[8],e[9];for(var u=(15&e[10])<<8|e[11],d=12+u,h=n-9-u-4,l=d;l<d+h;){var _=e[l],f=(31&e[l+1])<<8|e[l+2],p=(15&e[l+3])<<8|e[l+4];c.pid_stream_type[f]=_;var m=c.common_pids.h264||c.common_pids.h265,g=c.common_pids.adts_aac||c.common_pids.loas_aac||c.common_pids.ac3||c.common_pids.opus||c.common_pids.mp3;if(_!==S.kH264||m)if(_!==S.kH265||m)if(_!==S.kADTSAAC||g)if(_!==S.kLOASAAC||g)if(_!==S.kAC3||g)if(_!==S.kMPEG1Audio&&_!==S.kMPEG2Audio||g)if(_===S.kPESPrivateData){if(c.pes_private_data_pids[f]=!0,p>0){for(var v=l+5;v<l+5+p;){var y=e[v+0],b=e[v+1];if(5===y){var A=String.fromCharCode.apply(String,Array.from(e.subarray(v+2,v+2+b)));"VANC"===A?c.smpte2038_pids[f]=!0:"Opus"===A&&(c.common_pids.opus=f)}else if(127===y&&f===c.common_pids.opus){var E=null;if(128===e[v+2]&&(E=e[v+3]),null==E){a.a.e(this.TAG,"Not Supported Opus channel count.");continue}var w={codec:"opus",channel_count:0==(15&E)?2:15&E,channel_config_code:E,sample_rate:48e3},T={codec:"opus",meta:w};0==this.audio_init_segment_dispatched_?(this.audio_metadata_=w,this.dispatchAudioInitSegment(T)):this.detectAudioMetadataChange(T)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(T))}v+=2+b}var R=e.subarray(l+5,l+5+p);this.dispatchPESPrivateDataDescriptor(f,_,R)}}else _===S.kID3?c.timed_id3_pids[f]=!0:_===S.kSCTE35&&(c.scte_35_pids[f]=!0);else c.common_pids.mp3=f;else c.common_pids.ac3=f;else c.common_pids.loas_aac=f;else c.common_pids.adts_aac=f;else c.common_pids.h265=f;else c.common_pids.h264=f;l+=5+p}i===this.current_program_&&(null==this.pmt_&&a.a.v(this.TAG,"Parsed first PMT: "+JSON.stringify(c)),this.pmt_=c,(c.common_pids.h264||c.common_pids.h265)&&(this.has_video_=!0),(c.common_pids.adts_aac||c.common_pids.loas_aac||c.common_pids.ac3||c.common_pids.opus||c.common_pids.mp3)&&(this.has_audio_=!0))}else a.a.e(this.TAG,"parsePMT: table_id "+t+" is not corresponded to PMT!")},t.prototype.parseSCTE35=function(e){var t=se(e);if(null!=t.pts){var n=Math.floor(t.pts/this.timescale_);t.pts=n}else t.nearest_pts=this.aac_last_sample_pts_;this.onSCTE35Metadata&&this.onSCTE35Metadata(t)},t.prototype.parseH264Payload=function(e,t,n,i,r){for(var o=new M(e),s=null,c=[],u=0,d=!1;null!=(s=o.readNextNaluPayload());){var h=new B(s);if(h.type===R.kSliceSPS){var l=p.parseSPS(s.data);this.video_init_segment_dispatched_?!0===this.detectVideoMetadataChange(h,l)&&(a.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:h,pps:void 0,details:l}):(this.video_metadata_.sps=h,this.video_metadata_.details=l)}else h.type===R.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=h,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):(h.type===R.kSliceIDR||h.type===R.kSliceNonIDR&&1===r)&&(d=!0);this.video_init_segment_dispatched_&&(c.push(h),u+=h.data.byteLength)}var _=Math.floor(t/this.timescale_),f=Math.floor(n/this.timescale_);if(c.length){var m=this.video_track_,g={units:c,length:u,isKeyframe:d,dts:f,pts:_,cts:_-f,file_position:i};m.samples.push(g),m.length+=u}},t.prototype.parseH265Payload=function(e,t,n,i,r){for(var o=new de(e),s=null,c=[],u=0,d=!1;null!=(s=o.readNextNaluPayload());){var h=new ue(s);if(h.type===Y.kSliceVPS){if(!this.video_init_segment_dispatched_){var l=g.parseVPS(s.data);this.video_metadata_.vps=h,this.video_metadata_.details=ye(ye({},this.video_metadata_.details),l)}}else h.type===Y.kSliceSPS?(l=g.parseSPS(s.data),this.video_init_segment_dispatched_?!0===this.detectVideoMetadataChange(h,l)&&(a.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:h,pps:void 0,details:l}):(this.video_metadata_.sps=h,this.video_metadata_.details=ye(ye({},this.video_metadata_.details),l))):h.type===Y.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(l=g.parsePPS(s.data),this.video_metadata_.pps=h,this.video_metadata_.details=ye(ye({},this.video_metadata_.details),l),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):h.type!==Y.kSliceIDR_W_RADL&&h.type!==Y.kSliceIDR_N_LP&&h.type!==Y.kSliceCRA_NUT||(d=!0);this.video_init_segment_dispatched_&&(c.push(h),u+=h.data.byteLength)}var _=Math.floor(t/this.timescale_),f=Math.floor(n/this.timescale_);if(c.length){var p=this.video_track_,m={units:c,length:u,isKeyframe:d,dts:f,pts:_,cts:_-f,file_position:i};p.samples.push(m),p.length+=u}},t.prototype.detectVideoMetadataChange=function(e,t){if(t.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return a.a.v(this.TAG,"Video: Codec mimeType changed from "+this.video_metadata_.details.codec_mimetype+" to "+t.codec_mimetype),!0;if(t.codec_size.width!==this.video_metadata_.details.codec_size.width||t.codec_size.height!==this.video_metadata_.details.codec_size.height){var n=this.video_metadata_.details.codec_size,i=t.codec_size;return a.a.v(this.TAG,"Video: Coded Resolution changed from "+n.width+"x"+n.height+" to "+i.width+"x"+i.height),!0}return t.present_size.width!==this.video_metadata_.details.present_size.width&&(a.a.v(this.TAG,"Video: Present resolution width changed from "+this.video_metadata_.details.present_size.width+" to "+t.present_size.width),!0)},t.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},t.prototype.dispatchVideoInitSegment=function(){var e=this.video_metadata_.details,t={type:"video"};t.id=this.video_track_.id,t.timescale=1e3,t.duration=this.duration_,t.codecWidth=e.codec_size.width,t.codecHeight=e.codec_size.height,t.presentWidth=e.present_size.width,t.presentHeight=e.present_size.height,t.profile=e.profile_string,t.level=e.level_string,t.bitDepth=e.bit_depth,t.chromaFormat=e.chroma_format,t.sarRatio=e.sar_ratio,t.frameRate=e.frame_rate;var n=t.frameRate.fps_den,i=t.frameRate.fps_num;if(t.refSampleDuration=n/i*1e3,t.codec=e.codec_mimetype,this.video_metadata_.vps){var r=this.video_metadata_.vps.data.subarray(4),o=this.video_metadata_.sps.data.subarray(4),s=this.video_metadata_.pps.data.subarray(4),c=new he(r,o,s,e);t.hvcc=c.getData(),0==this.video_init_segment_dispatched_&&a.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: "+t.codec)}else{o=this.video_metadata_.sps.data.subarray(4),s=this.video_metadata_.pps.data.subarray(4);var u=new x(o,s,e);t.avcc=u.getData(),0==this.video_init_segment_dispatched_&&a.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: "+t.codec)}this.onTrackMetadata("video",t),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var d=this.media_info_;d.hasVideo=!0,d.width=t.codecWidth,d.height=t.codecHeight,d.fps=t.frameRate.fps,d.profile=t.profile,d.level=t.level,d.refFrames=e.ref_frames,d.chromaFormat=e.chroma_format_string,d.sarNum=t.sarRatio.width,d.sarDen=t.sarRatio.height,d.videoCodec=t.codec,d.hasAudio&&d.audioCodec?d.mimeType='video/mp2t; codecs="'+d.videoCodec+","+d.audioCodec+'"':d.mimeType='video/mp2t; codecs="'+d.videoCodec+'"',d.isComplete()&&this.onMediaInfo(d)},t.prototype.dispatchVideoMediaSegment=function(){this.isInitSegmentDispatched()&&this.video_track_.length&&this.onDataAvailable(null,this.video_track_)},t.prototype.dispatchAudioMediaSegment=function(){this.isInitSegmentDispatched()&&this.audio_track_.length&&this.onDataAvailable(this.audio_track_,null)},t.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},t.prototype.parseADTSAACPayload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var n=new Uint8Array(e.byteLength+this.aac_last_incomplete_data_.byteLength);n.set(this.aac_last_incomplete_data_,0),n.set(e,this.aac_last_incomplete_data_.byteLength),e=n}var i,r;if(null!=t&&(r=t/this.timescale_),"aac"===this.audio_metadata_.codec){if(null==t&&null!=this.aac_last_sample_pts_)i=1024/this.audio_metadata_.sampling_frequency*1e3,r=this.aac_last_sample_pts_+i;else if(null==t)return void a.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.aac_last_sample_pts_){i=1024/this.audio_metadata_.sampling_frequency*1e3;var o=this.aac_last_sample_pts_+i;Math.abs(o-r)>1&&(a.a.w(this.TAG,"AAC: Detected pts overlapped, expected: "+o+"ms, PES pts: "+r+"ms"),r=o)}}for(var s,c=new z(e),u=null,d=r;null!=(u=c.readNextAACFrame());){i=1024/u.sampling_frequency*1e3;var h={codec:"aac",data:u};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"aac",audio_object_type:u.audio_object_type,sampling_freq_index:u.sampling_freq_index,sampling_frequency:u.sampling_frequency,channel_config:u.channel_config},this.dispatchAudioInitSegment(h)):this.detectAudioMetadataChange(h)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(h)),s=d;var l=Math.floor(d),_={unit:u.data,length:u.data.byteLength,pts:l,dts:l};this.audio_track_.samples.push(_),this.audio_track_.length+=u.data.byteLength,d+=i}c.hasIncompleteData()&&(this.aac_last_incomplete_data_=c.getIncompleteData()),s&&(this.aac_last_sample_pts_=s)}},t.prototype.parseLOASAACPayload=function(e,t){var n;if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var i=new Uint8Array(e.byteLength+this.aac_last_incomplete_data_.byteLength);i.set(this.aac_last_incomplete_data_,0),i.set(e,this.aac_last_incomplete_data_.byteLength),e=i}var r,o;if(null!=t&&(o=t/this.timescale_),"aac"===this.audio_metadata_.codec){if(null==t&&null!=this.aac_last_sample_pts_)r=1024/this.audio_metadata_.sampling_frequency*1e3,o=this.aac_last_sample_pts_+r;else if(null==t)return void a.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.aac_last_sample_pts_){r=1024/this.audio_metadata_.sampling_frequency*1e3;var s=this.aac_last_sample_pts_+r;Math.abs(s-o)>1&&(a.a.w(this.TAG,"AAC: Detected pts overlapped, expected: "+s+"ms, PES pts: "+o+"ms"),o=s)}}for(var c,u=new q(e),d=null,h=o;null!=(d=u.readNextAACFrame(null!==(n=this.loas_previous_frame)&&void 0!==n?n:void 0));){this.loas_previous_frame=d,r=1024/d.sampling_frequency*1e3;var l={codec:"aac",data:d};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"aac",audio_object_type:d.audio_object_type,sampling_freq_index:d.sampling_freq_index,sampling_frequency:d.sampling_frequency,channel_config:d.channel_config},this.dispatchAudioInitSegment(l)):this.detectAudioMetadataChange(l)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(l)),c=h;var _=Math.floor(h),f={unit:d.data,length:d.data.byteLength,pts:_,dts:_};this.audio_track_.samples.push(f),this.audio_track_.length+=d.data.byteLength,h+=r}u.hasIncompleteData()&&(this.aac_last_incomplete_data_=u.getIncompleteData()),c&&(this.aac_last_sample_pts_=c)}},t.prototype.parseAC3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var n,i;if(null!=t&&(i=t/this.timescale_),"ac-3"===this.audio_metadata_.codec)if(null==t&&null!=this.aac_last_sample_pts_)n=1536/this.audio_metadata_.sampling_frequency*1e3,i=this.aac_last_sample_pts_+n;else if(null==t)return void a.a.w(this.TAG,"Opus: Unknown pts");for(var r,o=new me(e),s=null,c=i;null!=(s=o.readNextAC3Frame());){n=1536/s.sampling_frequency*1e3;var u={codec:"ac-3",data:s};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"ac-3",sampling_frequency:s.sampling_frequency,bit_stream_identification:s.bit_stream_identification,bit_stream_mode:s.bit_stream_mode,low_frequency_effects_channel_on:s.low_frequency_effects_channel_on,channel_mode:s.channel_mode},console.log(JSON.stringify(this.audio_metadata_)),this.dispatchAudioInitSegment(u)):this.detectAudioMetadataChange(u)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(u)),r=c;var d=Math.floor(c),h={unit:s.data,length:s.data.byteLength,pts:d,dts:d};this.audio_track_.samples.push(h),this.audio_track_.length+=s.data.byteLength,c+=n}r&&(this.aac_last_sample_pts_=r)}},t.prototype.parseOpusPayload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var n,i;if(null!=t&&(i=t/this.timescale_),"opus"===this.audio_metadata_.codec)if(null==t&&null!=this.aac_last_sample_pts_)n=20,i=this.aac_last_sample_pts_+n;else if(null==t)return void a.a.w(this.TAG,"Opus: Unknown pts");for(var r,o=i,s=0;s<e.length;){n=20;for(var c=0!=(16&e[s+1]),u=0!=(8&e[s+1]),d=s+2,h=0;255===e[d];)h+=255,d+=1;h+=e[d],d+=1,d+=c?2:0,d+=u?2:0,r=o;var l=Math.floor(o),_=e.slice(d,d+h),f={unit:_,length:_.byteLength,pts:l,dts:l};this.audio_track_.samples.push(f),this.audio_track_.length+=_.byteLength,o+=n,s=d+h}r&&(this.aac_last_sample_pts_=r)}},t.prototype.parseMP3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var n=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],i=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],r=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],a=e[1]>>>3&3,o=(6&e[1])>>1,s=(240&e[2])>>>4,c=(12&e[2])>>>2,u=3!=(e[3]>>>6&3)?2:1,d=0,h=34;switch(a){case 0:d=[11025,12e3,8e3,0][c];break;case 2:d=[22050,24e3,16e3,0][c];break;case 3:d=[44100,48e3,32e3,0][c]}switch(o){case 1:h=34,s<r.length&&r[s];break;case 2:h=33,s<i.length&&i[s];break;case 3:h=32,s<n.length&&n[s]}var l=new _e;l.object_type=h,l.sample_rate=d,l.channel_count=u,l.data=e;var _={codec:"mp3",data:l};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"mp3",object_type:h,sample_rate:d,channel_count:u},this.dispatchAudioInitSegment(_)):this.detectAudioMetadataChange(_)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(_));var f={unit:e,length:e.byteLength,pts:t/this.timescale_,dts:t/this.timescale_};this.audio_track_.samples.push(f),this.audio_track_.length+=e.byteLength}},t.prototype.detectAudioMetadataChange=function(e){if(e.codec!==this.audio_metadata_.codec)return a.a.v(this.TAG,"Audio: Audio Codecs changed from "+this.audio_metadata_.codec+" to "+e.codec),!0;if("aac"===e.codec&&"aac"===this.audio_metadata_.codec){if((t=e.data).audio_object_type!==this.audio_metadata_.audio_object_type)return a.a.v(this.TAG,"AAC: AudioObjectType changed from "+this.audio_metadata_.audio_object_type+" to "+t.audio_object_type),!0;if(t.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return a.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+this.audio_metadata_.sampling_freq_index+" to "+t.sampling_freq_index),!0;if(t.channel_config!==this.audio_metadata_.channel_config)return a.a.v(this.TAG,"AAC: Channel configuration changed from "+this.audio_metadata_.channel_config+" to "+t.channel_config),!0}else if("ac-3"===e.codec&&"ac-3"===this.audio_metadata_.codec){var t;if((t=e.data).sampling_frequency!==this.audio_metadata_.sampling_frequency)return a.a.v(this.TAG,"AC3: Sampling Frequency changed from "+this.audio_metadata_.sampling_frequency+" to "+t.sampling_frequency),!0;if(t.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return a.a.v(this.TAG,"AC3: Bit Stream Identification changed from "+this.audio_metadata_.bit_stream_identification+" to "+t.bit_stream_identification),!0;if(t.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return a.a.v(this.TAG,"AC3: BitStream Mode changed from "+this.audio_metadata_.bit_stream_mode+" to "+t.bit_stream_mode),!0;if(t.channel_mode!==this.audio_metadata_.channel_mode)return a.a.v(this.TAG,"AC3: Channel Mode changed from "+this.audio_metadata_.channel_mode+" to "+t.channel_mode),!0;if(t.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return a.a.v(this.TAG,"AC3: Low Frequency Effects Channel On changed from "+this.audio_metadata_.low_frequency_effects_channel_on+" to "+t.low_frequency_effects_channel_on),!0}else if("opus"===e.codec&&"opus"===this.audio_metadata_.codec){if((n=e.meta).sample_rate!==this.audio_metadata_.sample_rate)return a.a.v(this.TAG,"Opus: SamplingFrequencyIndex changed from "+this.audio_metadata_.sample_rate+" to "+n.sample_rate),!0;if(n.channel_count!==this.audio_metadata_.channel_count)return a.a.v(this.TAG,"Opus: Channel count changed from "+this.audio_metadata_.channel_count+" to "+n.channel_count),!0}else if("mp3"===e.codec&&"mp3"===this.audio_metadata_.codec){var n;if((n=e.data).object_type!==this.audio_metadata_.object_type)return a.a.v(this.TAG,"MP3: AudioObjectType changed from "+this.audio_metadata_.object_type+" to "+n.object_type),!0;if(n.sample_rate!==this.audio_metadata_.sample_rate)return a.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+this.audio_metadata_.sample_rate+" to "+n.sample_rate),!0;if(n.channel_count!==this.audio_metadata_.channel_count)return a.a.v(this.TAG,"MP3: Channel count changed from "+this.audio_metadata_.channel_count+" to "+n.channel_count),!0}return!1},t.prototype.dispatchAudioInitSegment=function(e){var t={type:"audio"};if(t.id=this.audio_track_.id,t.timescale=1e3,t.duration=this.duration_,"aac"===this.audio_metadata_.codec){var n="aac"===e.codec?e.data:null,i=new H(n);t.audioSampleRate=i.sampling_rate,t.channelCount=i.channel_count,t.codec=i.codec_mimetype,t.originalCodec=i.original_codec_mimetype,t.config=i.config,t.refSampleDuration=1024/t.audioSampleRate*t.timescale}else if("ac-3"===this.audio_metadata_.codec){var r="ac-3"===e.codec?e.data:null,o=new ge(r);t.audioSampleRate=o.sampling_rate,t.channelCount=o.channel_count,t.codec=o.codec_mimetype,t.originalCodec=o.original_codec_mimetype,t.config=o.config,t.refSampleDuration=1536/t.audioSampleRate*t.timescale}else"opus"===this.audio_metadata_.codec?(t.audioSampleRate=this.audio_metadata_.sample_rate,t.channelCount=this.audio_metadata_.channel_count,t.channelConfigCode=this.audio_metadata_.channel_config_code,t.codec="opus",t.originalCodec="opus",t.config=void 0,t.refSampleDuration=20):"mp3"===this.audio_metadata_.codec&&(t.audioSampleRate=this.audio_metadata_.sample_rate,t.channelCount=this.audio_metadata_.channel_count,t.codec="mp3",t.originalCodec="mp3",t.config=void 0);0==this.audio_init_segment_dispatched_&&a.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: "+t.codec),this.onTrackMetadata("audio",t),this.audio_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var s=this.media_info_;s.hasAudio=!0,s.audioCodec=t.originalCodec,s.audioSampleRate=t.audioSampleRate,s.audioChannelCount=t.channelCount,s.hasVideo&&s.videoCodec?s.mimeType='video/mp2t; codecs="'+s.videoCodec+","+s.audioCodec+'"':s.mimeType='video/mp2t; codecs="'+s.audioCodec+'"',s.isComplete()&&this.onMediaInfo(s)},t.prototype.dispatchPESPrivateDataDescriptor=function(e,t,n){var i=new K;i.pid=e,i.stream_type=t,i.descriptor=n,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(i)},t.prototype.parsePESPrivateDataPayload=function(e,t,n,i,r){var a=new W;if(a.pid=i,a.stream_id=r,a.len=e.byteLength,a.data=e,null!=t){var o=Math.floor(t/this.timescale_);a.pts=o}else a.nearest_pts=this.aac_last_sample_pts_;if(null!=n){var s=Math.floor(n/this.timescale_);a.dts=s}this.onPESPrivateData&&this.onPESPrivateData(a)},t.prototype.parseTimedID3MetadataPayload=function(e,t,n,i,r){var a=new W;if(a.pid=i,a.stream_id=r,a.len=e.byteLength,a.data=e,null!=t){var o=Math.floor(t/this.timescale_);a.pts=o}if(null!=n){var s=Math.floor(n/this.timescale_);a.dts=s}this.onTimedID3Metadata&&this.onTimedID3Metadata(a)},t.prototype.parseSMPTE2038MetadataPayload=function(e,t,n,i,r){var a=new le;if(a.pid=i,a.stream_id=r,a.len=e.byteLength,a.data=e,null!=t){var o=Math.floor(t/this.timescale_);a.pts=o}if(a.nearest_pts=this.aac_last_sample_pts_,null!=n){var s=Math.floor(n/this.timescale_);a.dts=s}a.ancillaries=function(e){for(var t=new f(e),n=0,i=[];n+=6,0===t.readBits(6);){var r=t.readBool();n+=1;var a=t.readBits(11);n+=11;var o=t.readBits(12);n+=12;var s=255&t.readBits(10);n+=10;var c=255&t.readBits(10);n+=10;var u=255&t.readBits(10);n+=10;for(var d=new Uint8Array(u),h=0;h<u;h++){var l=255&t.readBits(10);n+=10,d[h]=l}t.readBits(10),n+=10;var _="User Defined";65===s?7===c&&(_="SCTE-104"):95===s?220===c?_="ARIB STD-B37 (1SEG)":221===c?_="ARIB STD-B37 (ANALOG)":222===c?_="ARIB STD-B37 (SD)":223===c&&(_="ARIB STD-B37 (HD)"):97===s&&(1===c?_="EIA-708":2===c&&(_="EIA-608")),i.push({yc_indicator:r,line_number:a,horizontal_offset:o,did:s,sdid:c,user_data:d,description:_,information:{}}),t.readBits(8-(n-Math.floor(n/8))%8),n+=(8-(n-Math.floor(n/8)))%8}return t.destroy(),t=null,i}(e),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(a)},t}(w),Se=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,r++)i[r]=a[o];return i},Ae=function(){function e(){}return e.init=function(){for(var t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],Opus:[],dOps:[],"ac-3":[],dac3:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var n=e.constants={};n.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),n.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),n.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSC=n.STCO=n.STTS,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),n.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},e.box=function(e){for(var t=8,n=null,i=Array.prototype.slice.call(arguments,1),r=i.length,a=0;a<r;a++)t+=i[a].byteLength;(n=new Uint8Array(t))[0]=t>>>24&255,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n.set(e,4);var o=8;for(a=0;a<r;a++)n.set(i[a],o),o+=i[a].byteLength;return n},e.generateInitSegment=function(t){var n=e.box(e.types.ftyp,e.constants.FTYP),i=e.moov(t),r=new Uint8Array(n.byteLength+i.byteLength);return r.set(n,0),r.set(i,n.byteLength),r},e.moov=function(t){var n=e.mvhd(t.timescale,t.duration),i=e.trak(t),r=e.mvex(t);return e.box(e.types.moov,n,i,r)},e.mvhd=function(t,n){return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},e.trak=function(t){return e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.tkhd=function(t){var n=t.id,i=t.duration,r=t.presentWidth,a=t.presentHeight;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>>8&255,255&r,0,0,a>>>8&255,255&a,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t),e.hdlr(t),e.minf(t))},e.mdhd=function(t){var n=t.timescale,i=t.duration;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i>>>24&255,i>>>16&255,i>>>8&255,255&i,85,196,0,0]))},e.hdlr=function(t){var n=null;return n="audio"===t.type?e.constants.HDLR_AUDIO:e.constants.HDLR_VIDEO,e.box(e.types.hdlr,n)},e.minf=function(t){var n=null;return n="audio"===t.type?e.box(e.types.smhd,e.constants.SMHD):e.box(e.types.vmhd,e.constants.VMHD),e.box(e.types.minf,n,e.dinf(),e.stbl(t))},e.dinf=function(){return e.box(e.types.dinf,e.box(e.types.dref,e.constants.DREF))},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.constants.STTS),e.box(e.types.stsc,e.constants.STSC),e.box(e.types.stsz,e.constants.STSZ),e.box(e.types.stco,e.constants.STCO))},e.stsd=function(t){return"audio"===t.type?"mp3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp3(t)):"ac-3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ac3(t)):"opus"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.Opus(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp4a(t)):"video"===t.type&&t.codec.startsWith("hvc1")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.hvc1(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.avc1(t))},e.mp3=function(t){var n=t.channelCount,i=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return e.box(e.types[".mp3"],r)},e.mp4a=function(t){var n=t.channelCount,i=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return e.box(e.types.mp4a,r,e.esds(t))},e.ac3=function(t){var n=t.channelCount,i=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return e.box(e.types["ac-3"],r,e.box(e.types.dac3,new Uint8Array(t.config)))},e.esds=function(t){var n=t.config||[],i=n.length,r=new Uint8Array([0,0,0,0,3,23+i,0,1,0,4,15+i,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([i]).concat(n).concat([6,1,2]));return e.box(e.types.esds,r)},e.Opus=function(t){var n=t.channelCount,i=t.audioSampleRate,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,i>>>8&255,255&i,0,0]);return e.box(e.types.Opus,r,e.dOps(t))},e.dOps=function(t){var n=t.channelCount,i=t.channelConfigCode,r=t.audioSampleRate;if(t.config)return e.box(e.types.dOps,o);var a=[];switch(i){case 1:case 2:a=[0];break;case 0:a=[255,1,1,0,1];break;case 128:a=[255,2,0,0,1];break;case 3:a=[1,2,1,0,2,1];break;case 4:a=[1,2,2,0,1,2,3];break;case 5:a=[1,3,2,0,4,1,2,3];break;case 6:a=[1,4,2,0,4,1,2,3,5];break;case 7:a=[1,4,2,0,4,1,2,3,5,6];break;case 8:a=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:a=[1,1,2,0,1];break;case 131:a=[1,1,3,0,1,2];break;case 132:a=[1,1,4,0,1,2,3];break;case 133:a=[1,1,5,0,1,2,3,4];break;case 134:a=[1,1,6,0,1,2,3,4,5];break;case 135:a=[1,1,7,0,1,2,3,4,5,6];break;case 136:a=[1,1,8,0,1,2,3,4,5,6,7]}var o=new Uint8Array(Se([0,n,0,0,r>>>24&255,r>>>17&255,r>>>8&255,r>>>0&255,0,0],a));return e.box(e.types.dOps,o)},e.avc1=function(t){var n=t.avcc,i=t.codecWidth,r=t.codecHeight,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>>8&255,255&i,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.avc1,a,e.box(e.types.avcC,n))},e.hvc1=function(t){var n=t.hvcc,i=t.codecWidth,r=t.codecHeight,a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,i>>>8&255,255&i,r>>>8&255,255&r,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.hvc1,a,e.box(e.types.hvcC,n))},e.mvex=function(t){return e.box(e.types.mvex,e.trex(t))},e.trex=function(t){var n=t.id,i=new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return e.box(e.types.trex,i)},e.moof=function(t,n){return e.box(e.types.moof,e.mfhd(t.sequenceNumber),e.traf(t,n))},e.mfhd=function(t){var n=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return e.box(e.types.mfhd,n)},e.traf=function(t,n){var i=t.id,r=e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,255&i])),a=e.box(e.types.tfdt,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n])),o=e.sdtp(t),s=e.trun(t,o.byteLength+16+16+8+16+8+8);return e.box(e.types.traf,r,a,s,o)},e.sdtp=function(t){for(var n=t.samples||[],i=n.length,r=new Uint8Array(4+i),a=0;a<i;a++){var o=n[a].flags;r[a+4]=o.isLeading<<6|o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy}return e.box(e.types.sdtp,r)},e.trun=function(t,n){var i=t.samples||[],r=i.length,a=12+16*r,o=new Uint8Array(a);n+=8+a,o.set([0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n],0);for(var s=0;s<r;s++){var c=i[s].duration,u=i[s].size,d=i[s].flags,h=i[s].cts;o.set([c>>>24&255,c>>>16&255,c>>>8&255,255&c,u>>>24&255,u>>>16&255,u>>>8&255,255&u,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.isNonSync,0,0,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*s)}return e.box(e.types.trun,o)},e.mdat=function(t){return e.box(e.types.mdat,t)},e}();Ae.init();var Ee=Ae,we=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),Te=n(7),Re=function(){function e(e){this.TAG="MP4Remuxer",this._config=e,this._isLive=!0===e.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new Te.c("audio"),this._videoSegmentInfoList=new Te.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!o.a.chrome||!(o.a.version.major<50||50===o.a.version.major&&o.a.version.build<2661)),this._fillSilentAfterSeek=o.a.msedge||o.a.msie,this._mp3UseMpegAudio=!o.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return e.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},e.prototype.bindDataSource=function(e){return e.onDataAvailable=this.remux.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(e.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(e){this._onInitSegment=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(e){this._onMediaSegment=e},enumerable:!1,configurable:!0}),e.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},e.prototype.seek=function(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},e.prototype.remux=function(e,t){if(!this._onMediaSegment)throw new h.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(e,t),t&&this._remuxVideo(t),e&&this._remuxAudio(e)},e.prototype._onTrackMetadataReceived=function(e,t){var n=null,i="mp4",r=t.codec;if("audio"===e)this._audioMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(i="mpeg",r="",n=new Uint8Array):n=Ee.generateInitSegment(t);else{if("video"!==e)return;this._videoMeta=t,n=Ee.generateInitSegment(t)}if(!this._onInitSegment)throw new h.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(e,{type:e,data:n.buffer,codec:r,container:e+"/"+i,mediaDuration:t.duration})},e.prototype._calculateDtsBase=function(e,t){this._dtsBaseInited||(e&&e.samples&&e.samples.length&&(this._audioDtsBase=e.samples[0].dts),t&&t.samples&&t.samples.length&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},e.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},e.prototype.flushStashedSamples=function(){var e=this._videoStashedLastSample,t=this._audioStashedLastSample,n={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(n.samples.push(e),n.length=e.length);var i={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(i.samples.push(t),i.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(n,!0),this._remuxAudio(i,!0)},e.prototype._remuxAudio=function(e,t){if(null!=this._audioMeta){var n,i=e,r=i.samples,s=void 0,c=-1,u=this._audioMeta.refSampleDuration,d="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,h=this._dtsBaseInited&&void 0===this._audioNextDts,l=!1;if(r&&0!==r.length&&(1!==r.length||t)){var _=0,f=null,p=0;d?(_=0,p=i.length):(_=8,p=8+i.length);var m=null;if(r.length>1&&(p-=(m=r.pop()).length),null!=this._audioStashedLastSample){var g=this._audioStashedLastSample;this._audioStashedLastSample=null,r.unshift(g),p+=g.length}null!=m&&(this._audioStashedLastSample=m);var v=r[0].dts-this._dtsBase;if(this._audioNextDts)s=v-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())s=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(l=!0);else{var y=this._audioSegmentInfoList.getLastSampleBefore(v);if(null!=y){var b=v-(y.originalDts+y.duration);b<=3&&(b=0),s=v-(y.dts+y.duration+b)}else s=0}if(l){var S=v-s,A=this._videoSegmentInfoList.getLastSegmentBefore(v);if(null!=A&&A.beginDts<S){if(P=we.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var E=A.beginDts,w=S-A.beginDts;a.a.v(this.TAG,"InsertPrefixSilentAudio: dts: "+E+", duration: "+w),r.unshift({unit:P,dts:E,pts:E}),p+=P.byteLength}}else l=!1}for(var T=[],R=0;R<r.length;R++){var k=(g=r[R]).unit,D=g.dts-this._dtsBase,L=(E=D,!1),C=null,I=0;if(!(D<-.001)){if("mp3"!==this._audioMeta.codec){var O=D;if(this._audioNextDts&&(O=this._audioNextDts),(s=D-O)<=-3*u){a.a.w(this.TAG,"Dropping 1 audio frame (originalDts: "+D+" ms ,curRefDts: "+O+" ms)  due to dtsCorrection: "+s+" ms overlap.");continue}if(s>=3*u&&this._fillAudioTimestampGap&&!o.a.safari){L=!0;var P,B=Math.floor(s/u);a.a.w(this.TAG,"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\noriginalDts: "+D+" ms, curRefDts: "+O+" ms, dtsCorrection: "+Math.round(s)+" ms, generate: "+B+" frames"),E=Math.floor(O),I=Math.floor(O+u)-E,null==(P=we.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))&&(a.a.w(this.TAG,"Unable to generate silent frame for "+this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame"),P=k),C=[];for(var M=0;M<B;M++){O+=u;var x=Math.floor(O),U=Math.floor(O+u)-x,N={dts:x,pts:x,cts:0,unit:P,size:P.byteLength,duration:U,originalDts:D,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};C.push(N),p+=N.size}this._audioNextDts=O+u}else E=Math.floor(O),I=Math.floor(O+u)-E,this._audioNextDts=O+u}else E=D-s,I=R!==r.length-1?r[R+1].dts-this._dtsBase-s-E:null!=m?m.dts-this._dtsBase-s-E:T.length>=1?T[T.length-1].duration:Math.floor(u),this._audioNextDts=E+I;-1===c&&(c=E),T.push({dts:E,pts:E,cts:0,unit:g.unit,size:g.unit.byteLength,duration:I,originalDts:D,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),L&&T.push.apply(T,C)}}if(0===T.length)return i.samples=[],void(i.length=0);for(d?f=new Uint8Array(p):((f=new Uint8Array(p))[0]=p>>>24&255,f[1]=p>>>16&255,f[2]=p>>>8&255,f[3]=255&p,f.set(Ee.types.mdat,4)),R=0;R<T.length;R++)k=T[R].unit,f.set(k,_),_+=k.byteLength;var G=T[T.length-1];n=G.dts+G.duration;var F=new Te.b;F.beginDts=c,F.endDts=n,F.beginPts=c,F.endPts=n,F.originalBeginDts=T[0].originalDts,F.originalEndDts=G.originalDts+G.duration,F.firstSample=new Te.d(T[0].dts,T[0].pts,T[0].duration,T[0].originalDts,!1),F.lastSample=new Te.d(G.dts,G.pts,G.duration,G.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(F),i.samples=T,i.sequenceNumber++;var j=null;j=d?new Uint8Array:Ee.moof(i,c),i.samples=[],i.length=0;var V={type:"audio",data:this._mergeBoxes(j,f).buffer,sampleCount:T.length,info:F};d&&h&&(V.timestampOffset=c),this._onMediaSegment("audio",V)}}},e.prototype._remuxVideo=function(e,t){if(null!=this._videoMeta){var n,i,r=e,a=r.samples,o=void 0,s=-1,c=-1;if(a&&0!==a.length&&(1!==a.length||t)){var u=8,d=null,h=8+e.length,l=null;if(a.length>1&&(h-=(l=a.pop()).length),null!=this._videoStashedLastSample){var _=this._videoStashedLastSample;this._videoStashedLastSample=null,a.unshift(_),h+=_.length}null!=l&&(this._videoStashedLastSample=l);var f=a[0].dts-this._dtsBase;if(this._videoNextDts)o=f-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())o=0;else{var p=this._videoSegmentInfoList.getLastSampleBefore(f);if(null!=p){var m=f-(p.originalDts+p.duration);m<=3&&(m=0),o=f-(p.dts+p.duration+m)}else o=0}for(var g=new Te.b,v=[],y=0;y<a.length;y++){var b=(_=a[y]).dts-this._dtsBase,S=_.isKeyframe,A=b-o,E=_.cts,w=A+E;-1===s&&(s=A,c=w);var T=0;if(T=y!==a.length-1?a[y+1].dts-this._dtsBase-o-A:null!=l?l.dts-this._dtsBase-o-A:v.length>=1?v[v.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),S){var R=new Te.d(A,w,T,_.dts,!0);R.fileposition=_.fileposition,g.appendSyncPoint(R)}v.push({dts:A,pts:w,cts:E,units:_.units,size:_.length,isKeyframe:S,duration:T,originalDts:b,flags:{isLeading:0,dependsOn:S?2:1,isDependedOn:S?1:0,hasRedundancy:0,isNonSync:S?0:1}})}for((d=new Uint8Array(h))[0]=h>>>24&255,d[1]=h>>>16&255,d[2]=h>>>8&255,d[3]=255&h,d.set(Ee.types.mdat,4),y=0;y<v.length;y++)for(var k=v[y].units;k.length;){var D=k.shift().data;d.set(D,u),u+=D.byteLength}var L=v[v.length-1];if(n=L.dts+L.duration,i=L.pts+L.duration,this._videoNextDts=n,g.beginDts=s,g.endDts=n,g.beginPts=c,g.endPts=i,g.originalBeginDts=v[0].originalDts,g.originalEndDts=L.originalDts+L.duration,g.firstSample=new Te.d(v[0].dts,v[0].pts,v[0].duration,v[0].originalDts,v[0].isKeyframe),g.lastSample=new Te.d(L.dts,L.pts,L.duration,L.originalDts,L.isKeyframe),this._isLive||this._videoSegmentInfoList.append(g),r.samples=v,r.sequenceNumber++,this._forceFirstIDR){var C=v[0].flags;C.dependsOn=2,C.isNonSync=0}var I=Ee.moof(r,s);r.samples=[],r.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(I,d).buffer,sampleCount:v.length,info:g})}}},e.prototype._mergeBoxes=function(e,t){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(e,0),n.set(t,e.byteLength),n},e}(),ke=n(11),De=n(1),Le=function(){function e(e,t){this.TAG="TransmuxingController",this._emitter=new r.a,this._config=t,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),"boolean"!=typeof e.cors&&(e.cors=!0),"boolean"!=typeof e.withCredentials&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;var n=0;this._mediaDataSource.segments.forEach((function(i){i.timestampBase=n,n+=i.duration,i.cors=e.cors,i.withCredentials=e.withCredentials,t.referrerPolicy&&(i.referrerPolicy=t.referrerPolicy)})),isNaN(n)||this._mediaDataSource.duration===n||(this._mediaDataSource.duration=n),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return e.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},e.prototype._loadSegment=function(e,t){this._currentSegmentIndex=e;var n=this._mediaDataSource.segments[e],i=this._ioctl=new ke.a(n,this._config,e);i.onError=this._onIOException.bind(this),i.onSeeked=this._onIOSeeked.bind(this),i.onComplete=this._onIOComplete.bind(this),i.onRedirect=this._onIORedirect.bind(this),i.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),t?this._demuxer.bindDataSource(this._ioctl):i.onDataArrival=this._onInitChunkArrival.bind(this),i.open(t)},e.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},e.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},e.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},e.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},e.prototype.seek=function(e){if(null!=this._mediaInfo&&this._mediaInfo.isSeekable()){var t=this._searchSegmentIndexContains(e);if(t===this._currentSegmentIndex){var n=this._mediaInfo.segments[t];if(null==n)this._pendingSeekTime=e;else{var i=n.getNearestKeyframe(e);this._remuxer.seek(i.milliseconds),this._ioctl.seek(i.fileposition),this._pendingResolveSeekPoint=i.milliseconds}}else{var r=this._mediaInfo.segments[t];null==r?(this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(t)):(i=r.getNearestKeyframe(e),this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[t].timestampBase,this._loadSegment(t,i.fileposition),this._pendingResolveSeekPoint=i.milliseconds,this._reportSegmentMediaInfo(t))}this._enableStatisticsReporter()}},e.prototype._searchSegmentIndexContains=function(e){for(var t=this._mediaDataSource.segments,n=t.length-1,i=0;i<t.length;i++)if(e<t[i].timestampBase){n=i-1;break}return n},e.prototype._onInitChunkArrival=function(e,t){var n=this,i=0;if(t>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,i=this._demuxer.parseChunks(e,t);else{var r=null;(r=E.probe(e)).match&&(this._setupFLVDemuxerRemuxer(r),i=this._demuxer.parseChunks(e,t)),r.match||r.needMoreData||(r=be.probe(e)).match&&(this._setupTSDemuxerRemuxer(r),i=this._demuxer.parseChunks(e,t)),r.match||r.needMoreData||(r=null,a.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then((function(){n._internalAbort()})),this._emitter.emit(De.a.DEMUX_ERROR,m.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return i},e.prototype._setupFLVDemuxerRemuxer=function(e){this._demuxer=new E(e,this._config),this._remuxer||(this._remuxer=new Re(this._config));var t=this._mediaDataSource;null==t.duration||isNaN(t.duration)||(this._demuxer.overridedDuration=t.duration),"boolean"==typeof t.hasAudio&&(this._demuxer.overridedHasAudio=t.hasAudio),"boolean"==typeof t.hasVideo&&(this._demuxer.overridedHasVideo=t.hasVideo),this._demuxer.timestampBase=t.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._setupTSDemuxerRemuxer=function(e){var t=this._demuxer=new be(e,this._config);this._remuxer||(this._remuxer=new Re(this._config)),t.onError=this._onDemuxException.bind(this),t.onMediaInfo=this._onMediaInfo.bind(this),t.onMetaDataArrived=this._onMetaDataArrived.bind(this),t.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),t.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),t.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),t.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),t.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._onMediaInfo=function(e){var t=this;null==this._mediaInfo&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,s.a.prototype));var n=Object.assign({},e);Object.setPrototypeOf(n,s.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=n,this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then((function(){var e=t._pendingSeekTime;t._pendingSeekTime=null,t.seek(e)}))},e.prototype._onMetaDataArrived=function(e){this._emitter.emit(De.a.METADATA_ARRIVED,e)},e.prototype._onScriptDataArrived=function(e){this._emitter.emit(De.a.SCRIPTDATA_ARRIVED,e)},e.prototype._onTimedID3Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(De.a.TIMED_ID3_METADATA_ARRIVED,e))},e.prototype._onSMPTE2038Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),this._emitter.emit(De.a.SMPTE2038_METADATA_ARRIVED,e))},e.prototype._onSCTE35Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),this._emitter.emit(De.a.SCTE35_METADATA_ARRIVED,e))},e.prototype._onPESPrivateDataDescriptor=function(e){this._emitter.emit(De.a.PES_PRIVATE_DATA_DESCRIPTOR,e)},e.prototype._onPESPrivateData=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(De.a.PES_PRIVATE_DATA_ARRIVED,e))},e.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},e.prototype._onIOComplete=function(e){var t=e+1;t<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(t)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(De.a.LOADING_COMPLETE),this._disableStatisticsReporter())},e.prototype._onIORedirect=function(e){var t=this._ioctl.extraData;this._mediaDataSource.segments[t].redirectedURL=e},e.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(De.a.RECOVERED_EARLY_EOF)},e.prototype._onIOException=function(e,t){a.a.e(this.TAG,"IOException: type = "+e+", code = "+t.code+", msg = "+t.msg),this._emitter.emit(De.a.IO_ERROR,e,t),this._disableStatisticsReporter()},e.prototype._onDemuxException=function(e,t){a.a.e(this.TAG,"DemuxException: type = "+e+", info = "+t),this._emitter.emit(De.a.DEMUX_ERROR,e,t)},e.prototype._onRemuxerInitSegmentArrival=function(e,t){this._emitter.emit(De.a.INIT_SEGMENT,e,t)},e.prototype._onRemuxerMediaSegmentArrival=function(e,t){if(null==this._pendingSeekTime&&(this._emitter.emit(De.a.MEDIA_SEGMENT,e,t),null!=this._pendingResolveSeekPoint&&"video"===e)){var n=t.info.syncPoints,i=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,o.a.safari&&n.length>0&&n[0].originalDts===i&&(i=n[0].pts),this._emitter.emit(De.a.RECOMMEND_SEEKPOINT,i)}},e.prototype._enableStatisticsReporter=function(){null==this._statisticsReporter&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},e.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype._reportSegmentMediaInfo=function(e){var t=this._mediaInfo.segments[e],n=Object.assign({},t);n.duration=this._mediaInfo.duration,n.segmentCount=this._mediaInfo.segmentCount,delete n.segments,delete n.keyframesIndex,this._emitter.emit(De.a.MEDIA_INFO,n)},e.prototype._reportStatisticsInfo=function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(De.a.STATISTICS_INFO,e)},e}();t.a=Le},function(e,t,n){"use strict";var i,r=n(0),a=function(){function e(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return e.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},e.prototype.addBytes=function(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())},Object.defineProperty(e.prototype,"currentKBps",{get:function(){this.addBytes(0);var e=(this._now()-this._lastCheckpoint)/1e3;return 0==e&&(e=1),this._intervalBytes/e/1024},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"averageKBps",{get:function(){var e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024},enumerable:!1,configurable:!0}),e}(),o=n(2),s=n(4),c=n(3),u=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(t,n){var i=e.call(this,"fetch-stream-loader")||this;return i.TAG="FetchStreamLoader",i._seekHandler=t,i._config=n,i._needStash=!0,i._requestAbort=!1,i._abortController=null,i._contentLength=null,i._receivedLength=0,i}return u(t,e),t.isSupported=function(){try{var e=s.a.msedge&&s.a.version.minor>=15048,t=!s.a.msedge||e;return self.fetch&&self.ReadableStream&&t}catch(e){return!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){var n=this;this._dataSource=e,this._range=t;var i=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(i=e.redirectedURL);var r=this._seekHandler.getConfig(i,t),a=new self.Headers;if("object"==typeof r.headers){var s=r.headers;for(var u in s)s.hasOwnProperty(u)&&a.append(u,s[u])}var d={method:"GET",headers:a,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"==typeof this._config.headers)for(var u in this._config.headers)a.append(u,this._config.headers[u]);!1===e.cors&&(d.mode="same-origin"),e.withCredentials&&(d.credentials="include"),e.referrerPolicy&&(d.referrerPolicy=e.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,d.signal=this._abortController.signal),this._status=o.c.kConnecting,self.fetch(r.url,d).then((function(e){if(n._requestAbort)return n._status=o.c.kIdle,void e.body.cancel();if(e.ok&&e.status>=200&&e.status<=299){if(e.url!==r.url&&n._onURLRedirect){var t=n._seekHandler.removeURLParameters(e.url);n._onURLRedirect(t)}var i=e.headers.get("Content-Length");return null!=i&&(n._contentLength=parseInt(i),0!==n._contentLength&&n._onContentLengthKnown&&n._onContentLengthKnown(n._contentLength)),n._pump.call(n,e.body.getReader())}if(n._status=o.c.kError,!n._onError)throw new c.d("FetchStreamLoader: Http code invalid, "+e.status+" "+e.statusText);n._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:e.status,msg:e.statusText})})).catch((function(e){if(!n._abortController||!n._abortController.signal.aborted){if(n._status=o.c.kError,!n._onError)throw e;n._onError(o.b.EXCEPTION,{code:-1,msg:e.message})}}))},t.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==o.c.kBuffering||!s.a.chrome)&&this._abortController)try{this._abortController.abort()}catch(e){}},t.prototype._pump=function(e){var t=this;return e.read().then((function(n){if(n.done)if(null!==t._contentLength&&t._receivedLength<t._contentLength){t._status=o.c.kError;var i=o.b.EARLY_EOF,r={code:-1,msg:"Fetch stream meet Early-EOF"};if(!t._onError)throw new c.d(r.msg);t._onError(i,r)}else t._status=o.c.kComplete,t._onComplete&&t._onComplete(t._range.from,t._range.from+t._receivedLength-1);else{if(t._abortController&&t._abortController.signal.aborted)return void(t._status=o.c.kComplete);if(!0===t._requestAbort)return t._status=o.c.kComplete,e.cancel();t._status=o.c.kBuffering;var a=n.value.buffer,s=t._range.from+t._receivedLength;t._receivedLength+=a.byteLength,t._onDataArrival&&t._onDataArrival(a,s,t._receivedLength),t._pump(e)}})).catch((function(e){if(t._abortController&&t._abortController.signal.aborted)t._status=o.c.kComplete;else if(11!==e.code||!s.a.msedge){t._status=o.c.kError;var n=0,i=null;if(19!==e.code&&"network error"!==e.message||!(null===t._contentLength||null!==t._contentLength&&t._receivedLength<t._contentLength)?(n=o.b.EXCEPTION,i={code:e.code,msg:e.message}):(n=o.b.EARLY_EOF,i={code:e.code,msg:"Fetch stream meet Early-EOF"}),!t._onError)throw new c.d(i.msg);t._onError(n,i)}}))},t}(o.a),h=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),l=function(e){function t(t,n){var i=e.call(this,"xhr-moz-chunked-loader")||this;return i.TAG="MozChunkedLoader",i._seekHandler=t,i._config=n,i._needStash=!0,i._xhr=null,i._requestAbort=!1,i._contentLength=null,i._receivedLength=0,i}return h(t,e),t.isSupported=function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(e){return r.a.w("MozChunkedLoader",e.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){this._dataSource=e,this._range=t;var n=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(n=e.redirectedURL);var i=this._seekHandler.getConfig(n,t);this._requestURL=i.url;var r=this._xhr=new XMLHttpRequest;if(r.open("GET",i.url,!0),r.responseType="moz-chunked-arraybuffer",r.onreadystatechange=this._onReadyStateChange.bind(this),r.onprogress=this._onProgress.bind(this),r.onloadend=this._onLoadEnd.bind(this),r.onerror=this._onXhrError.bind(this),e.withCredentials&&(r.withCredentials=!0),"object"==typeof i.headers){var a=i.headers;for(var s in a)a.hasOwnProperty(s)&&r.setRequestHeader(s,a[s])}if("object"==typeof this._config.headers)for(var s in a=this._config.headers)a.hasOwnProperty(s)&&r.setRequestHeader(s,a[s]);this._status=o.c.kConnecting,r.send()},t.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=o.c.kComplete},t.prototype._onReadyStateChange=function(e){var t=e.target;if(2===t.readyState){if(null!=t.responseURL&&t.responseURL!==this._requestURL&&this._onURLRedirect){var n=this._seekHandler.removeURLParameters(t.responseURL);this._onURLRedirect(n)}if(0!==t.status&&(t.status<200||t.status>299)){if(this._status=o.c.kError,!this._onError)throw new c.d("MozChunkedLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else this._status=o.c.kBuffering}},t.prototype._onProgress=function(e){if(this._status!==o.c.kError){null===this._contentLength&&null!==e.total&&0!==e.total&&(this._contentLength=e.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var t=e.target.response,n=this._range.from+this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,n,this._receivedLength)}},t.prototype._onLoadEnd=function(e){!0!==this._requestAbort?this._status!==o.c.kError&&(this._status=o.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},t.prototype._onXhrError=function(e){this._status=o.c.kError;var t=0,n=null;if(this._contentLength&&e.loaded<this._contentLength?(t=o.b.EARLY_EOF,n={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(t=o.b.EXCEPTION,n={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new c.d(n.msg);this._onError(t,n)},t}(o.a),_=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),f=function(e){function t(t,n){var i=e.call(this,"xhr-range-loader")||this;return i.TAG="RangeLoader",i._seekHandler=t,i._config=n,i._needStash=!1,i._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],i._currentChunkSizeKB=384,i._currentSpeedNormalized=0,i._zeroSpeedChunkCount=0,i._xhr=null,i._speedSampler=new a,i._requestAbort=!1,i._waitForTotalLength=!1,i._totalLengthReceived=!1,i._currentRequestURL=null,i._currentRedirectedURL=null,i._currentRequestRange=null,i._totalLength=null,i._contentLength=null,i._receivedLength=0,i._lastTimeLoaded=0,i}return _(t,e),t.isSupported=function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="arraybuffer","arraybuffer"===e.responseType}catch(e){return r.a.w("RangeLoader",e.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),e.prototype.destroy.call(this)},Object.defineProperty(t.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),t.prototype.open=function(e,t){this._dataSource=e,this._range=t,this._status=o.c.kConnecting;var n=!1;null!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(n=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||n?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},t.prototype._openSubRange=function(){var e=1024*this._currentChunkSizeKB,t=this._range.from+this._receivedLength,n=t+e;null!=this._contentLength&&n-this._range.from>=this._contentLength&&(n=this._range.from+this._contentLength-1),this._currentRequestRange={from:t,to:n},this._internalOpen(this._dataSource,this._currentRequestRange)},t.prototype._internalOpen=function(e,t){this._lastTimeLoaded=0;var n=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?n=this._currentRedirectedURL:null!=e.redirectedURL&&(n=e.redirectedURL));var i=this._seekHandler.getConfig(n,t);this._currentRequestURL=i.url;var r=this._xhr=new XMLHttpRequest;if(r.open("GET",i.url,!0),r.responseType="arraybuffer",r.onreadystatechange=this._onReadyStateChange.bind(this),r.onprogress=this._onProgress.bind(this),r.onload=this._onLoad.bind(this),r.onerror=this._onXhrError.bind(this),e.withCredentials&&(r.withCredentials=!0),"object"==typeof i.headers){var a=i.headers;for(var o in a)a.hasOwnProperty(o)&&r.setRequestHeader(o,a[o])}if("object"==typeof this._config.headers)for(var o in a=this._config.headers)a.hasOwnProperty(o)&&r.setRequestHeader(o,a[o]);r.send()},t.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=o.c.kComplete},t.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},t.prototype._onReadyStateChange=function(e){var t=e.target;if(2===t.readyState){if(null!=t.responseURL){var n=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&n!==this._currentRedirectedURL&&(this._currentRedirectedURL=n,this._onURLRedirect&&this._onURLRedirect(n))}if(t.status>=200&&t.status<=299){if(this._waitForTotalLength)return;this._status=o.c.kBuffering}else{if(this._status=o.c.kError,!this._onError)throw new c.d("RangeLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}}},t.prototype._onProgress=function(e){if(this._status!==o.c.kError){if(null===this._contentLength){var t=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,t=!0;var n=e.total;this._internalAbort(),null!=n&0!==n&&(this._totalLength=n)}if(-1===this._range.to?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,t)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var i=e.loaded-this._lastTimeLoaded;this._lastTimeLoaded=e.loaded,this._speedSampler.addBytes(i)}},t.prototype._normalizeSpeed=function(e){var t=this._chunkSizeKBList,n=t.length-1,i=0,r=0,a=n;if(e<t[0])return t[0];for(;r<=a;){if((i=r+Math.floor((a-r)/2))===n||e>=t[i]&&e<t[i+1])return t[i];t[i]<e?r=i+1:a=i-1}},t.prototype._onLoad=function(e){if(this._status!==o.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var t=this._speedSampler.lastSecondKBps;if(0===t&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(t=this._speedSampler.currentKBps)),0!==t){var n=this._normalizeSpeed(t);this._currentSpeedNormalized!==n&&(this._currentSpeedNormalized=n,this._currentChunkSizeKB=n)}var i=e.target.response,r=this._range.from+this._receivedLength;this._receivedLength+=i.byteLength;var a=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():a=!0,this._onDataArrival&&this._onDataArrival(i,r,this._receivedLength),a&&(this._status=o.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},t.prototype._onXhrError=function(e){this._status=o.c.kError;var t=0,n=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(t=o.b.EARLY_EOF,n={code:-1,msg:"RangeLoader meet Early-Eof"}):(t=o.b.EXCEPTION,n={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new c.d(n.msg);this._onError(t,n)},t}(o.a),p=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),m=function(e){function t(){var t=e.call(this,"websocket-loader")||this;return t.TAG="WebSocketLoader",t._needStash=!0,t._ws=null,t._requestAbort=!1,t._receivedLength=0,t}return p(t,e),t.isSupported=function(){try{return void 0!==self.WebSocket}catch(e){return!1}},t.prototype.destroy=function(){this._ws&&this.abort(),e.prototype.destroy.call(this)},t.prototype.open=function(e){try{var t=this._ws=new self.WebSocket(e.url);t.binaryType="arraybuffer",t.onopen=this._onWebSocketOpen.bind(this),t.onclose=this._onWebSocketClose.bind(this),t.onmessage=this._onWebSocketMessage.bind(this),t.onerror=this._onWebSocketError.bind(this),this._status=o.c.kConnecting}catch(e){this._status=o.c.kError;var n={code:e.code,msg:e.message};if(!this._onError)throw new c.d(n.msg);this._onError(o.b.EXCEPTION,n)}},t.prototype.abort=function(){var e=this._ws;!e||0!==e.readyState&&1!==e.readyState||(this._requestAbort=!0,e.close()),this._ws=null,this._status=o.c.kComplete},t.prototype._onWebSocketOpen=function(e){this._status=o.c.kBuffering},t.prototype._onWebSocketClose=function(e){!0!==this._requestAbort?(this._status=o.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},t.prototype._onWebSocketMessage=function(e){var t=this;if(e.data instanceof ArrayBuffer)this._dispatchArrayBuffer(e.data);else if(e.data instanceof Blob){var n=new FileReader;n.onload=function(){t._dispatchArrayBuffer(n.result)},n.readAsArrayBuffer(e.data)}else{this._status=o.c.kError;var i={code:-1,msg:"Unsupported WebSocket message type: "+e.data.constructor.name};if(!this._onError)throw new c.d(i.msg);this._onError(o.b.EXCEPTION,i)}},t.prototype._dispatchArrayBuffer=function(e){var t=e,n=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,n,this._receivedLength)},t.prototype._onWebSocketError=function(e){this._status=o.c.kError;var t={code:e.code,msg:e.message};if(!this._onError)throw new c.d(t.msg);this._onError(o.b.EXCEPTION,t)},t}(o.a),g=function(){function e(e){this._zeroStart=e||!1}return e.prototype.getConfig=function(e,t){var n={};if(0!==t.from||-1!==t.to){var i=void 0;i=-1!==t.to?"bytes="+t.from.toString()+"-"+t.to.toString():"bytes="+t.from.toString()+"-",n.Range=i}else this._zeroStart&&(n.Range="bytes=0-");return{url:e,headers:n}},e.prototype.removeURLParameters=function(e){return e},e}(),v=function(){function e(e,t){this._startName=e,this._endName=t}return e.prototype.getConfig=function(e,t){var n=e;if(0!==t.from||-1!==t.to){var i=!0;-1===n.indexOf("?")&&(n+="?",i=!1),i&&(n+="&"),n+=this._startName+"="+t.from.toString(),-1!==t.to&&(n+="&"+this._endName+"="+t.to.toString())}return{url:n,headers:{}}},e.prototype.removeURLParameters=function(e){var t=e.split("?")[0],n=void 0,i=e.indexOf("?");-1!==i&&(n=e.substring(i+1));var r="";if(null!=n&&n.length>0)for(var a=n.split("&"),o=0;o<a.length;o++){var s=a[o].split("="),c=o>0;s[0]!==this._startName&&s[0]!==this._endName&&(c&&(r+="&"),r+=a[o])}return 0===r.length?t:t+"?"+r},e}(),y=function(){function e(e,t,n){this.TAG="IOController",this._config=t,this._extraData=n,this._stashInitialSize=65536,null!=t.stashInitialSize&&t.stashInitialSize>0&&(this._stashInitialSize=t.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,!1===t.enableStashBuffer&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new a,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return e.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},e.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},e.prototype.isPaused=function(){return this._paused},Object.defineProperty(e.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extraData",{get:function(){return this._extraData},set:function(e){this._extraData=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(e){this._onSeeked=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(e){this._onRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasRedirect",{get:function(){return null!=this._redirectedURL||null!=this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentSpeed",{get:function(){return this._loaderClass===f?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),e.prototype._selectSeekHandler=function(){var e=this._config;if("range"===e.seekType)this._seekHandler=new g(this._config.rangeLoadZeroStart);else if("param"===e.seekType){var t=e.seekParamStart||"bstart",n=e.seekParamEnd||"bend";this._seekHandler=new v(t,n)}else{if("custom"!==e.seekType)throw new c.b("Invalid seekType in config: "+e.seekType);if("function"!=typeof e.customSeekHandler)throw new c.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}},e.prototype._selectLoader=function(){if(null!=this._config.customLoader)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=m;else if(d.isSupported())this._loaderClass=d;else if(l.isSupported())this._loaderClass=l;else{if(!f.isSupported())throw new c.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=f}},e.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),!1===this._loader.needStashBuffer&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},e.prototype.open=function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},e.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},e.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},e.prototype.resume=function(){if(this._paused){this._paused=!1;var e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}},e.prototype.seek=function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)},e.prototype._internalSeek=function(e,t){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(t),this._loader.destroy(),this._loader=null;var n={from:e,to:-1};this._currentRange={from:n.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,n),this._onSeeked&&this._onSeeked()},e.prototype.updateUrl=function(e){if(!e||"string"!=typeof e||0===e.length)throw new c.b("Url must be a non-empty string!");this._dataSource.url=e},e.prototype._expandBuffer=function(e){for(var t=this._stashSize;t+1048576<e;)t*=2;if((t+=1048576)!==this._bufferSize){var n=new ArrayBuffer(t);if(this._stashUsed>0){var i=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(n,0,t).set(i,0)}this._stashBuffer=n,this._bufferSize=t}},e.prototype._normalizeSpeed=function(e){var t=this._speedNormalizeList,n=t.length-1,i=0,r=0,a=n;if(e<t[0])return t[0];for(;r<=a;){if((i=r+Math.floor((a-r)/2))===n||e>=t[i]&&e<t[i+1])return t[i];t[i]<e?r=i+1:a=i-1}},e.prototype._adjustStashSize=function(e){var t=0;(t=this._config.isLive?e/8:e<512?e:e>=512&&e<=1024?Math.floor(1.5*e):2*e)>8192&&(t=8192);var n=1024*t+1048576;this._bufferSize<n&&this._expandBuffer(n),this._stashSize=1024*t},e.prototype._dispatchChunks=function(e,t){return this._currentRange.to=t+e.byteLength-1,this._onDataArrival(e,t)},e.prototype._onURLRedirect=function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)},e.prototype._onContentLengthKnown=function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)},e.prototype._onLoaderChunkArrival=function(e,t,n){if(!this._onDataArrival)throw new c.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);var i=this._speedSampler.lastSecondKBps;if(0!==i){var r=this._normalizeSpeed(i);this._speedNormalized!==r&&(this._speedNormalized=r,this._adjustStashSize(r))}if(this._enableStash)if(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=t),this._stashUsed+e.byteLength<=this._stashSize)(s=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;else if(s=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var a=this._stashBuffer.slice(0,this._stashUsed);(u=this._dispatchChunks(a,this._stashByteStart))<a.byteLength?u>0&&(d=new Uint8Array(a,u),s.set(d,0),this._stashUsed=d.byteLength,this._stashByteStart+=u):(this._stashUsed=0,this._stashByteStart+=u),this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),s=new Uint8Array(this._stashBuffer,0,this._bufferSize)),s.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else(u=this._dispatchChunks(e,t))<e.byteLength&&((o=e.byteLength-u)>this._bufferSize&&(this._expandBuffer(o),s=new Uint8Array(this._stashBuffer,0,this._bufferSize)),s.set(new Uint8Array(e,u),0),this._stashUsed+=o,this._stashByteStart=t+u);else if(0===this._stashUsed){var o;(u=this._dispatchChunks(e,t))<e.byteLength&&((o=e.byteLength-u)>this._bufferSize&&this._expandBuffer(o),(s=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e,u),0),this._stashUsed+=o,this._stashByteStart=t+u)}else{var s,u;if(this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength),(s=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength,(u=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&u>0){var d=new Uint8Array(this._stashBuffer,u);s.set(d,0)}this._stashUsed-=u,this._stashByteStart+=u}}},e.prototype._flushStashBuffer=function(e){if(this._stashUsed>0){var t=this._stashBuffer.slice(0,this._stashUsed),n=this._dispatchChunks(t,this._stashByteStart),i=t.byteLength-n;if(n<t.byteLength){if(!e){if(n>0){var a=new Uint8Array(this._stashBuffer,0,this._bufferSize),o=new Uint8Array(t,n);a.set(o,0),this._stashUsed=o.byteLength,this._stashByteStart+=n}return 0}r.a.w(this.TAG,i+" bytes unconsumed data remain when flush buffer, dropped")}return this._stashUsed=0,this._stashByteStart=0,i}return 0},e.prototype._onLoaderComplete=function(e,t){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},e.prototype._onLoaderError=function(e,t){switch(r.a.e(this.TAG,"Loader error, code = "+t.code+", msg = "+t.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=o.b.UNRECOVERABLE_EARLY_EOF),e){case o.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var n=this._currentRange.to+1;return void(n<this._totalLength&&(r.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(n,!1)))}e=o.b.UNRECOVERABLE_EARLY_EOF;case o.b.UNRECOVERABLE_EARLY_EOF:case o.b.CONNECTING_TIMEOUT:case o.b.HTTP_STATUS_CODE_INVALID:case o.b.EXCEPTION:}if(!this._onError)throw new c.d("IOException: "+t.msg);this._onError(e,t)},e}();t.a=y},function(e,t,n){"use strict";var i=function(){function e(){}return e.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Object.assign=Object.assign||function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t},"function"!=typeof self.Promise&&n(15).polyfill()},e}();i.install(),t.a=i},function(e,t,n){function i(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw console.error(e),e};var i=n(n.s=ENTRY_MODULE);return i.default||i}function r(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,i){var a={};a[i]=[];var o=t.toString(),s=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return a;for(var c,u=s[1],d=new RegExp("(\\\\n|\\W)"+r(u)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");c=d.exec(o);)"dll-reference"!==c[3]&&a[i].push(c[3]);for(d=new RegExp("\\("+r(u)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");c=d.exec(o);)e[c[2]]||(a[i].push(c[1]),e[c[2]]=n(c[1]).m),a[c[2]]=a[c[2]]||[],a[c[2]].push(c[4]);for(var h,l=Object.keys(a),_=0;_<l.length;_++)for(var f=0;f<a[l[_]].length;f++)h=a[l[_]][f],isNaN(1*h)||(a[l[_]][f]=1*a[l[_]][f]);return a}function o(e){return Object.keys(e).reduce((function(t,n){return t||e[n].length>0}),!1)}e.exports=function(e,t){t=t||{};var r={main:n.m},s=t.all?{main:Object.keys(r.main)}:function(e,t){for(var n={main:[t]},i={main:[]},r={main:{}};o(n);)for(var s=Object.keys(n),c=0;c<s.length;c++){var u=s[c],d=n[u].pop();if(r[u]=r[u]||{},!r[u][d]&&e[u][d]){r[u][d]=!0,i[u]=i[u]||[],i[u].push(d);for(var h=a(e,e[u][d],u),l=Object.keys(h),_=0;_<l.length;_++)n[l[_]]=n[l[_]]||[],n[l[_]]=n[l[_]].concat(h[l[_]])}}return i}(r,e),c="";Object.keys(s).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;s[e][t];)t++;s[e].push(t),r[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",c=c+"var "+e+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s[e].map((function(t){return JSON.stringify(t)+": "+r[e][t].toString()})).join(",")+"});\n"})),c=c+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s.main.map((function(e){return JSON.stringify(e)+": "+r.main[e].toString()})).join(",")+"}))(self);";var u=new window.Blob([c],{type:"text/javascript"});if(t.bare)return u;var d=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),h=new window.Worker(d);return h.objectURL=d,h}},function(e,t,n){e.exports=n(19).default},function(e,t,n){(function(t,n){var i;i=function(){"use strict";function e(e){return"function"==typeof e}var i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,a=void 0,o=void 0,s=function(e,t){f[r]=e,f[r+1]=t,2===(r+=2)&&(o?o(p):b())},c="undefined"!=typeof window?window:void 0,u=c||{},d=u.MutationObserver||u.WebKitMutationObserver,h="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function _(){var e=setTimeout;return function(){return e(p,1)}}var f=new Array(1e3);function p(){for(var e=0;e<r;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;r=0}var m,g,v,y,b=void 0;function S(e,t){var n=this,i=new this.constructor(w);void 0===i[E]&&B(i);var r=n._state;if(r){var a=arguments[r-1];s((function(){return O(r,i,a,n._result)}))}else C(n,i,e,t);return i}function A(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(w);return R(t,e),t}h?b=function(){return t.nextTick(p)}:d?(g=0,v=new d(p),y=document.createTextNode(""),v.observe(y,{characterData:!0}),b=function(){y.data=g=++g%2}):l?((m=new MessageChannel).port1.onmessage=p,b=function(){return m.port2.postMessage(0)}):b=void 0===c?function(){try{var e=Function("return this")().require("vertx");return void 0!==(a=e.runOnLoop||e.runOnContext)?function(){a(p)}:_()}catch(e){return _()}}():_();var E=Math.random().toString(36).substring(2);function w(){}function T(t,n,i){n.constructor===t.constructor&&i===S&&n.constructor.resolve===A?function(e,t){1===t._state?D(e,t._result):2===t._state?L(e,t._result):C(t,void 0,(function(t){return R(e,t)}),(function(t){return L(e,t)}))}(t,n):void 0===i?D(t,n):e(i)?function(e,t,n){s((function(e){var i=!1,r=function(e,t,n,i){try{e.call(t,n,i)}catch(e){return e}}(n,t,(function(n){i||(i=!0,t!==n?R(e,n):D(e,n))}),(function(t){i||(i=!0,L(e,t))}),e._label);!i&&r&&(i=!0,L(e,r))}),e)}(t,n,i):D(t,n)}function R(e,t){if(e===t)L(e,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=t),null===i||"object"!==r&&"function"!==r)D(e,t);else{var n=void 0;try{n=t.then}catch(t){return void L(e,t)}T(e,t,n)}var i,r}function k(e){e._onerror&&e._onerror(e._result),I(e)}function D(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&s(I,e))}function L(e,t){void 0===e._state&&(e._state=2,e._result=t,s(k,e))}function C(e,t,n,i){var r=e._subscribers,a=r.length;e._onerror=null,r[a]=t,r[a+1]=n,r[a+2]=i,0===a&&e._state&&s(I,e)}function I(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,r=void 0,a=e._result,o=0;o<t.length;o+=3)i=t[o],r=t[o+n],i?O(n,i,r,a):r(a);e._subscribers.length=0}}function O(t,n,i,r){var a=e(i),o=void 0,s=void 0,c=!0;if(a){try{o=i(r)}catch(e){c=!1,s=e}if(n===o)return void L(n,new TypeError("A promises callback cannot return that same promise."))}else o=r;void 0!==n._state||(a&&c?R(n,o):!1===c?L(n,s):1===t?D(n,o):2===t&&L(n,o))}var P=0;function B(e){e[E]=P++,e._state=void 0,e._result=void 0,e._subscribers=[]}var M=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(w),this.promise[E]||B(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&D(this.promise,this._result))):L(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===A){var r=void 0,a=void 0,o=!1;try{r=e.then}catch(e){o=!0,a=e}if(r===S&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof r)this._remaining--,this._result[t]=e;else if(n===x){var s=new n(w);o?L(s,a):T(s,e,r),this._willSettleAt(s,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(i(e),t)},e.prototype._settledAt=function(e,t,n){var i=this.promise;void 0===i._state&&(this._remaining--,2===e?L(i,n):this._result[t]=n),0===this._remaining&&D(i,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;C(e,void 0,(function(e){return n._settledAt(1,t,e)}),(function(e){return n._settledAt(2,t,e)}))},e}(),x=function(){function t(e){this[E]=P++,this._result=this._state=void 0,this._subscribers=[],w!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){R(e,t)}),(function(t){L(e,t)}))}catch(t){L(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return x.prototype.then=S,x.all=function(e){return new M(this,e).promise},x.race=function(e){var t=this;return i(e)?new t((function(n,i){for(var r=e.length,a=0;a<r;a++)t.resolve(e[a]).then(n,i)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},x.resolve=A,x.reject=function(e){var t=new this(w);return L(t,e),t},x._setScheduler=function(e){o=e},x._setAsap=function(e){s=e},x._asap=s,x.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var i=null;try{i=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===i&&!t.cast)return}e.Promise=x},x.Promise=x,x},e.exports=i()}).call(this,n(16),n(17))},function(e,t){var n,i,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var c,u=[],d=!1,h=-1;function l(){d&&c&&(d=!1,c.length?u=c.concat(u):h=-1,u.length&&_())}function _(){if(!d){var e=s(l);d=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,d=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new f(e,t)),1!==u.length||d||s(_)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t);var i=n(9),r=n(12),a=n(10),o=n(1);t.default=function(e){var t=null,n=function(t,n){e.postMessage({msg:"logcat_callback",data:{type:t,logcat:n}})}.bind(this);function s(t,n){var i={msg:o.a.INIT_SEGMENT,data:{type:t,data:n}};e.postMessage(i,[n.data])}function c(t,n){var i={msg:o.a.MEDIA_SEGMENT,data:{type:t,data:n}};e.postMessage(i,[n.data])}function u(){var t={msg:o.a.LOADING_COMPLETE};e.postMessage(t)}function d(){var t={msg:o.a.RECOVERED_EARLY_EOF};e.postMessage(t)}function h(t){var n={msg:o.a.MEDIA_INFO,data:t};e.postMessage(n)}function l(t){var n={msg:o.a.METADATA_ARRIVED,data:t};e.postMessage(n)}function _(t){var n={msg:o.a.SCRIPTDATA_ARRIVED,data:t};e.postMessage(n)}function f(t){var n={msg:o.a.TIMED_ID3_METADATA_ARRIVED,data:t};e.postMessage(n)}function p(t){var n={msg:o.a.SMPTE2038_METADATA_ARRIVED,data:t};e.postMessage(n)}function m(t){var n={msg:o.a.SCTE35_METADATA_ARRIVED,data:t};e.postMessage(n)}function g(t){var n={msg:o.a.PES_PRIVATE_DATA_DESCRIPTOR,data:t};e.postMessage(n)}function v(t){var n={msg:o.a.PES_PRIVATE_DATA_ARRIVED,data:t};e.postMessage(n)}function y(t){var n={msg:o.a.STATISTICS_INFO,data:t};e.postMessage(n)}function b(t,n){e.postMessage({msg:o.a.IO_ERROR,data:{type:t,info:n}})}function S(t,n){e.postMessage({msg:o.a.DEMUX_ERROR,data:{type:t,info:n}})}function A(t){e.postMessage({msg:o.a.RECOMMEND_SEEKPOINT,data:t})}r.a.install(),e.addEventListener("message",(function(r){switch(r.data.cmd){case"init":(t=new a.a(r.data.param[0],r.data.param[1])).on(o.a.IO_ERROR,b.bind(this)),t.on(o.a.DEMUX_ERROR,S.bind(this)),t.on(o.a.INIT_SEGMENT,s.bind(this)),t.on(o.a.MEDIA_SEGMENT,c.bind(this)),t.on(o.a.LOADING_COMPLETE,u.bind(this)),t.on(o.a.RECOVERED_EARLY_EOF,d.bind(this)),t.on(o.a.MEDIA_INFO,h.bind(this)),t.on(o.a.METADATA_ARRIVED,l.bind(this)),t.on(o.a.SCRIPTDATA_ARRIVED,_.bind(this)),t.on(o.a.TIMED_ID3_METADATA_ARRIVED,f.bind(this)),t.on(o.a.SMPTE2038_METADATA_ARRIVED,p.bind(this)),t.on(o.a.SCTE35_METADATA_ARRIVED,m.bind(this)),t.on(o.a.PES_PRIVATE_DATA_DESCRIPTOR,g.bind(this)),t.on(o.a.PES_PRIVATE_DATA_ARRIVED,v.bind(this)),t.on(o.a.STATISTICS_INFO,y.bind(this)),t.on(o.a.RECOMMEND_SEEKPOINT,A.bind(this));break;case"destroy":t&&(t.destroy(),t=null),e.postMessage({msg:"destroyed"});break;case"start":t.start();break;case"stop":t.stop();break;case"seek":t.seek(r.data.param);break;case"pause":t.pause();break;case"resume":t.resume();break;case"logging_config":var E=r.data.param;i.a.applyConfig(E),!0===E.enableCallback?i.a.addLogListener(n):i.a.removeLogListener(n)}}))}},function(e,t,n){"use strict";n.r(t);var i=n(12),r=n(11),a={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function o(){return Object.assign({},a)}var s=function(){function e(){}return e.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},e.supportMSEH265Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"')},e.supportNetworkStreamIO=function(){var e=new r.a({},o()),t=e.loaderType;return e.destroy(),"fetch-stream-loader"==t||"xhr-moz-chunked-loader"==t},e.getNetworkLoaderTypeName=function(){var e=new r.a({},o()),t=e.loaderType;return e.destroy(),t},e.supportNativeMediaPlayback=function(t){null==e.videoElement&&(e.videoElement=window.document.createElement("video"));var n=e.videoElement.canPlayType(t);return"probably"===n||"maybe"==n},e.getFeatureList=function(){var t={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return t.msePlayback=e.supportMSEH264Playback(),t.networkStreamIO=e.supportNetworkStreamIO(),t.networkLoaderName=e.getNetworkLoaderTypeName(),t.mseLivePlayback=t.msePlayback&&t.networkStreamIO,t.mseH265Playback=e.supportMSEH265Playback(),t.nativeMP4H264Playback=e.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),t.nativeMP4H265Playback=e.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),t.nativeWebmVP8Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),t.nativeWebmVP9Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp9"'),t},e}(),c=n(2),u=n(6),d=n.n(u),h=n(0),l=n(4),_={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",TIMED_ID3_METADATA_ARRIVED:"timed_id3_metadata_arrived",SMPTE2038_METADATA_ARRIVED:"smpte2038_metadata_arrived",SCTE35_METADATA_ARRIVED:"scte35_metadata_arrived",PES_PRIVATE_DATA_DESCRIPTOR:"pes_private_data_descriptor",PES_PRIVATE_DATA_ARRIVED:"pes_private_data_arrived",STATISTICS_INFO:"statistics_info"},f=n(13),p=n.n(f),m=n(9),g=n(10),v=n(1),y=n(8),b=function(){function e(e,t){if(this.TAG="Transmuxer",this._emitter=new d.a,t.enableWorker&&"undefined"!=typeof Worker)try{this._worker=p()(18),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[e,t]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},m.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:m.a.getConfig()})}catch(n){h.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new g.a(e,t)}else this._controller=new g.a(e,t);if(this._controller){var n=this._controller;n.on(v.a.IO_ERROR,this._onIOError.bind(this)),n.on(v.a.DEMUX_ERROR,this._onDemuxError.bind(this)),n.on(v.a.INIT_SEGMENT,this._onInitSegment.bind(this)),n.on(v.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),n.on(v.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),n.on(v.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),n.on(v.a.MEDIA_INFO,this._onMediaInfo.bind(this)),n.on(v.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),n.on(v.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),n.on(v.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),n.on(v.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),n.on(v.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),n.on(v.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),n.on(v.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),n.on(v.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),n.on(v.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return e.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),m.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.hasWorker=function(){return null!=this._worker},e.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},e.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},e.prototype.seek=function(e){this._worker?this._worker.postMessage({cmd:"seek",param:e}):this._controller.seek(e)},e.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},e.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},e.prototype._onInitSegment=function(e,t){var n=this;Promise.resolve().then((function(){n._emitter.emit(v.a.INIT_SEGMENT,e,t)}))},e.prototype._onMediaSegment=function(e,t){var n=this;Promise.resolve().then((function(){n._emitter.emit(v.a.MEDIA_SEGMENT,e,t)}))},e.prototype._onLoadingComplete=function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(v.a.LOADING_COMPLETE)}))},e.prototype._onRecoveredEarlyEof=function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(v.a.RECOVERED_EARLY_EOF)}))},e.prototype._onMediaInfo=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.MEDIA_INFO,e)}))},e.prototype._onMetaDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.METADATA_ARRIVED,e)}))},e.prototype._onScriptDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SCRIPTDATA_ARRIVED,e)}))},e.prototype._onTimedID3MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.TIMED_ID3_METADATA_ARRIVED,e)}))},e.prototype._onSMPTE2038MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SMPTE2038_METADATA_ARRIVED,e)}))},e.prototype._onSCTE35MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SCTE35_METADATA_ARRIVED,e)}))},e.prototype._onPESPrivateDataDescriptor=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.PES_PRIVATE_DATA_DESCRIPTOR,e)}))},e.prototype._onPESPrivateDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.PES_PRIVATE_DATA_ARRIVED,e)}))},e.prototype._onStatisticsInfo=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.STATISTICS_INFO,e)}))},e.prototype._onIOError=function(e,t){var n=this;Promise.resolve().then((function(){n._emitter.emit(v.a.IO_ERROR,e,t)}))},e.prototype._onDemuxError=function(e,t){var n=this;Promise.resolve().then((function(){n._emitter.emit(v.a.DEMUX_ERROR,e,t)}))},e.prototype._onRecommendSeekpoint=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.RECOMMEND_SEEKPOINT,e)}))},e.prototype._onLoggingConfigChanged=function(e){this._worker&&this._worker.postMessage({cmd:"logging_config",param:e})},e.prototype._onWorkerMessage=function(e){var t=e.data,n=t.data;if("destroyed"===t.msg||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(t.msg){case v.a.INIT_SEGMENT:case v.a.MEDIA_SEGMENT:this._emitter.emit(t.msg,n.type,n.data);break;case v.a.LOADING_COMPLETE:case v.a.RECOVERED_EARLY_EOF:this._emitter.emit(t.msg);break;case v.a.MEDIA_INFO:Object.setPrototypeOf(n,y.a.prototype),this._emitter.emit(t.msg,n);break;case v.a.METADATA_ARRIVED:case v.a.SCRIPTDATA_ARRIVED:case v.a.TIMED_ID3_METADATA_ARRIVED:case v.a.SMPTE2038_METADATA_ARRIVED:case v.a.SCTE35_METADATA_ARRIVED:case v.a.PES_PRIVATE_DATA_DESCRIPTOR:case v.a.PES_PRIVATE_DATA_ARRIVED:case v.a.STATISTICS_INFO:this._emitter.emit(t.msg,n);break;case v.a.IO_ERROR:case v.a.DEMUX_ERROR:this._emitter.emit(t.msg,n.type,n.info);break;case v.a.RECOMMEND_SEEKPOINT:this._emitter.emit(t.msg,n);break;case"logcat_callback":h.a.emitter.emit("log",n.type,n.logcat)}},e}(),S={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"},A=n(7),E=n(3),w=function(){function e(e){this.TAG="MSEController",this._config=e,this._emitter=new d.a,this._config.isLive&&null==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new A.a}return e.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){if(this._mediaSource)throw new E.a("MediaSource has been attached to an HTMLMediaElement!");var t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=e,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),e.src=this._mediaSourceObjectURL},e.prototype.detachMediaElement=function(){if(this._mediaSource){var e=this._mediaSource;for(var t in this._sourceBuffers){var n=this._pendingSegments[t];n.splice(0,n.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var i=this._sourceBuffers[t];if(i){if("closed"!==e.readyState){try{e.removeSourceBuffer(i)}catch(e){h.a.e(this.TAG,e.message)}i.removeEventListener("error",this.e.onSourceBufferError),i.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if("open"===e.readyState)try{e.endOfStream()}catch(e){h.a.e(this.TAG,e.message)}e.removeEventListener("sourceopen",this.e.onSourceOpen),e.removeEventListener("sourceended",this.e.onSourceEnded),e.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},e.prototype.appendInitSegment=function(e,t){if(!this._mediaSource||"open"!==this._mediaSource.readyState)return this._pendingSourceBufferInit.push(e),void this._pendingSegments[e.type].push(e);var n=e,i=""+n.container;n.codec&&n.codec.length>0&&(i+=";codecs="+n.codec);var r=!1;if(h.a.v(this.TAG,"Received Initialization Segment, mimeType: "+i),this._lastInitSegments[n.type]=n,i!==this._mimeTypes[n.type]){if(this._mimeTypes[n.type])h.a.v(this.TAG,"Notice: "+n.type+" mimeType changed, origin: "+this._mimeTypes[n.type]+", target: "+i);else{r=!0;try{var a=this._sourceBuffers[n.type]=this._mediaSource.addSourceBuffer(i);a.addEventListener("error",this.e.onSourceBufferError),a.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(e){return h.a.e(this.TAG,e.message),void this._emitter.emit(S.ERROR,{code:e.code,msg:e.message})}}this._mimeTypes[n.type]=i}t||this._pendingSegments[n.type].push(n),r||this._sourceBuffers[n.type]&&!this._sourceBuffers[n.type].updating&&this._doAppendSegments(),l.a.safari&&"audio/mpeg"===n.container&&n.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=n.mediaDuration/1e3,this._updateMediaSourceDuration())},e.prototype.appendMediaSegment=function(e){var t=e;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var n=this._sourceBuffers[t.type];!n||n.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},e.prototype.seek=function(e){for(var t in this._sourceBuffers)if(this._sourceBuffers[t]){var n=this._sourceBuffers[t];if("open"===this._mediaSource.readyState)try{n.abort()}catch(e){h.a.e(this.TAG,e.message)}this._idrList.clear();var i=this._pendingSegments[t];if(i.splice(0,i.length),"closed"!==this._mediaSource.readyState){for(var r=0;r<n.buffered.length;r++){var a=n.buffered.start(r),o=n.buffered.end(r);this._pendingRemoveRanges[t].push({start:a,end:o})}if(n.updating||this._doRemoveRanges(),l.a.safari){var s=this._lastInitSegments[t];s&&(this._pendingSegments[t].push(s),n.updating||this._doAppendSegments())}}}},e.prototype.endOfStream=function(){var e=this._mediaSource,t=this._sourceBuffers;e&&"open"===e.readyState?t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,e.endOfStream()):e&&"closed"===e.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},e.prototype.getNearestKeyframe=function(e){return this._idrList.getLastSyncPointBeforeDts(e)},e.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var n=this._sourceBuffers[t];if(n){var i=n.buffered;if(i.length>=1&&e-i.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},e.prototype._doCleanupSourceBuffer=function(){var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var n=this._sourceBuffers[t];if(n){for(var i=n.buffered,r=!1,a=0;a<i.length;a++){var o=i.start(a),s=i.end(a);if(o<=e&&e<s+3){if(e-o>=this._config.autoCleanupMaxBackwardDuration){r=!0;var c=e-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:o,end:c})}}else s<e&&(r=!0,this._pendingRemoveRanges[t].push({start:o,end:s}))}r&&!n.updating&&this._doRemoveRanges()}}},e.prototype._updateMediaSourceDuration=function(){var e=this._sourceBuffers;if(0!==this._mediaElement.readyState&&"open"===this._mediaSource.readyState&&!(e.video&&e.video.updating||e.audio&&e.audio.updating)){var t=this._mediaSource.duration,n=this._pendingMediaDuration;n>0&&(isNaN(t)||n>t)&&(h.a.v(this.TAG,"Update MediaSource duration from "+t+" to "+n),this._mediaSource.duration=n),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},e.prototype._doRemoveRanges=function(){for(var e in this._pendingRemoveRanges)if(this._sourceBuffers[e]&&!this._sourceBuffers[e].updating)for(var t=this._sourceBuffers[e],n=this._pendingRemoveRanges[e];n.length&&!t.updating;){var i=n.shift();t.remove(i.start,i.end)}},e.prototype._doAppendSegments=function(){var e=this._pendingSegments;for(var t in e)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating&&e[t].length>0){var n=e[t].shift();if(n.timestampOffset){var i=this._sourceBuffers[t].timestampOffset,r=n.timestampOffset/1e3;Math.abs(i-r)>.1&&(h.a.v(this.TAG,"Update MPEG audio timestampOffset from "+i+" to "+r),this._sourceBuffers[t].timestampOffset=r),delete n.timestampOffset}if(!n.data||0===n.data.byteLength)continue;try{this._sourceBuffers[t].appendBuffer(n.data),this._isBufferFull=!1,"video"===t&&n.hasOwnProperty("info")&&this._idrList.appendArray(n.info.syncPoints)}catch(e){this._pendingSegments[t].unshift(n),22===e.code?(this._isBufferFull||this._emitter.emit(S.BUFFER_FULL),this._isBufferFull=!0):(h.a.e(this.TAG,e.message),this._emitter.emit(S.ERROR,{code:e.code,msg:e.message}))}}},e.prototype._onSourceOpen=function(){if(h.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var e=this._pendingSourceBufferInit;e.length;){var t=e.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(S.SOURCE_OPEN)},e.prototype._onSourceEnded=function(){h.a.v(this.TAG,"MediaSource onSourceEnded")},e.prototype._onSourceClose=function(){h.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},e.prototype._hasPendingSegments=function(){var e=this._pendingSegments;return e.video.length>0||e.audio.length>0},e.prototype._hasPendingRemoveRanges=function(){var e=this._pendingRemoveRanges;return e.video.length>0||e.audio.length>0},e.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(S.UPDATE_END)},e.prototype._onSourceBufferError=function(e){h.a.e(this.TAG,"SourceBuffer Error: "+e)},e}(),T=n(5),R={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},k={NETWORK_EXCEPTION:c.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:c.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:c.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:c.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:T.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:T.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:T.a.CODEC_UNSUPPORTED},D=function(){function e(e,t){this.TAG="MSEPlayer",this._type="MSEPlayer",this._emitter=new d.a,this._config=o(),"object"==typeof t&&Object.assign(this._config,t);var n=e.type.toLowerCase();if("mse"!==n&&"mpegts"!==n&&"m2ts"!==n&&"flv"!==n)throw new E.b("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");!0===e.isLive&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=e,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var i=l.a.chrome&&(l.a.version.major<50||50===l.a.version.major&&l.a.version.build<2661);this._alwaysSeekKeyframe=!!(i||l.a.msedge||l.a.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return e.prototype.destroy=function(){null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var n=this;e===_.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then((function(){n._emitter.emit(_.MEDIA_INFO,n.mediaInfo)})):e===_.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then((function(){n._emitter.emit(_.STATISTICS_INFO,n.statisticsInfo)})),this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){var t=this;if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),e.addEventListener("seeking",this.e.onvSeeking),e.addEventListener("canplay",this.e.onvCanPlay),e.addEventListener("stalled",this.e.onvStalled),e.addEventListener("progress",this.e.onvProgress),this._msectl=new w(this._config),this._msectl.on(S.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(S.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(S.SOURCE_OPEN,(function(){t._mseSourceOpened=!0,t._hasPendingLoad&&(t._hasPendingLoad=!1,t.load())})),this._msectl.on(S.ERROR,(function(e){t._emitter.emit(_.ERROR,R.MEDIA_ERROR,k.MEDIA_MSE_ERROR,e)})),this._msectl.attachMediaElement(e),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}},e.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},e.prototype.load=function(){var e=this;if(!this._mediaElement)throw new E.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new E.a("MSEPlayer.load() has been called, please call unload() first!");this._hasPendingLoad||(this._config.deferLoadAfterSourceOpen&&!1===this._mseSourceOpened?this._hasPendingLoad=!0:(this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new b(this._mediaDataSource,this._config),this._transmuxer.on(v.a.INIT_SEGMENT,(function(t,n){e._msectl.appendInitSegment(n)})),this._transmuxer.on(v.a.MEDIA_SEGMENT,(function(t,n){if(e._msectl.appendMediaSegment(n),e._config.lazyLoad&&!e._config.isLive){var i=e._mediaElement.currentTime;n.info.endDts>=1e3*(i+e._config.lazyLoadMaxDuration)&&null==e._progressChecker&&(h.a.v(e.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),e._suspendTransmuxer())}})),this._transmuxer.on(v.a.LOADING_COMPLETE,(function(){e._msectl.endOfStream(),e._emitter.emit(_.LOADING_COMPLETE)})),this._transmuxer.on(v.a.RECOVERED_EARLY_EOF,(function(){e._emitter.emit(_.RECOVERED_EARLY_EOF)})),this._transmuxer.on(v.a.IO_ERROR,(function(t,n){e._emitter.emit(_.ERROR,R.NETWORK_ERROR,t,n)})),this._transmuxer.on(v.a.DEMUX_ERROR,(function(t,n){e._emitter.emit(_.ERROR,R.MEDIA_ERROR,t,{code:-1,msg:n})})),this._transmuxer.on(v.a.MEDIA_INFO,(function(t){e._mediaInfo=t,e._emitter.emit(_.MEDIA_INFO,Object.assign({},t))})),this._transmuxer.on(v.a.METADATA_ARRIVED,(function(t){e._emitter.emit(_.METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SCRIPTDATA_ARRIVED,(function(t){e._emitter.emit(_.SCRIPTDATA_ARRIVED,t)})),this._transmuxer.on(v.a.TIMED_ID3_METADATA_ARRIVED,(function(t){e._emitter.emit(_.TIMED_ID3_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SMPTE2038_METADATA_ARRIVED,(function(t){e._emitter.emit(_.SMPTE2038_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SCTE35_METADATA_ARRIVED,(function(t){e._emitter.emit(_.SCTE35_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.PES_PRIVATE_DATA_DESCRIPTOR,(function(t){e._emitter.emit(_.PES_PRIVATE_DATA_DESCRIPTOR,t)})),this._transmuxer.on(v.a.PES_PRIVATE_DATA_ARRIVED,(function(t){e._emitter.emit(_.PES_PRIVATE_DATA_ARRIVED,t)})),this._transmuxer.on(v.a.STATISTICS_INFO,(function(t){e._statisticsInfo=e._fillStatisticsInfo(t),e._emitter.emit(_.STATISTICS_INFO,Object.assign({},e._statisticsInfo))})),this._transmuxer.on(v.a.RECOMMEND_SEEKPOINT,(function(t){e._mediaElement&&!e._config.accurateSeek&&(e._requestSetTime=!0,e._mediaElement.currentTime=t/1e3)})),this._transmuxer.open()))},e.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},e.prototype.play=function(){return this._mediaElement.play()},e.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._internalSeek(e):this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){return null==this._statisticsInfo&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),e.prototype._fillStatisticsInfo=function(e){if(e.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,n=0,i=0;if(this._mediaElement.getVideoPlaybackQuality){var r=this._mediaElement.getVideoPlaybackQuality();n=r.totalVideoFrames,i=r.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(n=this._mediaElement.webkitDecodedFrameCount,i=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=n,e.droppedFrames=i),e},e.prototype._onmseUpdateEnd=function(){var e=this._mediaElement.buffered,t=this._mediaElement.currentTime;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&e.length>0&&!this._mediaElement.paused){var n=e.end(e.length-1);if(n>this._config.liveBufferLatencyMaxLatency&&n-t>this._config.liveBufferLatencyMaxLatency){var i=n-this._config.liveBufferLatencyMinRemain;this.currentTime=i}}if(this._config.lazyLoad&&!this._config.isLive){for(var r=0,a=0;a<e.length;a++){var o=e.start(a),s=e.end(a);if(o<=t&&t<s){r=s;break}}r>=t+this._config.lazyLoadMaxDuration&&null==this._progressChecker&&(h.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},e.prototype._onmseBufferFull=function(){h.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),null==this._progressChecker&&this._suspendTransmuxer()},e.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},e.prototype._checkProgressAndResume=function(){for(var e=this._mediaElement.currentTime,t=this._mediaElement.buffered,n=!1,i=0;i<t.length;i++){var r=t.start(i),a=t.end(i);if(e>=r&&e<a){e>=a-this._config.lazyLoadRecoverDuration&&(n=!0);break}}n&&(window.clearInterval(this._progressChecker),this._progressChecker=null,n&&(h.a.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},e.prototype._isTimepointBuffered=function(e){for(var t=this._mediaElement.buffered,n=0;n<t.length;n++){var i=t.start(n),r=t.end(n);if(e>=i&&e<r)return!0}return!1},e.prototype._internalSeek=function(e){var t=this._isTimepointBuffered(e),n=!1,i=0;if(e<1&&this._mediaElement.buffered.length>0){var r=this._mediaElement.buffered.start(0);(r<1&&e<r||l.a.safari)&&(n=!0,i=l.a.safari?.1:r)}if(n)this._requestSetTime=!0,this._mediaElement.currentTime=i;else if(t){if(this._alwaysSeekKeyframe){var a=this._msectl.getNearestKeyframe(Math.floor(1e3*e));this._requestSetTime=!0,this._mediaElement.currentTime=null!=a?a.dts/1e3:e}else this._requestSetTime=!0,this._mediaElement.currentTime=e;null!=this._progressChecker&&this._checkProgressAndResume()}else null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e)},e.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var e=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(e)||(null!=this._progressChecker&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},e.prototype._checkAndResumeStuckPlayback=function(e){var t=this._mediaElement;if(e||!this._receivedCanPlay||t.readyState<2){var n=t.buffered;n.length>0&&t.currentTime<n.start(0)&&(h.a.w(this.TAG,"Playback seems stuck at "+t.currentTime+", seek to "+n.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=n.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},e.prototype._onvLoadedMetadata=function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},e.prototype._onvSeeking=function(e){var t=this._mediaElement.currentTime,n=this._mediaElement.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(t<1&&n.length>0){var i=n.start(0);if(i<1&&t<i||l.a.safari)return this._requestSetTime=!0,void(this._mediaElement.currentTime=l.a.safari?.1:i)}if(this._isTimepointBuffered(t)){if(this._alwaysSeekKeyframe){var r=this._msectl.getNearestKeyframe(Math.floor(1e3*t));null!=r&&(this._requestSetTime=!0,this._mediaElement.currentTime=r.dts/1e3)}null!=this._progressChecker&&this._checkProgressAndResume()}else this._seekpointRecord={seekPoint:t,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}},e.prototype._onvCanPlay=function(e){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},e.prototype._onvStalled=function(e){this._checkAndResumeStuckPlayback(!0)},e.prototype._onvProgress=function(e){this._checkAndResumeStuckPlayback()},e}(),L=function(){function e(e,t){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new d.a,this._config=o(),"object"==typeof t&&Object.assign(this._config,t);var n=e.type.toLowerCase();if("mse"===n||"mpegts"===n||"m2ts"===n||"flv"===n)throw new E.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(e.hasOwnProperty("segments"))throw new E.b("NativePlayer("+e.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}return e.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var n=this;e===_.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){n._emitter.emit(_.MEDIA_INFO,n.mediaInfo)})):e===_.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){n._emitter.emit(_.STATISTICS_INFO,n.statisticsInfo)})),this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}},e.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype.load=function(){if(!this._mediaElement)throw new E.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},e.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype.play=function(){return this._mediaElement.play()},e.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaInfo",{get:function(){var e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){var e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,n=0,i=0;if(this._mediaElement.getVideoPlaybackQuality){var r=this._mediaElement.getVideoPlaybackQuality();n=r.totalVideoFrames,i=r.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(n=this._mediaElement.webkitDecodedFrameCount,i=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=n,e.droppedFrames=i),e},enumerable:!1,configurable:!0}),e.prototype._onvLoadedMetadata=function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(_.MEDIA_INFO,this.mediaInfo)},e.prototype._reportStatisticsInfo=function(){this._emitter.emit(_.STATISTICS_INFO,this.statisticsInfo)},e}();i.a.install();var C={createPlayer:function(e,t){var n=e;if(null==n||"object"!=typeof n)throw new E.b("MediaDataSource must be an javascript object!");if(!n.hasOwnProperty("type"))throw new E.b("MediaDataSource must has type field to indicate video file type!");switch(n.type){case"mse":case"mpegts":case"m2ts":case"flv":return new D(n,t);default:return new L(n,t)}},isSupported:function(){return s.supportMSEH264Playback()},getFeatureList:function(){return s.getFeatureList()}};C.BaseLoader=c.a,C.LoaderStatus=c.c,C.LoaderErrors=c.b,C.Events=_,C.ErrorTypes=R,C.ErrorDetails=k,C.MSEPlayer=D,C.NativePlayer=L,C.LoggingControl=m.a,Object.defineProperty(C,"version",{enumerable:!0,get:function(){return"1.7.3"}}),t.default=C}])},171:(e,t,n)=>{var i;!function(e){!function(t){var i="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=a(e);function a(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===i.Reflect?i.Reflect=e:r=a(i.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,o={__proto__:[]}instanceof Array,s=!a&&!o,c={create:a?function(){return ie(Object.create(null))}:o?function(){return ie({__proto__:null})}:function(){return ie({})},has:s?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:s?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),d="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,h=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,l=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,_=new(d||"function"!=typeof WeakMap?ne():WeakMap);function f(e,t,n,i){if(M(n)){if(!q(e))throw new TypeError;if(!W(t))throw new TypeError;return w(e,t)}if(!q(e))throw new TypeError;if(!N(t))throw new TypeError;if(!N(i)&&!M(i)&&!x(i))throw new TypeError;return x(i)&&(i=void 0),T(e,t,n=z(n),i)}function p(e,t){function n(n,i){if(!N(n))throw new TypeError;if(!M(i)&&!K(i))throw new TypeError;I(e,t,n,i)}return n}function m(e,t,n,i){if(!N(n))throw new TypeError;return M(i)||(i=z(i)),I(e,t,n,i)}function g(e,t,n){if(!N(t))throw new TypeError;return M(n)||(n=z(n)),k(e,t,n)}function v(e,t,n){if(!N(t))throw new TypeError;return M(n)||(n=z(n)),D(e,t,n)}function y(e,t,n){if(!N(t))throw new TypeError;return M(n)||(n=z(n)),L(e,t,n)}function b(e,t,n){if(!N(t))throw new TypeError;return M(n)||(n=z(n)),C(e,t,n)}function S(e,t){if(!N(e))throw new TypeError;return M(t)||(t=z(t)),O(e,t)}function A(e,t){if(!N(e))throw new TypeError;return M(t)||(t=z(t)),P(e,t)}function E(e,t,n){if(!N(t))throw new TypeError;M(n)||(n=z(n));var i=R(t,n,!1);if(M(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var r=_.get(t);return r.delete(n),r.size>0||_.delete(t),!0}function w(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!M(i)&&!x(i)){if(!W(i))throw new TypeError;t=i}}return t}function T(e,t,n,i){for(var r=e.length-1;r>=0;--r){var a=(0,e[r])(t,n,i);if(!M(a)&&!x(a)){if(!N(a))throw new TypeError;i=a}}return i}function R(e,t,n){var i=_.get(e);if(M(i)){if(!n)return;i=new h,_.set(e,i)}var r=i.get(t);if(M(r)){if(!n)return;r=new h,i.set(t,r)}return r}function k(e,t,n){if(D(e,t,n))return!0;var i=$(t);return!x(i)&&k(e,i,n)}function D(e,t,n){var i=R(t,n,!1);return!M(i)&&j(i.has(e))}function L(e,t,n){if(D(e,t,n))return C(e,t,n);var i=$(t);return x(i)?void 0:L(e,i,n)}function C(e,t,n){var i=R(t,n,!1);if(!M(i))return i.get(e)}function I(e,t,n,i){R(n,i,!0).set(e,t)}function O(e,t){var n=P(e,t),i=$(e);if(null===i)return n;var r=O(i,t);if(r.length<=0)return n;if(n.length<=0)return r;for(var a=new l,o=[],s=0,c=n;s<c.length;s++){var u=c[s];a.has(u)||(a.add(u),o.push(u))}for(var d=0,h=r;d<h.length;d++){u=h[d];a.has(u)||(a.add(u),o.push(u))}return o}function P(e,t){var n=[],i=R(e,t,!1);if(M(i))return n;for(var r=X(i.keys()),a=0;;){var o=J(r);if(!o)return n.length=a,n;var s=Z(o);try{n[a]=s}catch(c){try{Q(r)}finally{throw c}}a++}}function B(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function M(e){return void 0===e}function x(e){return null===e}function U(e){return"symbol"==typeof e}function N(e){return"object"==typeof e?null!==e:"function"==typeof e}function G(e,t){switch(B(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",r=Y(e,i);if(void 0!==r){var a=r.call(e,n);if(N(a))throw new TypeError;return a}return F(e,"default"===n?"number":n)}function F(e,t){if("string"===t){var n=e.toString;if(H(n))if(!N(r=n.call(e)))return r;if(H(i=e.valueOf))if(!N(r=i.call(e)))return r}else{var i;if(H(i=e.valueOf))if(!N(r=i.call(e)))return r;var r,a=e.toString;if(H(a))if(!N(r=a.call(e)))return r}throw new TypeError}function j(e){return!!e}function V(e){return""+e}function z(e){var t=G(e,3);return U(t)?t:V(t)}function q(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function H(e){return"function"==typeof e}function W(e){return"function"==typeof e}function K(e){switch(B(e)){case 3:case 4:return!0;default:return!1}}function Y(e,t){var n=e[t];if(null!=n){if(!H(n))throw new TypeError;return n}}function X(e){var t=Y(e,r);if(!H(t))throw new TypeError;var n=t.call(e);if(!N(n))throw new TypeError;return n}function Z(e){return e.value}function J(e){var t=e.next();return!t.done&&t}function Q(e){var t=e.return;t&&t.call(e)}function $(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var r=i.constructor;return"function"!=typeof r||r===e?t:r}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[r]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var i=this._keys.length,r=n+1;r<i;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,i)},t.prototype.values=function(){return new n(this._keys,this._values,a)},t.prototype.entries=function(){return new n(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[r]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function a(e,t){return t}function o(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new h}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[r]=function(){return this.keys()},e}()}function ne(){var e=16,n=c.create(),i=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=a(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=a(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return a(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=a(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var e;do{e="@@WeakMap@@"+u()}while(c.has(n,e));return n[e]=!0,e}function a(e,n){if(!t.call(e,i)){if(!n)return;Object.defineProperty(e,i,{value:c.create()})}return e[i]}function o(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e)}function u(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",i=0;i<e;++i){var r=t[i];4!==i&&6!==i&&8!==i||(n+="-"),r<16&&(n+="0"),n+=r.toString(16).toLowerCase()}return n}}function ie(e){return e.__=void 0,delete e.__,e}e("decorate",f),e("metadata",p),e("defineMetadata",m),e("hasMetadata",g),e("hasOwnMetadata",v),e("getMetadata",y),e("getOwnMetadata",b),e("getMetadataKeys",S),e("getOwnMetadataKeys",A),e("deleteMetadata",E)}(r)}()}(i||(i={}))},2229:(e,t,n)=>{"use strict";function i(e,t,n,i,r,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(i,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)}))}}n.d(t,{Z:()=>r})},2636:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(1188);function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(0,i.Z)(r.key),r)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},207:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(8580);function r(){r=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(C){d=function(e,t,n){return e[t]=n}}function h(e,t,n,i){var r=t&&t.prototype instanceof f?t:f,o=Object.create(r.prototype),s=new k(i||[]);return a(o,"_invoke",{value:E(e,n,s)}),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(C){return{type:"throw",arg:C}}}e.wrap=h;var _={};function f(){}function p(){}function m(){}var g={};d(g,s,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(D([])));y&&y!==t&&n.call(y,s)&&(g=y);var b=m.prototype=f.prototype=Object.create(g);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function A(e,t){function r(a,o,s,c){var u=l(e[a],e,o);if("throw"!==u.type){var d=u.arg,h=d.value;return h&&"object"==(0,i.Z)(h)&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(h).then((function(e){d.value=e,s(d)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}})}function E(e,t,n){var i="suspendedStart";return function(r,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw a;return L()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=w(o,n);if(s){if(s===_)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var c=l(e,t,n);if("normal"===c.type){if(i=n.done?"completed":"suspendedYield",c.arg===_)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i="completed",n.method="throw",n.arg=c.arg)}}}function w(e,t){var n=t.method,i=e.iterator[n];if(void 0===i)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var r=l(i,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,_;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,_):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,_)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function D(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,r=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=m,a(b,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:p,configurable:!0}),p.displayName=d(m,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,d(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},S(A.prototype),d(A.prototype,c,(function(){return this})),e.AsyncIterator=A,e.async=function(t,n,i,r,a){void 0===a&&(a=Promise);var o=new A(h(t,n,i,r),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(b),d(b,u,"Generator"),d(b,s,(function(){return this})),d(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},e.values=D,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return o.type="throw",o.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;R(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),_}},e}},1188:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(8580);function r(e){var t=function(e,t){if("object"!==(0,i.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==(0,i.Z)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,i.Z)(t)?t:String(t)}},1138:(e,t,n)=>{"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{_:()=>i,j:()=>i})}}]);